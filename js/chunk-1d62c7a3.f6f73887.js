(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1d62c7a3","chunk-2d0d3e74","chunk-2d0d3e74"],{"008c":function(t,e,i){"use strict";i.d(e,"a",(function(){return M})),i.d(e,"b",(function(){return O})),i.d(e,"c",(function(){return u})),i.d(e,"d",(function(){return F})),i.d(e,"e",(function(){return R})),i.d(e,"f",(function(){return v})),i.d(e,"g",(function(){return T}));var n=i("a9ab");const r=(t,e,i)=>[e,i],s=(t,e,i)=>[e,i,t[2]],a=(t,e,i)=>[e,i,t[2],t[3]];function u(t){return t?{originPosition:"upper-left"===t.originPosition?"upperLeft":"lower-left"===t.originPosition?"lowerLeft":t.originPosition,scale:[t.tolerance,t.tolerance],translate:[t.extent.xmin,t.extent.ymax]}:null}function o({scale:t,translate:e},i){return Math.round((i-e[0])/t[0])}function c({scale:t,translate:e},i){return Math.round((e[1]-i)/t[1])}function l(t,e,i){const n=[];let r,s,a,u;for(let l=0;l<i.length;l++){const h=i[l];l>0?(a=o(t,h[0]),u=c(t,h[1]),a===r&&u===s||(n.push(e(h,a-r,u-s)),r=a,s=u)):(r=o(t,h[0]),s=c(t,h[1]),n.push(e(h,r,s)))}return n.length>0?n:null}function h(t,e,i,n){return l(t,i?n?a:s:n?s:r,e)}function f(t,e,i,n){const u=[],o=i?n?a:s:n?s:r;for(let r=0;r<e.length;r++){const i=l(t,o,e[r]);i&&i.length>=3&&u.push(i)}return u.length?u:null}function d(t,e,i,n){const u=[],o=i?n?a:s:n?s:r;for(let r=0;r<e.length;r++){const i=l(t,o,e[r]);i&&i.length>=2&&u.push(i)}return u.length?u:null}function m({scale:t,translate:e},i){return i*t[0]+e[0]}function p({scale:t,translate:e},i){return e[1]-i*t[1]}function g(t,e,i){const n=new Array(i.length);if(!i.length)return n;const[r,s]=t.scale;let a=m(t,i[0][0]),u=p(t,i[0][1]);n[0]=e(i[0],a,u);for(let o=1;o<i.length;o++){const t=i[o];a+=t[0]*r,u-=t[1]*s,n[o]=e(t,a,u)}return n}function y(t,e,i){const n=new Array(i.length);for(let r=0;r<i.length;r++)n[r]=g(t,e,i[r]);return n}function b(t,e,i,n){return g(t,i?n?a:s:n?s:r,e)}function x(t,e,i,n){return y(t,i?n?a:s:n?s:r,e)}function _(t,e,i,n){return y(t,i?n?a:s:n?s:r,e)}function I(t,e,i,n,r){return e.xmin=o(t,i.xmin),e.ymin=c(t,i.ymin),e.xmax=o(t,i.xmax),e.ymax=c(t,i.ymax),e!==i&&(n&&(e.zmin=i.zmin,e.zmax=i.zmax),r&&(e.mmin=i.mmin,e.mmax=i.mmax)),e}function w(t,e,i,n,r){return e.points=h(t,i.points,n,r),e}function O(t,e,i,n,r){return e.x=o(t,i.x),e.y=c(t,i.y),e!==i&&(n&&(e.z=i.z),r&&(e.m=i.m)),e}function S(t,e,i,n,r){const s=f(t,i.rings,n,r);return s?(e.rings=s,e):null}function j(t,e,i,n,r){const s=d(t,i.paths,n,r);return s?(e.paths=s,e):null}function M(t,e){return t&&e?Object(n["f"])(e)?O(t,{},e,!1,!1):Object(n["h"])(e)?j(t,{},e,!1,!1):Object(n["g"])(e)?S(t,{},e,!1,!1):Object(n["e"])(e)?w(t,{},e,!1,!1):Object(n["d"])(e)?I(t,{},e,!1,!1):null:null}function F(t,e,i,n,r){return e.points=b(t,i.points,n,r),e}function R(t,e,i,n,r){return e.x=m(t,i.x),e.y=p(t,i.y),e!==i&&(n&&(e.z=i.z),r&&(e.m=i.m)),e}function v(t,e,i,n,r){return e.rings=_(t,i.rings,n,r),e}function T(t,e,i,n,r){return e.paths=x(t,i.paths,n,r),e}},"1ec3":function(t,e,i){"use strict";i.d(e,"a",(function(){return f})),i.d(e,"b",(function(){return p})),i.d(e,"c",(function(){return y}));var n=i("f4cc"),r=i("7f83"),s=i("9786"),a=i("8188"),u=i("d641");const o=[0,0];function c(t,e){if(!e)return null;if("x"in e){const i={x:0,y:0};return[i.x,i.y]=t(e.x,e.y,o),null!=e.z&&(i.z=e.z),null!=e.m&&(i.m=e.m),i}if("xmin"in e){const i={xmin:0,ymin:0,xmax:0,ymax:0};return[i.xmin,i.ymin]=t(e.xmin,e.ymin,o),[i.xmax,i.ymax]=t(e.xmax,e.ymax,o),e.hasZ&&(i.zmin=e.zmin,i.zmax=e.zmax,i.hasZ=!0),e.hasM&&(i.mmin=e.mmin,i.mmax=e.mmax,i.hasM=!0),i}return"rings"in e?{rings:l(e.rings,t),hasM:e.hasM,hasZ:e.hasZ}:"paths"in e?{paths:l(e.paths,t),hasM:e.hasM,hasZ:e.hasZ}:"points"in e?{points:h(e.points,t),hasM:e.hasM,hasZ:e.hasZ}:void 0}function l(t,e){const i=[];for(const n of t)i.push(h(n,e));return i}function h(t,e){const i=[];for(const n of t){const t=e(n[0],n[1],[0,0]);i.push(t),n.length>2&&t.push(n[2]),n.length>3&&t.push(n[3])}return i}async function f(t,e){if(!e)return;const i=Array.isArray(t)?t.map(t=>{var e;return null==(e=t.geometry)?void 0:e.spatialReference}):[t];await Object(a["b"])(i.map(t=>({source:t,dest:e})))}const d=c.bind(null,s["c"]),m=c.bind(null,s["f"]);function p(t,e,i){return t?(i||(i=e,e=t.spatialReference),Object(r["i"])(e)&&Object(r["i"])(i)&&!Object(r["c"])(e,i)?Object(s["a"])(e,i)?Object(r["m"])(i)?d(t):m(t):Object(a["h"])(u["a"],[t],e,i,null)[0]:t):t}const g=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(t,e,i){!t||!t.length||!e||!i||Object(r["c"])(e,i);const s={geometries:t,inSpatialReference:e,outSpatialReference:i,resolve:null};return this._jobs.push(s),Object(n["c"])(t=>{s.resolve=t,null===this._timer&&(this._timer=setTimeout(this._process,10))})}_process(){this._timer=null;const t=this._jobs.shift();if(!t)return;const{geometries:e,inSpatialReference:i,outSpatialReference:n,resolve:o}=t;Object(s["a"])(i,n)?Object(r["m"])(n)?o(e.map(d)):o(e.map(m)):o(Object(a["h"])(u["a"],e,i,n,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};async function y(t,e,i){return g.push(t,e,i)}},4261:function(t,e,i){"use strict";i.d(e,"a",(function(){return _})),i.d(e,"b",(function(){return r})),i.d(e,"c",(function(){return g})),i.d(e,"d",(function(){return x})),i.d(e,"e",(function(){return a})),i.d(e,"f",(function(){return o})),i.d(e,"g",(function(){return u})),i.d(e,"h",(function(){return y})),i.d(e,"i",(function(){return s})),i.d(e,"j",(function(){return p})),i.d(e,"k",(function(){return m})),i.d(e,"l",(function(){return d})),i.d(e,"m",(function(){return f}));var n=i("b2b2");i("3af1"),i("9180");function r(t=I){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function s(t,e,i,n,s,a,u=r()){return u[0]=t,u[1]=e,u[2]=i,u[3]=n,u[4]=s,u[5]=a,u}function a(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t[4]=Math.max(t[4],e[4]),t[5]=Math.max(t[5],e[5])}function u(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[0]),t[4]=Math.max(t[4],e[1]),t[5]=Math.max(t[5],e[2])}function o(t,e,i){const n=e.length;let r=t[0],s=t[1],a=t[2],u=t[3],o=t[4],c=t[5];if(i)for(let l=0;l<n;l++){const t=e[l];r=Math.min(r,t[0]),s=Math.min(s,t[1]),a=Math.min(a,t[2]),u=Math.max(u,t[0]),o=Math.max(o,t[1]),c=Math.max(c,t[2])}else for(let l=0;l<n;l++){const t=e[l];r=Math.min(r,t[0]),s=Math.min(s,t[1]),u=Math.max(u,t[0]),o=Math.max(o,t[1])}t[0]=r,t[1]=s,t[2]=a,t[3]=u,t[4]=o,t[5]=c}function c(t){return t[0]>=t[3]?0:t[3]-t[0]}function l(t){return t[1]>=t[4]?0:t[4]-t[1]}function h(t){return t[2]>=t[5]?0:t[5]-t[2]}function f(t,e=[0,0,0]){return e[0]=c(t),e[1]=l(t),e[2]=h(t),e}function d(t,e,i=t){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i!==t&&(i[3]=t[3],i[4]=t[4],i[5]=t[5]),i}function m(t,e,i=t){return i[3]=e[0],i[4]=e[1],i[5]=e[2],i!==t&&(i[0]=t[0],i[1]=t[1],i[2]=t[2]),t}function p(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function g(t){return t?p(t,_):r(_)}function y(t,e){return t[0]=e[0],t[1]=e[1],t[2]=Number.NEGATIVE_INFINITY,t[3]=e[2],t[4]=e[3],t[5]=Number.POSITIVE_INFINITY,t}function b(t){return 6===t.length}function x(t,e,i){if(Object(n["g"])(t)||Object(n["g"])(e))return t===e;if(!b(t)||!b(e))return!1;if(i){for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1}else for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}const _=[1/0,1/0,1/0,-1/0,-1/0,-1/0],I=[0,0,0,0,0,0];r()},4637:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n=i("5f6c"),r=Object(n["b"])((function(t){var e;void 0!==(e=function(){function t(t,i,r,s,a){e(t,i,r||0,s||t.length-1,a||n)}function e(t,n,r,s,a){for(;s>r;){if(s-r>600){var u=s-r+1,o=n-r+1,c=Math.log(u),l=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*l*(u-l)/u)*(o-u/2<0?-1:1);e(t,n,Math.max(r,Math.floor(n-o*l/u+h)),Math.min(s,Math.floor(n+(u-o)*l/u+h)),a)}var f=t[n],d=r,m=s;for(i(t,r,n),a(t[s],f)>0&&i(t,r,s);d<m;){for(i(t,d,m),d++,m--;a(t[d],f)<0;)d++;for(;a(t[m],f)>0;)m--}0===a(t[r],f)?i(t,r,m):i(t,++m,s),m<=n&&(r=m+1),n<=m&&(s=m-1)}}function i(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function n(t,e){return t<e?-1:t>e?1:0}return t}())&&(t.exports=e)}))},"5f6c":function(t,e,i){"use strict";(function(t){i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return r})),i.d(e,"c",(function(){return n}));"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof t||"undefined"!=typeof self&&self;function n(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function r(t,e,i){return t(i={path:e,exports:{},require:function(t,e){return s(null==e&&i.path)}},i.exports),i.exports}function s(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}}).call(this,i("c8ba"))},6411:function(t,e,i){"use strict";var n=i("7ffa"),r=i("b2b2"),s=i("ce50"),a=i("f4cc"),u=i("7f83"),o=i("28b1"),c=i("a9ab"),l=i("8048"),h=i("9180"),f=i("aefa"),d=i("306f"),m=i("80b7"),p=i("a94c"),g=i("4261"),y=i("1ec3"),b=i("d7f2"),x=i("66a2");class _{constructor(t,e){this._cache=new b["a"](t),this._invalidCache=new b["a"](e)}get(t,e){const i=`${e.uid}:${t}`,n=this._cache.get(i);if(n)return n;if(void 0!==this._invalidCache.get(i))return null;try{const n=x["WhereClause"].create(t,e);return this._cache.put(i,n),n}catch{return this._invalidCache.put(i,null),null}}}const I=new _(50,500),w="feature-store:unsupported-query",O=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function S(t,e){if(!e)return!0;const i=I.get(e,t);if(!i)throw new s["a"](w,"invalid SQL expression",{where:e});if(!i.isStandardized)throw new s["a"](w,"where clause is not standard",{where:e});return F(t,i.fieldNames,"where clause contains missing fields"),!0}function j(t,e,i){if(!e)return!0;const n=I.get(e,t);if(!n)throw new s["a"](w,"invalid SQL expression",{having:e});if(!n.isAggregate)throw new s["a"](w,"having does not contain a valid aggregate function",{having:e});const r=n.fieldNames;if(F(t,r,"having contains missing fields"),!n.getExpressions().every(e=>{const{aggregateType:n,field:r}=e,s=t.has(r)&&t.get(r).name;return i.some(e=>{const{onStatisticField:i,statisticType:r}=e;return(t.has(i)&&t.get(i).name)===s&&r.toLowerCase().trim()===n})}))throw new s["a"](w,"expressions in having should also exist in outStatistics",{having:e});return!0}function M(t,e){return t?I.get(t,e):null}function F(t,e,i,n=!0){const r=[];for(const u of e)if("*"!==u&&!t.has(u))if(n){const e=R(u);try{const i=M(e,t);if(!i)throw new s["a"](w,"invalid SQL expression",{where:e});if(!i.isStandardized)throw new s["a"](w,"expression is not standard",{clause:i});F(t,i.fieldNames,"expression contains missing fields")}catch(a){const t=a&&a.details;if(t&&(t.clause||t.where))throw a;t&&t.missingFields?r.push(...t.missingFields):r.push(u)}}else r.push(u);if(r.length)throw new s["a"](w,i,{missingFields:r})}function R(t){return t.split(" as ")[0]}function v(t){return t.split(" as ")[1]}function T(t,e){const i=e.get(t);return!!i&&!O.has(i.type)}var A=i("d518"),N=i("abb8"),E=i("6655"),Q=i("008c"),P=class{constructor(t,e,i){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=t.returnDistinctValues,this.fieldsIndex=i,this.featureAdapter=e;const n=t.outFields;if(n&&-1===n.indexOf("*")){this.outFields=n;let t=0;for(const e of n){const n=R(e),r=this.fieldsIndex.get(n),s=r?null:M(n,i),a=r?r.name:v(e)||"FIELD_EXP_"+t++;this._fieldDataCache.set(e,{alias:a,clause:s})}}}countDistinctValues(t){return this.returnDistinctValues?(t.forEach(t=>this.getAttributes(t)),this._returnDistinctMap.size):t.length}getAttributes(t){const e=this._processAttributesForOutFields(t);return this._processAttributesForDistinctValues(e)}getFieldValue(t,e,i){const n=i?i.name:e;let r=null;return this._fieldDataCache.has(n)?r=this._fieldDataCache.get(n).clause:i||(r=M(e,this.fieldsIndex),this._fieldDataCache.set(n,{alias:n,clause:r})),i?this.featureAdapter.getAttribute(t,n):r.calculateValue(t,this.featureAdapter)}validateItem(t,e){return this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:M(e,this.fieldsIndex)}),this._fieldDataCache.get(e).clause.testFeature(t,this.featureAdapter)}validateItems(t,e){return this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:M(e,this.fieldsIndex)}),this._fieldDataCache.get(e).clause.testSet(t,this.featureAdapter)}_processAttributesForOutFields(t){const e=this.outFields;if(!e||!e.length)return this.featureAdapter.getAttributes(t);const i={};for(const n of e){const{alias:e,clause:r}=this._fieldDataCache.get(n);i[e]=r?r.calculateValue(t,this.featureAdapter):this.featureAdapter.getAttribute(t,e)}return i}_processAttributesForDistinctValues(t){if(Object(r["g"])(t)||!this.returnDistinctValues)return t;const e=this.outFields,i=[];if(e)for(const r of e){const{alias:e}=this._fieldDataCache.get(r);i.push(t[e])}else for(const r in t)i.push(t[r]);const n=`${(e||["*"]).join(",")}=${i.join(",")}`;let s=this._returnDistinctMap.get(n)||0;return this._returnDistinctMap.set(n,++s),s>1?null:t}};function G(t){return t.substr(24,12)+t.substr(19,4)+t.substr(16,2)+t.substr(14,2)+t.substr(11,2)+t.substr(9,2)+t.substr(6,2)+t.substr(4,2)+t.substr(2,2)+t.substr(0,2)}function C(t,e,i){return(i?t>e:t<e)?-1:(i?t<e:t>e)?1:0}function Y(t,e,i){return i?e-t:t-e}function B(t,e,i,n){if(i&&"esriFieldTypeDate"===i.type){const i=new Date(t).getTime(),r=new Date(e).getTime();if(!isNaN(i)&&!isNaN(r))return Y(i,r,n)}if("number"==typeof t&&"number"==typeof e)return Y(t,e,n);if("string"==typeof t&&"string"==typeof e){const r=t.toUpperCase(),s=e.toUpperCase();return!i||"esriFieldTypeGUID"!==i.type&&"esriFieldTypeGlobalID"!==i.type?C(r,s,n):C(G(r),G(s),n)}return n?1:-1}class V{constructor(t,e,i){this.items=t,this.queryGeometry=e,this.definitionExpression=i.definitionExpression,this.geometryType=i.geometryType,this.hasM=i.hasM,this.hasZ=i.hasZ,this.objectIdField=i.objectIdField,this.spatialReference=i.spatialReference,this.fieldsIndex=i.fieldsIndex,this.timeInfo=i.timeInfo,this.featureAdapter=i.featureAdapter,this.aggregateAdapter=i.aggregateAdapter}get size(){return this.items.length}createQueryResponseForCount(t){const e=new P(t,this.featureAdapter,this.fieldsIndex);if(!t.outStatistics)return e.countDistinctValues(this.items);const{groupByFieldsForStatistics:i,having:n}=t;if(!(null==i?void 0:i.length))return 1;const r=new Map,s=new Map,a=new Set,u=t.outStatistics;for(const o of u){const{statisticType:t}=o,u="exceedslimit"!==t?o.onStatisticField:void 0;if(!s.has(u)){const t=[];for(const n of i){const i=this._getAttributeValues(e,n,r);t.push(i)}s.set(u,this._calculateUniqueValues(t))}const c=s.get(u);for(const i in c){const{data:t,items:r}=c[i],s=t.join(",");n&&!e.validateItems(r,n)||a.add(s)}}return a.size}createQueryResponse(t){let e;return e=t.outStatistics?t.outStatistics.some(t=>"exceedslimit"===t.statisticType)?this._createExceedsLimitQueryResponse(t):this._createStatisticsQueryResponse(t):this._createFeatureQueryResponse(t),t.returnQueryGeometry&&(Object(u["i"])(t.outSR)&&!Object(u["c"])(this.queryGeometry.spatialReference,t.outSR)?e.queryGeometry=Object(A["d"])({spatialReference:t.outSR,...Object(y["b"])(this.queryGeometry,this.queryGeometry.spatialReference,t.outSR)}):e.queryGeometry=Object(A["d"])({spatialReference:t.outSR,...this.queryGeometry})),e}executeAttributesQuery(t){const e=M(t.where,this.fieldsIndex);if(!e)return Object(a["u"])(this);if(e.isStandardized){let i=0;const n=[];for(const t of this.items)e.testFeature(t,this.featureAdapter)&&(n[i++]=t);const r=new V(n,this.queryGeometry,this);return r.definitionExpression=t.where,Object(a["u"])(r)}return Object(a["t"])(new TypeError("Where clause is not standardized"))}executeAggregateIdsQuery(t){if(!t.aggregateIds||!t.aggregateIds.length||Object(r["g"])(this.aggregateAdapter))return Object(a["u"])(this);const e=new Set;for(const n of t.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(n).forEach(t=>e.add(t));const i=this.featureAdapter.getObjectId;return Object(a["u"])(new V(this.items.filter(t=>e.has(i(t))),this.queryGeometry,this))}executeObjectIdsQuery(t){if(!t.objectIds||!t.objectIds.length)return Object(a["u"])(this);const e=new Set(t.objectIds),i=this.featureAdapter.getObjectId;return Object(a["u"])(new V(this.items.filter(t=>e.has(i(t))),this.queryGeometry,this))}executeTimeQuery(t){const e=Object(N["b"])(this.timeInfo,t.timeExtent,this.featureAdapter);if(!Object(r["h"])(e))return Object(a["u"])(this);const i=this.items.filter(e);return Object(a["u"])(new V(i,this.queryGeometry,this))}filterLatest(){const{trackIdField:t,startTimeField:e,endTimeField:i}=this.timeInfo,n=i||e,r=new Map,s=this.featureAdapter.getAttribute;for(const a of this.items){const e=s(a,t),i=s(a,n),u=r.get(e);(!u||i>s(u,n))&&r.set(e,a)}const u=Array.from(r.values());return Object(a["u"])(new V(u,this.queryGeometry,this))}async project(t){if(!t||Object(u["c"])(this.spatialReference,t))return this;const e=this.featureAdapter,i=(await Object(y["c"])(this.items.map(t=>Object(A["f"])(this.geometryType,this.hasZ,this.hasM,e.getGeometry(t))),this.spatialReference,t)).map((t,i)=>e.cloneWithGeometry(this.items[i],Object(E["d"])(t,this.hasZ,this.hasM)));return new V(i,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:t,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})}_sortFeatures(t,e,i){if(t.length>1&&e&&e.length)for(const n of e.reverse()){const e=n.split(" "),r=e[0],s=this.fieldsIndex.get(r),a=e[1]&&"desc"===e[1].toLowerCase();t.sort((t,e)=>B(i(t,r,s),i(e,r,s),s,a))}}_createFeatureQueryResponse(t){const e=this.items,{geometryType:i,hasM:n,hasZ:r,objectIdField:s,spatialReference:a}=this,{outFields:u,outSR:o,quantizationParameters:c,resultRecordCount:l,resultOffset:h,returnZ:f,returnM:d}=t,m=null!=l&&e.length>(h||0)+l,p=u&&(u.indexOf("*")>-1?[...this.fieldsIndex.fields]:u.map(t=>this.fieldsIndex.get(t)));return{exceededTransferLimit:m,features:this._createFeatures(t,e),fields:p,geometryType:i,hasM:n&&d,hasZ:r&&f,objectIdFieldName:s,spatialReference:Object(A["d"])(o||a),transform:c&&Object(Q["c"])(c)||null}}_createFeatures(t,e){const i=new P(t,this.featureAdapter,this.fieldsIndex),{hasM:n,hasZ:r}=this,{orderByFields:s,quantizationParameters:a,returnGeometry:u,returnCentroid:o,maxAllowableOffset:c,resultOffset:l,resultRecordCount:h,returnZ:f=!1,returnM:d=!1}=t,m=r&&f,p=n&&d;let g=[],y=0;const b=[...e];if(this._sortFeatures(b,s,(t,e,n)=>i.getFieldValue(t,e,n)),u||o){const t=Object(Q["c"])(a);if(u&&!o)for(const e of b)g[y++]={attributes:i.getAttributes(e),geometry:Object(A["f"])(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(e),c,t,m,p)};else if(!u&&o)for(const e of b)g[y++]={attributes:i.getAttributes(e),centroid:Object(A["i"])(this,this.featureAdapter.getCentroid(e,this),t)};else for(const e of b)g[y++]={attributes:i.getAttributes(e),centroid:Object(A["i"])(this,this.featureAdapter.getCentroid(e,this),t),geometry:Object(A["f"])(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(e),c,t,m,p)}}else for(const _ of b){const t=i.getAttributes(_);t&&(g[y++]={attributes:t})}const x=l||0;if(null!=h){const t=x+h;g=g.slice(x,Math.min(g.length,t))}return g}_createExceedsLimitQueryResponse(t){let e=!1,i=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY;for(const s of t.outStatistics)if("exceedslimit"===s.statisticType){i=null!=s.maxPointCount?s.maxPointCount:Number.POSITIVE_INFINITY,n=null!=s.maxRecordCount?s.maxRecordCount:Number.POSITIVE_INFINITY,r=null!=s.maxVertexCount?s.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)e=this.items.length>i;else if(this.items.length>n)e=!0;else{const t=this.hasZ?this.hasM?4:3:this.hasM?3:2,i=this.featureAdapter;e=this.items.reduce((t,e)=>{const n=i.getGeometry(e);return t+(n&&n.coords.length||0)},0)/t>r}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(e)}}]}}_createStatisticsQueryResponse(t){const e={attributes:{}},i=[],n=new Map,r=new Map,s=new Map,a=new Map,u=new P(t,this.featureAdapter,this.fieldsIndex),o=t.outStatistics,{groupByFieldsForStatistics:c,having:l,orderByFields:h}=t,f=c&&c.length,d=!!f,m=d&&c[0],p=d&&!this.fieldsIndex.get(m);for(const y of o){const{outStatisticFieldName:t,statisticType:o}=y,h=y,g="exceedslimit"!==o?y.onStatisticField:void 0,b="percentile_disc"===o||"percentile_cont"===o,x=d&&1===f&&(g===m||p)&&"count"===o;if(d){if(!s.has(g)){const t=[];for(const e of c){const i=this._getAttributeValues(u,e,n);t.push(i)}s.set(g,this._calculateUniqueValues(t))}const e=s.get(g);for(const i in e){const{count:r,data:s,items:o,itemPositions:f}=e[i],d=s.join(",");if(!l||u.validateItems(o,l)){const e=a.get(d)||{attributes:{}};let i=null;if(x)i=r;else{const t=this._getAttributeValues(u,g,n),e=f.map(e=>t[e]);i=b&&"statisticParameters"in h?this._getPercentileValue(h,e):this._getStatisticValue(h,e)}e.attributes[t]=i,c.forEach((t,i)=>e.attributes[this.fieldsIndex.get(t)?t:"EXPR_"+(i+1)]=s[i]),a.set(d,e)}}}else{const i=this._getAttributeValues(u,g,n);e.attributes[t]=b&&"statisticParameters"in h?this._getPercentileValue(h,i):this._getStatisticValue(h,i,r)}i.push({name:t,alias:t,type:"esriFieldTypeDouble"})}const g=d?Array.from(a.values()):[e];return this._sortFeatures(g,h,(t,e)=>t.attributes[e]),{fields:i,features:g}}_getStatisticValue(t,e,i){const{onStatisticField:n,statisticType:r}=t,s=i&&i.has(n)?i.get(n):this._calculateStatistics(e);return i&&i.set(n,s),s["var"===r?"variance":r]}_getPercentileValue(t,e){const{onStatisticField:i,statisticParameters:n,statisticType:r}=t,{value:s,orderBy:a}=n,u="desc"===a,o=this.fieldsIndex.get(i),c=[...e].filter(t=>null!=t).sort((t,e)=>B(t,e,o,u));return this._calculatePercentile(c,s,"percentile_disc"===r)}_getAttributeValues(t,e,i){if(i.has(e))return i.get(e);const n=this.fieldsIndex.get(e),r=this.items.map(i=>t.getFieldValue(i,e,n));return i.set(e,r),r}_calculateStatistics(t){let e=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,n=null,r=null,s=null,a=null;const u=[];let o=0;for(const c of t)"string"==typeof c?o++:null==c||isNaN(c)||(n+=c,e=Math.min(e,c),i=Math.max(i,c),u.push(c),o++);if(o){r=n/o;let t=0;for(const e of u)t+=Math.pow(e-r,2);a=o>1?t/(o-1):0,s=Math.sqrt(a)}else e=null,i=null;return{avg:r,count:o,max:i,min:e,stddev:s,sum:n,variance:a}}_calculateUniqueValues(t){const e={},i=this.items,n=i.length;for(let r=0;r<n;r++){const n=i[r],s=[];for(const e of t)s.push(e[r]);const a=s.join(",");null==e[a]?e[a]={count:1,data:s,items:[n],itemPositions:[r]}:(e[a].count++,e[a].items.push(n),e[a].itemPositions.push(r))}return e}_calculatePercentile(t,e,i){if(0===t.length)return null;if(e<=0)return t[0];if(e>=1)return t[t.length-1];const n=(t.length-1)*e,r=Math.floor(n),s=r+1,a=n%1,u=t[r],o=t[s];return s>=t.length||i||"string"==typeof u||"string"==typeof o?u:u*(1-a)+o*a}}var q=V;const z=new Set,D=new f["c"](2e6);let Z=0;const X=Object(g["b"])(),k=Object(g["b"])();e["a"]=class{constructor(t){this.capabilities={query:p["a"]},this.geometryType=t.geometryType,this.hasM=t.hasM,this.hasZ=t.hasZ,this.objectIdField=t.objectIdField,this.spatialReference=t.spatialReference,this.definitionExpression=t.definitionExpression,this.featureStore=t.featureStore,this.aggregateAdapter=t.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache()),this.timeInfo=t.timeInfo,t.cacheSpatialQueries&&(this._geometryQueryCache=new f["b"](Z+++"$$",D)),this.fieldsIndex=new m["a"](t.fields),t.scheduler&&t.task&&(this._frameQueue=new d["a"],this._frameTask=t.scheduler.registerTask(t.task,t=>this._update(t),()=>this._frameQueue.length>0))}destroy(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null),this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null),this.fieldsIndex.destroy()}get featureAdapter(){return this.featureStore.featureAdapter}get fullExtent(){const t=this.featureStore.fullBounds;return t?{xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:Object(A["d"])(this.spatialReference)}:null}get timeExtent(){return this.timeInfo?(this._timeExtent||(this._timeExtent=Object(N["a"])(this.timeInfo,this.featureStore)),this._timeExtent):null}clearCache(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null}async executeQuery(t={},e){let i,r=Object(n["a"])(t);try{r=await this._schedule(()=>Object(A["b"])(r,this.definitionExpression,this.spatialReference),e),r=await this._reschedule(()=>this._checkQuerySupport(r),e),i=await this._reschedule(()=>this._executeGeometryQuery(r,e),e),i=await this._reschedule(()=>i.executeAggregateIdsQuery(r),e),i=await this._reschedule(()=>i.executeObjectIdsQuery(r),e),i=await this._reschedule(()=>i.executeTimeQuery(r),e),i=await this._reschedule(()=>i.executeAttributesQuery(r),e)}catch(s){if(s!==A["a"])throw s;i=new q([],null,this)}return i.createQueryResponse(r)}async executeQueryForCount(t={},e){let i,r=Object(n["a"])(t);r.returnGeometry=!1,r.returnCentroid=!1,r.outSR=null;try{r=await this._schedule(()=>Object(A["b"])(r,this.definitionExpression,this.spatialReference),e),r=await this._reschedule(()=>this._checkQuerySupport(r),e),i=await this._reschedule(()=>this._executeGeometryQuery(r,e),e),i=await this._reschedule(()=>i.executeAggregateIdsQuery(r),e),i=await this._reschedule(()=>i.executeObjectIdsQuery(r),e),i=await this._reschedule(()=>i.executeTimeQuery(r),e),i=await this._reschedule(()=>i.executeAttributesQuery(r),e)}catch(s){if(s!==A["a"])throw s;return 0}return i.createQueryResponseForCount(r)}async executeQueryForExtent(t={},e){let i,r=Object(n["a"])(t);const s=r.outSR;try{r=await this._schedule(()=>Object(A["b"])(r,this.definitionExpression,this.spatialReference),e),r=await this._reschedule(()=>this._checkQuerySupport(r),e),r.returnGeometry=!0,r.returnCentroid=!1,r.outSR=null,i=await this._reschedule(()=>this._executeGeometryQuery(r,e),e),i=await this._reschedule(()=>i.executeAggregateIdsQuery(r),e),i=await this._reschedule(()=>i.executeObjectIdsQuery(r),e),i=await this._reschedule(()=>i.executeTimeQuery(r),e),i=await this._reschedule(()=>i.executeAttributesQuery(r),e);const t=i.size;if(!t)return{count:t,extent:null};Object(g["j"])(k,g["a"]),this.featureStore.forEachBounds(i.items,t=>Object(g["e"])(k,t),X);const n={xmin:k[0],ymin:k[1],xmax:k[3],ymax:k[4],spatialReference:Object(A["d"])(this.spatialReference)};this.hasZ&&isFinite(k[2])&&isFinite(k[5])&&(n.zmin=k[2],n.zmax=k[5]);const a=Object(y["b"])(n,i.spatialReference,s);if(a.spatialReference=Object(A["d"])(s||this.spatialReference),a.xmax-a.xmin==0){const t=Object(l["c"])(a.spatialReference);a.xmin-=t,a.xmax+=t}if(a.ymax-a.ymin==0){const t=Object(l["c"])(a.spatialReference);a.ymin-=t,a.ymax+=t}if(this.hasZ&&null!=a.zmin&&null!=a.zmax&&a.zmax-a.zmin==0){const t=Object(l["c"])(a.spatialReference);a.zmin-=t,a.zmax+=t}return{count:t,extent:a}}catch(a){if(a===A["a"])return{count:0,extent:null};throw a}}async executeQueryForIds(t={},e){return this.executeQueryForIdSet(t,e).then(t=>Array.from(t))}async executeQueryForIdSet(t={},e){let i,r=Object(n["a"])(t);r.returnGeometry=!1,r.returnCentroid=!1,r.outSR=null;try{r=await this._schedule(()=>Object(A["b"])(r,this.definitionExpression,this.spatialReference),e),r=await this._reschedule(()=>this._checkQuerySupport(r),e),i=await this._reschedule(()=>this._executeGeometryQuery(r,e),e),i=await this._reschedule(()=>i.executeAggregateIdsQuery(r),e),i=await this._reschedule(()=>i.executeObjectIdsQuery(r),e),i=await this._reschedule(()=>i.executeTimeQuery(r),e),i=await this._reschedule(()=>i.executeAttributesQuery(r),e);const t=i.items,n=new Set;return await this._reschedule(()=>{for(const e of t)n.add(i.featureAdapter.getObjectId(e))},e),n}catch(s){if(s===A["a"])return new Set;throw s}}async executeQueryForLatestObservations(t={},e){if(!this.timeInfo||!this.timeInfo.trackIdField)throw new s["a"]("feature-store:unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:t,timeInfo:this.timeInfo});let i,r=Object(n["a"])(t);try{r=await this._schedule(()=>Object(A["b"])(r,this.definitionExpression,this.spatialReference),e),r=await this._reschedule(()=>this._checkQuerySupport(r),e),i=await this._reschedule(()=>this._executeGeometryQuery(r,e),e),i=await this._reschedule(()=>i.executeAggregateIdsQuery(r),e),i=await this._reschedule(()=>i.executeObjectIdsQuery(r),e),i=await this._reschedule(()=>i.executeTimeQuery(r),e),i=await this._reschedule(()=>i.executeAttributesQuery(r),e),i=await this._reschedule(()=>i.filterLatest(),e)}catch(a){if(a!==A["a"])throw a;i=new q([],null,this)}return i.createQueryResponse(r)}async _schedule(t,e){return this._frameQueue?this._frameQueue.push(t,e):t()}async _reschedule(t,e){return this._frameQueue?this._frameQueue.unshift(t,e):t()}_update(t){for(this._budget=t;!t.done&&this._frameQueue&&this._frameQueue.process();)t.madeProgress();this._budget=null}_getAll(){if(!this._allItems){const t=[];this.featureStore.forEach(e=>t.push(e)),this._allItems=new q(t,null,this)}return this._allItems}async _executeGeometryQuery(t,e){const{geometry:i,outSR:n,spatialRel:s}=t,a=Object(u["i"])(n)&&!Object(u["c"])(this.spatialReference,n),o=this._geometryQueryCache?a?JSON.stringify({geometry:i,spatialRelationship:s,outSpatialReference:n}):JSON.stringify({geometry:i,spatialRelationship:s}):null;if(o){const t=this._geometryQueryCache.get(o);if(!Object(r["i"])(t))return t}const c=async e=>{if(a&&(t.returnGeometry||t.returnCentroid)){const t=await e.project(n);return o&&this._geometryQueryCache.put(o,t,t.size||1),t}return o&&this._geometryQueryCache.put(o,e,e.size||1),e};if(!i)return c(this._getAll());const l=this.featureAdapter;if("esriSpatialRelDisjoint"===s){const t=this._searchFeatures(this._getQueryBBoxes(i));if(!t.length)return c(this._getAll());let n,r;const a=new Set;for(const e of t)a.add(l.getObjectId(e));return await this._reschedule(()=>{let t=0;n=new Array(a.size),this.featureStore.forEach(e=>n[t++]=e),r=a},e),c(await this._reschedule(async()=>{const t=await Object(A["g"])(s,i,this.geometryType,this.hasZ,this.hasM);return new q(await this._runSpatialFilter(n,e=>!r.has(l.getObjectId(e))||t(l.getGeometry(e)),e),i,this)},e))}const h=this._searchFeatures(this._getQueryBBoxes(i));if(!h.length){const t=new q([],i,this);return o&&this._geometryQueryCache.put(o,t,t.size||1),t}if(this._canExecuteSoloPass(i,t))return c(new q(h,i,this));const f=await Object(A["g"])(s,i,this.geometryType,this.hasZ,this.hasM),d=await this._runSpatialFilter(h,t=>f(l.getGeometry(t)),e);return c(new q(d,i,this))}async _runSpatialFilter(t,e,i){if(!e)return t;if(!this._budget)return t.filter(t=>e(t));let n=0;const r=new Array,s=async()=>{for(;n<t.length;){const a=t[n];e(a)&&r.push(a),this._budget.done&&await this._reschedule(()=>s(),i),++n}};return this._reschedule(()=>s(),i).then(()=>r)}_canExecuteSoloPass(t,e){const{geometryType:i}=this,{spatialRel:n}=e;return Object(A["c"])(t)&&("esriSpatialRelEnvelopeIntersects"===n||"esriGeometryPoint"===i&&("esriSpatialRelIntersects"===n||"esriSpatialRelContains"===n||"esriSpatialRelWithin"===n))}_getQueryBBoxes(t){if(Object(A["c"])(t)){if(Object(c["d"])(t))return[Object(h["i"])(t.xmin,t.ymin,t.xmax,t.ymax)];if(Object(c["g"])(t))return t.rings.map(t=>Object(h["i"])(Math.min(t[0][0],t[2][0]),Math.min(t[0][1],t[2][1]),Math.max(t[0][0],t[2][0]),Math.max(t[0][1],t[2][1])))}return[Object(o["a"])(Object(h["d"])(),t)]}_searchFeatures(t){for(const n of t)this.featureStore.forEachInBounds(n,t=>{z.add(t)});const e=new Array(z.size);let i=0;return z.forEach(t=>e[i++]=t),z.clear(),e}async _checkQuerySupport(t){if(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text)throw new s["a"]("feature-store:unsupported-query","Unsupported query options",{query:t});return Object(a["b"])([this._checkAttributesQuerySupport(t),this._checkStatisticsQuerySupport(t),Object(A["e"])(t,this.geometryType,this.spatialReference),Object(y["a"])(this.spatialReference,t.outSR)]).then(()=>t)}_checkAttributesQuerySupport(t){const{outFields:e,orderByFields:i,returnDistinctValues:n,outStatistics:r}=t,a=r?r.map(t=>t.outStatisticFieldName&&t.outStatisticFieldName.toLowerCase()):[];if(i&&i.length>0){const t=" asc",e=" desc",n=i.map(i=>{const n=i.toLowerCase();return n.indexOf(t)>-1?n.split(t)[0]:n.indexOf(e)>-1?n.split(e)[0]:i}).filter(t=>-1===a.indexOf(t));F(this.fieldsIndex,n,"orderByFields contains missing fields")}if(e&&e.length>0)F(this.fieldsIndex,e,"outFields contains missing fields");else if(n)throw new s["a"]("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:t});S(this.fieldsIndex,t.where)}async _checkStatisticsQuerySupport(t){const{outStatistics:e,groupByFieldsForStatistics:i,having:n}=t,r=i&&i.length,a=e&&e.length;if(n){if(!r||!a)throw new s["a"]("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:t});j(this.fieldsIndex,n,e)}if(a){if(!function(t){return t.every(t=>"exceedslimit"!==t.statisticType)}(e))return;const n=e.map(t=>t.onStatisticField);F(this.fieldsIndex,n,"onStatisticFields contains missing fields"),r&&F(this.fieldsIndex,i,"groupByFieldsForStatistics contains missing fields");for(const i of e){const{onStatisticField:e,statisticType:n}=i;if("percentile_disc"!==n&&"percentile_cont"!==n||!("statisticParameters"in i)){if("count"!==n&&e&&T(e,this.fieldsIndex))throw new s["a"]("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:i,query:t})}else{const{statisticParameters:e}=i;if(!e)throw new s["a"]("feature-store:unsupported-query","statisticParamters should be set for percentile type",{definition:i,query:t})}}}}}},"88d1":function(t,e,i){"use strict";i.d(e,"a",(function(){return u})),i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return a}));var n=i("c120"),r=i("7ffa"),s=i("8246");function a(t){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===t||"esriGeometryMultipoint"===t?s["a"]:"esriGeometryPolyline"===t?s["c"]:s["b"]}}}function u(t,e){if(Object(n["a"])("csp-restrictions"))return()=>({[e]:null,...t});try{let i=`this.${e} = null;`;for(const e in t)i+=`this${e.indexOf(".")?`["${e}"]`:"."+e} = ${JSON.stringify(t[e])};`;const n=new Function(i);return()=>new n}catch(i){return()=>({[e]:null,...t})}}function o(t={}){return[{name:"New Feature",description:"",prototype:{attributes:Object(r["a"])(t)}}]}},"901f":function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n=i("4637");function r(t,e){if(!(this instanceof r))return new r(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&("function"==typeof e?this.toBBox=e:this._initFormat(e)),this.clear()}function s(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function a(t,e){u(t,0,t.children.length,e,t)}function u(t,e,i,n,r){r||(r=p(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var s,a=e;a<i;a++)s=t.children[a],o(r,t.leaf?n(s):s);return r}function o(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function c(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function m(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(t,e,i,r,s){for(var a,u=[e,i];u.length;)(i=u.pop())-(e=u.pop())<=r||(a=e+Math.ceil((i-e)/r/2)*r,Object(n["a"])(t,a,e,i,s),u.push(e,a,a,i))}r.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!m(t,e))return i;for(var r,s,a,u,o=[];e;){for(r=0,s=e.children.length;r<s;r++)a=e.children[r],m(t,u=e.leaf?n(a):a)&&(e.leaf?i.push(a):d(t,u)?this._all(a,i):o.push(a));e=o.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!m(t,e))return!1;for(var n,r,s,a,u=[];e;){for(n=0,r=e.children.length;n<r;n++)if(s=e.children[n],m(t,a=e.leaf?i(s):s)){if(e.leaf||d(t,a))return!0;u.push(s)}e=u.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=p([]),this},remove:function(t,e){if(!t)return this;for(var i,n,r,a,u=this.data,o=this.toBBox(t),c=[],l=[];u||c.length;){if(u||(u=c.pop(),n=c[c.length-1],i=l.pop(),a=!0),u.leaf&&-1!==(r=s(t,u.children,e)))return u.children.splice(r,1),c.push(u),this._condense(c),this;a||u.leaf||!d(u,o)?n?(i++,u=n.children[i],a=!1):u=null:(c.push(u),l.push(i),i=0,n=u,u=u.children[0])}return this},toBBox:function(t){return t},compareMinX:c,compareMinY:l,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,n){var r,s=i-e+1,u=this._maxEntries;if(s<=u)return a(r=p(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(s)/Math.log(u)),u=Math.ceil(s/Math.pow(u,n-1))),(r=p([])).leaf=!1,r.height=n;var o,c,l,h,f=Math.ceil(s/u),d=f*Math.ceil(Math.sqrt(u));for(g(t,e,i,d,this.compareMinX),o=e;o<=i;o+=d)for(g(t,o,l=Math.min(o+d-1,i),f,this.compareMinY),c=o;c<=l;c+=f)h=Math.min(c+f-1,l),r.children.push(this._build(t,c,h,n-1));return a(r,this.toBBox),r},_chooseSubtree:function(t,e,i,n){for(var r,s,a,u,o,c,l,f,d,m;n.push(e),!e.leaf&&n.length-1!==i;){for(l=f=1/0,r=0,s=e.children.length;r<s;r++)o=h(a=e.children[r]),d=t,m=a,(c=(Math.max(m.maxX,d.maxX)-Math.min(m.minX,d.minX))*(Math.max(m.maxY,d.maxY)-Math.min(m.minY,d.minY))-o)<f?(f=c,l=o<l?o:l,u=a):c===f&&o<l&&(l=o,u=a);e=u||e.children[0]}return e},_insert:function(t,e,i){var n=this.toBBox,r=i?t:n(t),s=[],a=this._chooseSubtree(r,this.data,e,s);for(a.children.push(t),o(a,r);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(r,s,e)},_split:function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var s=this._chooseSplitIndex(i,r,n),u=p(i.children.splice(s,i.children.length-s));u.height=i.height,u.leaf=i.leaf,a(i,this.toBBox),a(u,this.toBBox),e?t[e-1].children.push(u):this._splitRoot(i,u)},_splitRoot:function(t,e){this.data=p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,r,s,a,o,c,l,f,d,m,p,g,y,b;for(c=l=1/0,n=e;n<=i-e;n++)r=u(t,0,n,this.toBBox),s=u(t,n,i,this.toBBox),d=r,m=s,p=void 0,g=void 0,y=void 0,b=void 0,p=Math.max(d.minX,m.minX),g=Math.max(d.minY,m.minY),y=Math.min(d.maxX,m.maxX),b=Math.min(d.maxY,m.maxY),a=Math.max(0,y-p)*Math.max(0,b-g),o=h(r)+h(s),a<c?(c=a,f=n,l=o<l?o:l):a===c&&o<l&&(l=o,f=n);return f},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:c,r=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var r,s,a=this.toBBox,c=u(t,0,e,a),l=u(t,i-e,i,a),h=f(c)+f(l);for(r=e;r<i-e;r++)s=t.children[r],o(c,t.leaf?a(s):s),h+=f(c);for(r=i-e-1;r>=e;r--)s=t.children[r],o(l,t.leaf?a(s):s),h+=f(l);return h},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)o(e[n],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():a(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},abb8:function(t,e,i){"use strict";function n(t,e){if(!t)return null;const i=e.featureAdapter,{startTimeField:n,endTimeField:r}=t;let s=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;if(n&&r)e.forEach(t=>{const e=i.getAttribute(t,n),u=i.getAttribute(t,r);null==e||isNaN(e)||(s=Math.min(s,e)),null==u||isNaN(u)||(a=Math.max(a,u))});else{const t=n||r;e.forEach(e=>{const n=i.getAttribute(e,t);null==n||isNaN(n)||(s=Math.min(s,n),a=Math.max(a,n))})}return{start:s,end:a}}function r(t,e,i){if(!e||!t)return null;const{startTimeField:n,endTimeField:r}=t;if(!n&&!r)return null;const{start:s,end:a}=e;return null===s&&null===a?null:void 0===s&&void 0===a?()=>!1:n&&r?function(t,e,i,n,r){return null!=n&&null!=r?s=>{const a=t.getAttribute(s,e),u=t.getAttribute(s,i);return(null==a||a<=r)&&(null==u||u>=n)}:null!=n?e=>{const r=t.getAttribute(e,i);return null==r||r>=n}:null!=r?i=>{const n=t.getAttribute(i,e);return null==n||n<=r}:void 0}(i,n,r,s,a):function(t,e,i,n){return null!=i&&null!=n&&i===n?n=>t.getAttribute(n,e)===i:null!=i&&null!=n?r=>{const s=t.getAttribute(r,e);return s>=i&&s<=n}:null!=i?n=>t.getAttribute(n,e)>=i:null!=n?i=>t.getAttribute(i,e)<=n:void 0}(i,n||r,s,a)}i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return r}))},d518:function(t,e,i){"use strict";i.d(e,"a",(function(){return O})),i.d(e,"b",(function(){return T})),i.d(e,"c",(function(){return D})),i.d(e,"d",(function(){return N})),i.d(e,"e",(function(){return z})),i.d(e,"f",(function(){return v})),i.d(e,"g",(function(){return q})),i.d(e,"h",(function(){return A})),i.d(e,"i",(function(){return R}));var n=i("b2b2"),r=i("fa8a"),s=i("ce50"),a=i("f4cc"),u=i("7f83"),o=i("2172"),c=i("3cd6"),l=i("f8d4"),h=i("a9ab"),f=i("8048"),d=i("a8d5"),m=i("8152"),p=i("6655"),g=(i("d97e"),i("1ec3"));function y(t,e){return t?e?4:3:e?3:2}function b(t,e,i,n){return _(t,e,i,n.coords[0],n.coords[1])}function x(t,e,i,n,r,s){const a=y(r,s),{coords:u,lengths:o}=n;if(!o)return!1;for(let c=0,l=0;c<o.length;c++,l+=a)if(!_(t,e,i,u[l],u[l+1]))return!1;return!0}function _(t,e,i,n,r){if(!t)return!1;const s=y(e,i),{coords:a,lengths:u}=t;let o=!1,c=0;for(const l of u)o=I(o,a,s,c,l,n,r),c+=l*s;return o}function I(t,e,i,n,r,s,a){let u=t,o=n;for(let c=n,l=n+r*i;c<l;c+=i){o=c+i,o===l&&(o=n);const t=e[c],r=e[c+1],h=e[o],f=e[o+1];(r<a&&f>=a||f<a&&r>=a)&&t+(a-r)/(f-r)*(h-t)<s&&(u=!u)}return u}const w=new r["a"]({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),O=Object.freeze({}),S=new m["a"],j=new m["a"],M=new m["a"],F={esriGeometryPoint:p["m"],esriGeometryPolyline:p["o"],esriGeometryPolygon:p["n"],esriGeometryMultipoint:p["l"]};function R(t,e,i,n=t.hasZ,r=t.hasM){const s=t.hasZ&&n,a=t.hasM&&r;if(i){const u=Object(p["u"])(M,e,t.hasZ,t.hasM,"esriGeometryPoint",i,n,r);return Object(p["m"])(u,s,a)}return Object(p["m"])(e,s,a)}function v(t,e,i,n,r,s,a=e,u=i){const o=e&&a,c=i&&u,l=n?"coords"in n?n:n.geometry:null;if(!l)return null;if(r){let n=Object(p["q"])(j,l,e,i,t,r,a,u);return s&&(n=Object(p["u"])(M,n,o,c,t,s)),F[t](n,o,c)}if(s){const n=Object(p["u"])(M,l,e,i,t,s,a,u);return F[t](n,o,c)}return Object(p["x"])(S,l,e,i,a,u),F[t](S,o,c)}async function T(t,e,i){const{outFields:n,orderByFields:r,groupByFieldsForStatistics:s,outStatistics:a}=t;if(n)for(let u=0;u<n.length;u++)n[u]=n[u].trim();if(r)for(let u=0;u<r.length;u++)r[u]=r[u].trim();if(s)for(let u=0;u<s.length;u++)s[u]=s[u].trim();if(a)for(let u=0;u<a.length;u++)a[u].onStatisticField&&(a[u].onStatisticField=a[u].onStatisticField.trim());return t.geometry&&!t.outSR&&(t.outSR=t.geometry.spatialReference),A(t,e,i)}async function A(t,e,i){if(!t)return null;let{where:r}=t;if(t.where=r=r&&r.trim(),(!r||/^1 *= *1$/.test(r)||e&&e===r)&&(t.where=null),!t.geometry)return t;let s=await async function(t){const{geometry:e,distance:i,units:n}=t;if(null==i||"vertexAttributes"in e)return e;const r=e.spatialReference,s=n?w.fromJSON(n):Object(f["e"])(r),a=r&&(Object(u["f"])(r)||Object(u["m"])(r))?e:await Object(g["a"])(r,u["a"]).then(()=>Object(g["b"])(e,u["a"]));return(await V())(a.spatialReference,a,i,s)}(t);if(t.distance=0,t.units=null,"esriSpatialRelEnvelopeIntersects"===t.spatialRel){const{spatialReference:e}=t.geometry;s=Object(l["a"])(s),s.spatialReference=e}t.geometry=s,await Object(g["a"])(s.spatialReference,i);const a=(await Object(d["a"])(Object(h["a"])(s)))[0];if(Object(n["g"])(a))throw O;const o=a.toJSON(),c=await Object(g["b"])(o,o.spatialReference,i);if(!c)throw O;return c.spatialReference=i,t.geometry=c,t}function N(t){return t&&E in t?JSON.parse(JSON.stringify(t,Q)):t}const E="_geVersion",Q=(t,e)=>t!==E?e:void 0,P={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},G={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},C={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},Y={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function B(){return Promise.all([i.e("chunk-2d22cf8c"),i.e("chunk-180660b2")]).then(i.bind(null,"00ac"))}function V(){return B().then(t=>t.geodesicBuffer)}function q(t,e,i,n,r){if(Object(h["g"])(e)&&"esriGeometryPoint"===i&&("esriSpatialRelIntersects"===t||"esriSpatialRelContains"===t)){const t=Object(p["g"])(new m["a"],e,!1,!1);return Object(a["u"])(e=>b(t,!1,!1,e))}if(Object(h["g"])(e)&&"esriGeometryMultipoint"===i){const i=Object(p["g"])(new m["a"],e,!1,!1);if("esriSpatialRelContains"===t)return Object(a["u"])(t=>x(i,!1,!1,t,n,r))}if(Object(h["d"])(e)&&"esriGeometryPoint"===i&&("esriSpatialRelIntersects"===t||"esriSpatialRelContains"===t))return Object(a["u"])(t=>Object(o["e"])(e,v(i,n,r,t)));if(Object(h["d"])(e)&&"esriGeometryMultipoint"===i&&"esriSpatialRelContains"===t)return Object(a["u"])(t=>Object(o["d"])(e,v(i,n,r,t)));if(Object(h["d"])(e)&&"esriSpatialRelIntersects"===t){const t=Object(c["b"])(i);return Object(a["u"])(s=>t(e,v(i,n,r,s)))}return B().then(s=>{const a=s[P[t]].bind(null,e.spatialReference,e);return t=>a(v(i,n,r,t))})}async function z(t,e,i){const{spatialRel:n,geometry:r}=t;if(r){if(!0!==G[n])throw new s["a"]("feature-store:unsupported-query","Unsupported query spatial relationship",{query:t});if(Object(u["i"])(r.spatialReference)&&Object(u["i"])(i)){if(!function(t){return!0===C[Object(h["c"])(t)]}(r))throw new s["a"]("feature-store:unsupported-query","Unsupported query geometry type",{query:t});if(!function(t){return!0===Y[t]}(e))throw new s["a"]("feature-store:unsupported-query","Unsupported layer geometry type",{query:t});if(t.outSR)return Object(g["a"])(t.geometry&&t.geometry.spatialReference,t.outSR)}}}function D(t){if(Object(h["d"])(t))return!0;if(Object(h["g"])(t)){for(const e of t.rings){if(5!==e.length)return!1;if(e[0][0]!==e[1][0]||e[0][0]!==e[4][0]||e[2][0]!==e[3][0]||e[0][1]!==e[3][1]||e[0][1]!==e[4][1]||e[1][1]!==e[2][1])return!1}return!0}return!1}},d641:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));const n={convertToGEGeometry:function(t,e){return null==e?null:t.convertJSONToGeometry(e)},exportPoint:function(t,e,i){const n=new r(t.getPointX(e),t.getPointY(e),i),s=t.hasZ(e),a=t.hasM(e);return s&&(n.z=t.getPointZ(e)),a&&(n.m=t.getPointM(e)),n},exportPolygon:function(t,e,i){return new s(t.exportPaths(e),i,t.hasZ(e),t.hasM(e))},exportPolyline:function(t,e,i){return new a(t.exportPaths(e),i,t.hasZ(e),t.hasM(e))},exportMultipoint:function(t,e,i){return new u(t.exportPoints(e),i,t.hasZ(e),t.hasM(e))},exportExtent:function(t,e,i){const n=t.hasZ(e),r=t.hasM(e),s=new o(t.getXMin(e),t.getYMin(e),t.getXMax(e),t.getYMax(e),i);if(n){const i=t.getZExtent(e);s.zmin=i.vmin,s.zmax=i.vmax}if(r){const i=t.getMExtent(e);s.mmin=i.vmin,s.mmax=i.vmax}return s}};class r{constructor(t,e,i){this.x=t,this.y=e,this.spatialReference=i,this.z=void 0,this.m=void 0}}class s{constructor(t,e,i,n){this.rings=t,this.spatialReference=e,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),n&&(this.hasM=n)}}class a{constructor(t,e,i,n){this.paths=t,this.spatialReference=e,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),n&&(this.hasM=n)}}class u{constructor(t,e,i,n){this.points=t,this.spatialReference=e,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),n&&(this.hasM=n)}}class o{constructor(t,e,i,n,r){this.xmin=t,this.ymin=e,this.xmax=i,this.ymax=n,this.spatialReference=r,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}},d7f2:function(t,e,i){"use strict";var n=i("aefa");e["a"]=class{constructor(t,e){this._storage=new n["c"],this._storage.maxSize=t,e&&this._storage.registerRemoveFunc("",e)}put(t,e){this._storage.put(t,e,1,1)}pop(t){return this._storage.pop(t)}get(t){return this._storage.get(t)}clear(){this._storage.clearAll()}destroy(){this._storage.clearAll()}}},d97e:function(t,e,i){"use strict";function n(t,e){return t?e?4:3:e?3:2}function r(t,e,i,r,u){if(!e||!e.lengths.length)return null;const o="upperLeft"===(null==u?void 0:u.originPosition)?-1:1;t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0);const c=t.coords,l=[],h=i?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:f,coords:d}=e,m=n(i,r);let p=0;for(const n of f){const t=s(h,d,p,n,i,r,o);t&&l.push(t),p+=n*m}if(l.sort((t,e)=>{let n=o*t[2]-o*e[2];return 0===n&&i&&(n=t[4]-e[4]),n}),l.length){let t=6*l[0][2];c[0]=l[0][0]/t,c[1]=l[0][1]/t,i&&(t=6*l[0][4],c[2]=0!==t?l[0][3]/t:0),(c[0]<h[0]||c[0]>h[1]||c[1]<h[2]||c[1]>h[3]||i&&(c[2]<h[4]||c[2]>h[5]))&&(c.length=0)}if(!c.length){const t=e.lengths[0]?a(d,0,f[0],i,r):null;if(!t)return null;c[0]=t[0],c[1]=t[1],i&&t.length>2&&(c[2]=t[2])}return t}function s(t,e,i,r,s,a,u=1){const o=n(s,a);let c=i,l=i+o,h=0,f=0,d=0,m=0,p=0;for(let n=0,y=r-1;n<y;n++,c+=o,l+=o){const i=e[c],n=e[c+1],r=e[c+2],a=e[l],u=e[l+1],o=e[l+2];let g=i*u-a*n;m+=g,h+=(i+a)*g,f+=(n+u)*g,s&&(g=i*o-a*r,d+=(r+o)*g,p+=g),i<t[0]&&(t[0]=i),i>t[1]&&(t[1]=i),n<t[2]&&(t[2]=n),n>t[3]&&(t[3]=n),s&&(r<t[4]&&(t[4]=r),r>t[5]&&(t[5]=r))}if(m*u>0&&(m*=-1),p*u>0&&(p*=-1),!m)return null;const g=[h,f,.5*m];return s&&(g[3]=d,g[4]=.5*p),g}function a(t,e,i,r,s){const a=n(r,s);let h=e,f=e+a,d=0,m=0,p=0,g=0;for(let n=0,y=i-1;n<y;n++,h+=a,f+=a){const e=t[h],i=t[h+1],n=t[h+2],s=t[f],a=t[f+1],y=t[f+2],b=r?o(e,i,n,s,a,y):u(e,i,s,a);if(b)if(d+=b,r){const t=l(e,i,n,s,a,y);m+=b*t[0],p+=b*t[1],g+=b*t[2]}else{const t=c(e,i,s,a);m+=b*t[0],p+=b*t[1]}}return d>0?r?[m/d,p/d,g/d]:[m/d,p/d]:i>0?r?[t[e],t[e+1],t[e+2]]:[t[e],t[e+1]]:null}function u(t,e,i,n){const r=i-t,s=n-e;return Math.sqrt(r*r+s*s)}function o(t,e,i,n,r,s){const a=n-t,u=r-e,o=s-i;return Math.sqrt(a*a+u*u+o*o)}function c(t,e,i,n){return[t+.5*(i-t),e+.5*(n-e)]}function l(t,e,i,n,r,s){return[t+.5*(n-t),e+.5*(r-e),i+.5*(s-i)]}i.d(e,"a",(function(){return r}))}}]);
//# sourceMappingURL=chunk-1d62c7a3.f6f73887.js.map