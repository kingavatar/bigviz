{"version":3,"sources":["webpack:///./node_modules/@arcgis/core/libs/i3s/I3SWorker.js","webpack:///./node_modules/@arcgis/core/views/3d/layers/SceneLayerWorker.js"],"names":["t","then","i","default","e","locateFile","onRuntimeInitialized","catch","l","async","geometryBuffer","result","transferList","r","n","o","s","byteLength","f","_malloc","Uint8Array","HEAPU8","buffer","set","a","dracoDecompressPointCloudData","_free","error","length","u","featureIds","c","positions","push","setLegacySchema","context","jsonSchema","modifications","Float64Array","setModifications","isGeodetic","localOrigin","globalTrafo","mbs","obb","elevationOffset","geometryDescriptor","y","indexToVertexProjector","b","vertexToRenderProjector","m","d","E","BYTES_PER_ELEMENT","p","g","h","w","byteOffset","A","center","halfSize","quaternion","_","L","isDraco","isLegacy","color","layouts","some","name","normal","needNormals","uv0","uvRegion","featureIndex","T","process","normalReferenceFrame","discarded","I","componentOffsets","P","U","interleavedVertedData","B","indicesType","Uint16Array","indices","Uint32Array","F","x","positionIndicesType","positionIndices","O","layout","interleavedVertexData","hasColors","hasModifications","positionData","data","transformedGeometry","filterOBBs","destroy","transform"],"mappings":"kuBAI8G,SAAS,IAAI,OAAO,IAAI,EAAE,eAAGA,GAAG,gDAA8BC,MAAK,SAAUD,GAAG,OAAOA,EAAEE,KAAKD,KAAK,EAAGE,QAAQC,MAAM,MAAMF,EAAEE,EAAE,CAACC,WAAW,EAAEC,qBAAqB,IAAIN,EAAEE,YAAYA,EAAED,QAAUM,MAAOP,GAAG,eAAEA,KAAM,EAAE,SAAS,EAAEA,GAAG,OAAO,eAAE,iBAAiBA,GAAK,IAAI,ECAgpB,EAAEQ,EAAnyBC,eAAe,EAAEL,SAAS,IAAI,MAAMJ,EAAE,CAACI,EAAEM,gBAAgB,MAAM,CAACC,OAAO,EAAEP,EAAEJ,GAAGY,aAAaZ,GAAGS,eAAe,EAAET,GAAG,IAAIa,QAAQ,IAAI,MAAMC,EAAE,CAACd,EAAEU,iBAAiBA,eAAeK,GAAGf,EAAEgB,EAAED,EAAEE,WAAWC,EAAEV,EAAEW,QAAQH,GAAGd,EAAE,IAAIkB,WAAWZ,EAAEa,OAAOC,OAAOJ,EAAEF,GAAGd,EAAEqB,IAAI,IAAIH,WAAWL,IAAI,MAAMS,EAAEhB,EAAEiB,8BAA8BP,EAAEhB,EAAEe,YAAY,GAAGT,EAAEkB,MAAMR,GAAGM,EAAEG,MAAMC,OAAO,EAAE,KAAK,aAAaJ,EAAEG,MAAQ,MAAME,GAAG,OAAOhB,EAAEW,EAAEM,iBAAY,EAAOjB,EAAEe,QAAQ,EAAE,eAAEJ,EAAEM,YAAY,KAAKC,EAAE,eAAEP,EAAEQ,WAAgD,OAArCH,GAAGf,EAAEmB,KAAKJ,EAAEP,QAAQR,EAAEmB,KAAKF,EAAET,QAAc,CAACX,OAAO,CAACqB,UAAUD,EAAED,WAAWD,GAAGjB,aAAaE,GAAGL,eAAe,EAAEL,SAAS,IAAI,EAAEA,GAAG,MAAMJ,EAAE,CAACsB,OAAOlB,EAAEkB,QAAQ,MAAM,CAACX,OAAOX,EAAEY,aAAa,CAACZ,EAAEsB,SAASb,eAAe,EAAEL,SAAS,IAAI,EAAEA,GAAGK,eAAe,EAAEL,SAAS,IAAII,EAAE0B,gBAAgB9B,EAAE+B,QAAQ/B,EAAEgC,YAAY,SAAS,EAAEhC,GAAG,EAAEA,GAAW,SAAS,EAAEA,GAAG,MAAMJ,EAAEI,EAAEiC,cAAcxB,EAAEL,EAAEW,QAAQ,EAAEnB,EAAE4B,QAAQd,EAAE,IAAIwB,aAAa9B,EAAEa,OAAOC,OAAOT,EAAEb,EAAE4B,QAAQ,IAAI,IAAIxB,EAAE,EAAEA,EAAEJ,EAAE4B,SAASxB,EAAEU,EAAEV,GAAGJ,EAAEI,GAAGI,EAAE+B,iBAAiBnC,EAAE+B,QAAQtB,EAAEb,EAAE4B,OAAOxB,EAAEoC,YAAYhC,EAAEkB,MAAMb,GAAG,SAAS,EAAEA,EAAEC,GAAG,IAAIN,EAAE,OAAO,KAAK,MAAM2B,QAAQpB,EAAE0B,YAAYzB,EAAE0B,YAAYxB,EAAEyB,IAAIzC,EAAE0C,IAAIpB,EAAEqB,gBAAgBhB,EAAEnB,eAAeqB,EAAEe,mBAAmBC,EAAEC,uBAAuBC,EAAEC,wBAAwBC,GAAGtC,EAAEuC,EAAE5C,EAAEW,QAAQY,EAAEd,YAAYoC,EAAE7C,EAAEW,QAAQ,GAAGmB,aAAagB,mBAAmBC,EAAE,IAAInC,WAAWZ,EAAEa,OAAOC,OAAO8B,EAAErB,EAAEd,YAAYsC,EAAEhC,IAAI,IAAIH,WAAWW,IAAI,MAAMyB,EAAE,IAAIlB,aAAa9B,EAAEa,OAAOC,OAAO+B,EAAE,IAAII,EAAED,EAAExC,GAAG,IAAI0C,EAAEF,EAAEG,WAAW,EAAEH,EAAEF,kBAAkBM,EAAE,IAAItB,aAAakB,EAAElC,OAAOoC,GAAGD,EAAEG,EAAE1C,GAAGwC,GAAG,GAAGF,EAAEF,kBAAkBM,EAAE,IAAItB,aAAakB,EAAElC,OAAOoC,GAAGD,EAAEG,EAAE1D,GAAGwD,GAAG,EAAEF,EAAEF,kBAAkB,eAAE9B,KAAKoC,EAAE,IAAItB,aAAakB,EAAElC,OAAOoC,GAAGD,EAAEG,EAAEpC,EAAEqC,QAAQH,GAAG,EAAEF,EAAEF,kBAAkBM,EAAE,IAAItB,aAAakB,EAAElC,OAAOoC,GAAGD,EAAEG,EAAEpC,EAAEsC,UAAUJ,GAAG,EAAEF,EAAEF,kBAAkBM,EAAE,IAAItB,aAAakB,EAAElC,OAAOoC,GAAGD,EAAEG,EAAEpC,EAAEuC,aAAa,MAAMC,EAAEjB,EAAEkB,EAAE,CAACC,SAAQ,EAAGC,UAAS,EAAGC,MAAMvD,EAAEwD,QAAQC,KAAMlE,GAAGA,EAAEkE,KAAMlE,GAAG,UAAUA,EAAEmE,OAASC,OAAO3D,EAAE4D,aAAa5D,EAAEwD,QAAQC,KAAMlE,GAAGA,EAAEkE,KAAMlE,GAAG,qBAAqBA,EAAEmE,OAASG,IAAI7D,EAAEwD,QAAQC,KAAMlE,GAAGA,EAAEkE,KAAMlE,GAAG,QAAQA,EAAEmE,OAASI,SAAS9D,EAAEwD,QAAQC,KAAMlE,GAAGA,EAAEkE,KAAMlE,GAAG,aAAaA,EAAEmE,OAASK,aAAaZ,EAAEY,cAAcC,EAAErE,EAAEsE,QAAQ/D,IAAIF,EAAE+B,IAAIQ,EAAEG,EAAEtC,WAAW+C,EAAEC,EAAEZ,EAAExB,EAAEoB,EAAEE,EAAEtC,EAAEkE,sBAAsB,GAAGvE,EAAEkB,MAAM2B,GAAG7C,EAAEkB,MAAM0B,GAAGyB,EAAElD,MAAMC,OAAO,EAAE,KAAK,aAAaiD,EAAElD,MAAQ,GAAGkD,EAAEG,UAAU,OAAO,KAAK,MAAMC,EAAEJ,EAAEK,iBAAiBtD,OAAO,EAAE,eAAEiD,EAAEK,kBAAkB,KAAKC,EAAEN,EAAE/C,WAAWF,OAAO,EAAE,eAAEiD,EAAE/C,YAAY,KAAKsD,EAAE,eAAEP,EAAEQ,uBAAuB/D,OAAOgE,EAAE,IAAIT,EAAEU,YAAY,eAAE,IAAIC,YAAYX,EAAEY,QAAQnE,OAAOuD,EAAEY,QAAQ9B,WAAWkB,EAAEY,QAAQxE,WAAW,IAAI,eAAE,IAAIyE,YAAYb,EAAEY,QAAQnE,OAAOuD,EAAEY,QAAQ9B,WAAWkB,EAAEY,QAAQxE,WAAW,IAAI0E,EAAE,eAAEd,EAAE7C,WAAW4D,EAAE,IAAIf,EAAEgB,oBAAoB,eAAE,IAAIL,YAAYX,EAAEiB,gBAAgBxE,OAAOuD,EAAEiB,gBAAgBnC,WAAWkB,EAAEiB,gBAAgB7E,WAAW,IAAI,eAAE,IAAIyE,YAAYb,EAAEiB,gBAAgBxE,OAAOuD,EAAEiB,gBAAgBnC,WAAWkB,EAAEiB,gBAAgB7E,WAAW,IAAI8E,EAAE,CAACC,OAAOnF,EAAEwD,QAAQ,GAAG4B,sBAAsBb,EAAEK,QAAQH,EAAEY,UAAUrB,EAAEqB,UAAUC,iBAAiBtB,EAAEsB,iBAAiBC,aAAa,CAACC,KAAKV,EAAEF,QAAQG,IAAI,OAAOT,GAAGrE,EAAEmB,KAAKkD,EAAE7D,QAAQ2D,GAAGnE,EAAEmB,KAAKgD,EAAE3D,QAAQR,EAAEmB,KAAKmD,GAAGtE,EAAEmB,KAAKqD,EAAEhE,QAAQR,EAAEmB,KAAK0D,EAAErE,QAAQR,EAAEmB,KAAK2D,EAAEtE,QAAQ,CAAC4D,iBAAiBD,EAAEnD,WAAWqD,EAAEmB,oBAAoBP,EAAEnD,IAAIiC,EAAEjC,KAAK,SAAS,EAAExC,GAAG,OAAO,IAAIA,EAAE,EAAE,IAAIA,EAAE,EAAE,IAAIA,EAAE,EAAE,EAAE,SAAS,EAAEA,GAAG,MAAM+B,QAAQnC,EAAEsB,OAAOT,GAAGT,EAAEU,EAAEN,EAAEW,QAAQN,EAAEI,YAAYF,EAAEF,EAAEI,WAAWqB,aAAagB,kBAAkBtC,EAAE,IAAIsB,aAAa9B,EAAEa,OAAOC,OAAOR,EAAEC,GAAGG,EAAE,IAAIoB,aAAazB,GAAGG,EAAEO,IAAIL,GAAGV,EAAE+F,WAAWvG,EAAEc,EAAEC,GAAGG,EAAEK,IAAIP,GAAGR,EAAEkB,MAAMZ,GAAG,SAAS,EAAEV,GAAGI,GAAGA,EAAEgG,QAAQpG,GAAG,SAASqD,EAAErD,EAAEJ,GAAG,IAAI,IAAIa,EAAE,EAAEA,EAAEb,EAAE4B,SAASf,EAAET,EAAES,GAAGb,EAAEa,GAAG,SAAS,IAAI,OAAOL,EAAE,kBAAK,IAAI,EAAE,IAAIP,KAAMG,IAAII,EAAEJ,EAAE,EAAE,QAAS,GAAG,MAAM,EAAE,CAACqG,UAAU,EAAED,QAAQ","file":"js/chunk-2d0bcda5.53e08d9d.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{create as t,reject as e}from\"../../core/promiseUtils.js\";import{getAssetUrl as i}from\"../../assets.js\";function n(){return o||(o=t((t=>import(\"../../chunks/i3s.js\").then((function(t){return t.i})).then((({default:e})=>{const i=e({locateFile:r,onRuntimeInitialized:()=>t(i)});delete i.then})))).catch((t=>e(t)))),o}function r(t){return i(`esri/libs/i3s/${t}`)}let o;export{n as getWorkerModule};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{slice as e}from\"../../../core/typedArrayUtil.js\";import{isSome as t}from\"../../../core/maybe.js\";import{resolve as r}from\"../../../core/promiseUtils.js\";import{getWorkerModule as n}from\"../../../libs/i3s/I3SWorker.js\";async function o(e){await p();const t=[e.geometryBuffer];return{result:b(e,t),transferList:t}}async function s(t){var r;await p();const n=[t.geometryBuffer],{geometryBuffer:o}=t,s=o.byteLength,f=l._malloc(s),i=new Uint8Array(l.HEAPU8.buffer,f,s);i.set(new Uint8Array(o));const a=l.dracoDecompressPointCloudData(f,i.byteLength);if(l._free(f),a.error.length>0)throw`i3s.wasm: ${a.error}`;const u=(null==(r=a.featureIds)?void 0:r.length)>0?e(a.featureIds):null,c=e(a.positions);u&&n.push(u.buffer),n.push(c.buffer);return{result:{positions:c,featureIds:u},transferList:n}}async function f(e){await p(),d(e);const t={buffer:e.buffer};return{result:t,transferList:[t.buffer]}}async function i(e){await p(),y(e)}async function a(e){await p(),l.setLegacySchema(e.context,e.jsonSchema)}function u(e){E(e)}let c,l;function y(e){const t=e.modifications,r=l._malloc(8*t.length),n=new Float64Array(l.HEAPU8.buffer,r,t.length);for(let e=0;e<t.length;++e)n[e]=t[e];l.setModifications(e.context,r,t.length,e.isGeodetic),l._free(r)}function b(r,n){if(!l)return null;const{context:o,localOrigin:s,globalTrafo:f,mbs:i,obb:a,elevationOffset:u,geometryBuffer:c,geometryDescriptor:y,indexToVertexProjector:b,vertexToRenderProjector:m}=r,d=l._malloc(c.byteLength),E=l._malloc(33*Float64Array.BYTES_PER_ELEMENT),p=new Uint8Array(l.HEAPU8.buffer,d,c.byteLength);p.set(new Uint8Array(c));const g=new Float64Array(l.HEAPU8.buffer,E,33);h(g,s);let w=g.byteOffset+3*g.BYTES_PER_ELEMENT,A=new Float64Array(g.buffer,w);h(A,f),w+=16*g.BYTES_PER_ELEMENT,A=new Float64Array(g.buffer,w),h(A,i),w+=4*g.BYTES_PER_ELEMENT,t(a)&&(A=new Float64Array(g.buffer,w),h(A,a.center),w+=3*g.BYTES_PER_ELEMENT,A=new Float64Array(g.buffer,w),h(A,a.halfSize),w+=3*g.BYTES_PER_ELEMENT,A=new Float64Array(g.buffer,w),h(A,a.quaternion));const _=y,L={isDraco:!1,isLegacy:!1,color:r.layouts.some((e=>e.some((e=>\"color\"===e.name)))),normal:r.needNormals&&r.layouts.some((e=>e.some((e=>\"normalCompressed\"===e.name)))),uv0:r.layouts.some((e=>e.some((e=>\"uv0\"===e.name)))),uvRegion:r.layouts.some((e=>e.some((e=>\"uvRegion\"===e.name)))),featureIndex:_.featureIndex},T=l.process(o,!!r.obb,d,p.byteLength,_,L,E,u,b,m,r.normalReferenceFrame);if(l._free(E),l._free(d),T.error.length>0)throw`i3s.wasm: ${T.error}`;if(T.discarded)return null;const I=T.componentOffsets.length>0?e(T.componentOffsets):null,P=T.featureIds.length>0?e(T.featureIds):null,U=e(T.interleavedVertedData).buffer,B=1===T.indicesType?e(new Uint16Array(T.indices.buffer,T.indices.byteOffset,T.indices.byteLength/2)):e(new Uint32Array(T.indices.buffer,T.indices.byteOffset,T.indices.byteLength/4)),F=e(T.positions),x=1===T.positionIndicesType?e(new Uint16Array(T.positionIndices.buffer,T.positionIndices.byteOffset,T.positionIndices.byteLength/2)):e(new Uint32Array(T.positionIndices.buffer,T.positionIndices.byteOffset,T.positionIndices.byteLength/4)),O={layout:r.layouts[0],interleavedVertexData:U,indices:B,hasColors:T.hasColors,hasModifications:T.hasModifications,positionData:{data:F,indices:x}};return P&&n.push(P.buffer),I&&n.push(I.buffer),n.push(U),n.push(B.buffer),n.push(F.buffer),n.push(x.buffer),{componentOffsets:I,featureIds:P,transformedGeometry:O,obb:T.obb}}function m(e){return 0===e?0:1===e?1:2===e?2:3}function d(e){const{context:t,buffer:r}=e,n=l._malloc(r.byteLength),o=r.byteLength/Float64Array.BYTES_PER_ELEMENT,s=new Float64Array(l.HEAPU8.buffer,n,o),f=new Float64Array(r);s.set(f),l.filterOBBs(t,n,o),f.set(s),l._free(n)}function E(e){l&&l.destroy(e)}function h(e,t){for(let r=0;r<t.length;++r)e[r]=t[r]}function p(){return l?r():(c||(c=n().then((e=>{l=e,c=null}))),c)}const g={transform:b,destroy:E};export{u as destroyContext,s as dracoDecompressPointCloudData,f as filterObbsForModifications,d as filterObbsForModificationsSync,p as initialize,m as interpretObbModificationResults,o as process,a as setLegacySchema,i as setModifications,y as setModificationsSync,g as test};\n"],"sourceRoot":""}