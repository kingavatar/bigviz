(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-39a8d800"],{"05c8":function(t,e,i){"use strict";i.d(e,"a",(function(){return x}));var r=i("e92d"),s=i("ce50"),n=i("f4cc"),o=i("82fa"),a=i("36b8"),c=i("c24e"),l=i("89cb"),h=i("671a"),u=i("a305");const f=r["a"].getLogger("esri/views/2d/engine/webgl/util/Matcher");class d{constructor(){this.type="feature",this._defaultResult=null}static async fromBasicRenderer(t,e,i){const r=new d;if(t.symbol){const s=await Object(h["a"])(t.symbol,i),n=e.createTemplateGroup(s,null);r.setDefault(n)}return r}size(){return 1}getDefault(){return this._defaultResult}setDefault(t){this._defaultResult=t}match(t,e,i,r,s){return this.getDefault()}async analyze(t,e,i,r,s){return null}}class p extends d{constructor(t,e,i,r){super(),this.type="interval",this._intervals=[],this._isMaxInclusive=e,this._fieldIndex=r,this._field=t,this._normalizationInfo=i}static async fromCBRenderer(t,e,i){const{isMaxInclusive:r,normalizationField:s,normalizationTotal:o,normalizationType:a}=t,c=t.field,l=new p(c,r,{normalizationField:s,normalizationTotal:o,normalizationType:a},t.fieldIndex),u=await Object(h["a"])(t.backgroundFillSymbol,i);await Object(n["b"])(t.intervals.map(async t=>{const r=await Object(h["a"])(t.symbol,i),s=await e.createTemplateGroup(r,u),n={min:t.min,max:t.max};l.add(n,s)}));const f=await Object(h["a"])(t.defaultSymbol,i);if(f){const t=await e.createTemplateGroup(f,u);l.setDefault(t)}return l}add(t,e){this._intervals.push({interval:t,result:e}),this._intervals.sort((t,e)=>t.interval.min-e.interval.min)}size(){return super.size()+this._intervals.length}match(t,e,i,r,s){if(null==this._fieldIndex&&!this._field)return this.getDefault();const n=null!=this._fieldIndex?e.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(e);if(!n&&(null==n||isNaN(n)))return this.getDefault();for(let o=0;o<this._intervals.length;o++){const{interval:t,result:e}=this._intervals[o],i=n>=t.min,r=this._isMaxInclusive?n<=t.max:n<t.max;if(i&&r)return e}return this.getDefault()}_needsNormalization(){const t=this._normalizationInfo;return t&&(t.normalizationField||t.normalizationTotal||t.normalizationType)}_getValueFromField(t){const e=t.readAttribute(this._field);if(!this._needsNormalization())return e;const{normalizationField:i,normalizationTotal:r,normalizationType:s}=this._normalizationInfo,n=!!i&&t.readAttribute(i);if(s)switch(s){case"esriNormalizeByField":return n?e/n:void 0;case"esriNormalizeByLog":return Math.log(e)*Math.LOG10E;case"esriNormalizeByPercentOfTotal":return e/r*100;default:return void f.error("Found unknown normalization type: "+s)}else f.error("Normalization is required, but no type was set!")}}class m extends d{constructor(t,e,i){super(),this.type="map",this._nullResult=null,this._resultsMap=new Map,this._fieldsIndex=i,this._fields=t,this._seperator=e||""}static async fromUVRenderer(t,e,i){const r=t.fieldDelimiter,s=[t.field];t.field2&&s.push(t.field2),t.field3&&s.push(t.field3);const o=await Object(h["a"])(t.backgroundFillSymbol,i),a=new m(s,r,t.fieldIndex);await Object(n["b"])(t.map.map(async t=>{const r=await Object(h["a"])(t.symbol,i),s=await e.createTemplateGroup(r,o);"<Null>"===t.value?a.setNullResult(s):a.add(t.value,s)}));const c=await Object(h["a"])(t.defaultSymbol,i);if(c){const t=await e.createTemplateGroup(c,o);a.setDefault(t)}return a}setNullResult(t){this._nullResult=t}add(t,e){this._resultsMap.set(t.toString(),e)}size(){return super.size()+this._resultsMap.size}match(t,e,i,r,s){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();const n=null!=this._fieldsIndex?e.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(e);if(null!==this._nullResult&&(null==n||""===n||"<Null>"===n))return this._nullResult;if(!n&&null==n)return this.getDefault();const o=n.toString();return this._resultsMap.has(o)?this._resultsMap.get(o):this.getDefault()}_getValueFromFields(t){const e=[];for(const i of this._fields){const r=t.readAttribute(i);e.push(r)}return e.join(this._seperator)}}class y extends d{constructor(t,e,i,r){super(),this.type="dictionary",this._groupIdCache=new c["a"](100),this._renderer=t,this._fieldMap=t.fieldMap,this._symbolFields=t.getSymbolFields(),this._templates=e,this._info=i,this._scaleFn=r}static async fromDictionaryRenderer(t,e,r){const s=(await Promise.resolve().then(i.bind(null,"261a"))).default.fromJSON(t.renderer);await s.fetchResources({spatialReference:r.spatialReference,fields:r.fields});const n=await async function(t,e){const i=t||1;if("number"==typeof i)return(t,e,r)=>i;const r=await Object(o["d"])(i,e.spatialReference,e.fields);return(t,i,s)=>Object(l["a"])(r,t,{$view:s},e.geometryType,i)||1}(s.scaleExpression,r);return new y(s,e,r,n)}async _analyzeFeature(t,e,i,r){const n=t.readLegacyFeature(),o=this._scaleFn(n,e,i),c=this._attributeHash(n)+"-"+o,l=this._groupIdCache.get(c);if(l)return l;const d={...i,spatialReference:this._info.spatialReference,abortOptions:r,fields:this._info.fields},p=await this._renderer.getSymbolAsync(n,d),m=Object(u["c"])(p,this._renderer),y=Object(h["a"])(m,this._info,r).then(t=>{if("expanded-cim"!==t.type)return f.error(new s["a"]("mapview-bad-type",`Found unexpected type ${t.type} in dictionary response`)),null;t.hash+="-"+o;for(const e of t.layers)e.scaleFactor=o,e.templateHash+="-"+o,"text"===e.type&&"string"==typeof e.text&&e.text.indexOf("[")>-1&&(e.text=Object(a["b"])(this._fieldMap,e.text,e.cim.textCase));return this._templates.createTemplateGroup(t,null)});return this._groupIdCache.put(c,y,1),y}async analyze(t,e,i,r,s){const o=e.getCursor(),a=[];for(;o.next();)a.push(this._analyzeFeature(o,i,r,s));return Object(n["b"])(a)}match(t,e,i,r,s){return null}_attributeHash(t){let e="";for(const i of this._symbolFields){const r=this._fieldMap[i];r&&(e+=t.attributes[r]+"-")}return e}}const b=r["a"].getLogger("esri/views/2d/engine/webgl/mesh/factories/matcherUtils");async function x(t,e,i){switch(t.type){case"simple":return d.fromBasicRenderer(t,e,i);case"map":return m.fromUVRenderer(t,e,i);case"interval":return p.fromCBRenderer(t,e,i);case"dictionary":return y.fromDictionaryRenderer(t,e,i);default:return b.error(new s["a"]("mapview-mesh:invalid-renderer","Unable to handle unknown renderer type")),null}}},"0ec3":function(t,e,i){"use strict";i.r(e);var r=i("a4ee"),s=i("c120"),n=i("b2b2"),o=i("e92d"),a=(i("cea0"),i("59b2"),i("d386")),c=(i("ce50"),i("e041"),i("8eed"),i("f402"),i("f4cc")),l=i("5996"),h=i("0f1c"),u=i("8c81"),f=i("b7b9"),d=i("05c8"),p=i("32b6"),m=i("0f0f"),y=i("2779"),b=i("d806");class x{constructor(t,e=2){this._bucketSize=t,this._rowsLength=u["F"]/t,this._colsLength=u["F"]/t,this._elementsPerBucket=e,this._grid=this._initGrid()}checkOverlap(t,e){const i=Math.floor(t/this._bucketSize),r=Math.floor(e/this._bucketSize);return i<0||i>=this._rowsLength||r<0||r>=this._colsLength||this._grid[r*this._colsLength+i]>=this._elementsPerBucket}markUsed(t,e){const i=Math.floor(t/this._bucketSize),r=Math.floor(e/this._bucketSize);this._grid[r*this._colsLength+i]+=1}reset(){this._grid=this._initGrid()}_initGrid(){return new Uint8Array(this._rowsLength*this._colsLength)}}var _=i("ba46");o["a"].getLogger("esri.views.2d.layers.features.processors.SymbolProcessor");let g=class extends _["a"]{constructor(){super(...arguments),this.type="symbol"}destroy(){}get supportsTileUpdates(){return!0}async update(t,e){const i=e.schema.processors[0];if("symbol"!==i.type)return;const r=Object(h["a"])(this._schema,i);Object(h["b"])(r,"mesh")&&(Object(s["a"])("esri-2d-update-debug")&&console.debug("Applying Update - Processor:",r),t.mesh=!0,t.why.mesh.push("Symbology changed"),this._schema=i,this._factory=this._createFactory(i),this._factory.update(i,this.tileStore.tileScheme.tileInfo))}onTileData(t,e,i){return Object(c["w"])(i),this._onTileData(t,e,i)}onTileError(t,e,i){const r=i.signal,s={tileKey:t.id,error:e};return this.remoteClient.invoke("tileRenderer.onTileError",s,{signal:r})}_createFactory(t){const{geometryType:e,objectIdField:i,fields:r}=this.service,s={geometryType:e,fields:r,spatialReference:l["a"].fromJSON(this.spatialReference)},n=new m["a"]((t,e)=>this.remoteClient.invoke("tileRenderer.getMaterialItems",t,e),!1);return this._store=n,this._matcher=Object(d["a"])(t.mesh.matcher,n,s),new y["a"](e,i,n)}async _onTileData(t,e,i){const{type:r,addOrUpdate:s,remove:o,end:a}=e;if(!s){const e={type:r,addOrUpdate:null,remove:o,clear:!1,end:a};return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:t.id,data:e},i)}const l=this._processFeatures(t,s,i),h=i.signal;try{const e=await l,i=Object(n["a"])(e,t=>t.message),s=Object(n["a"])(e,t=>t.transferList)||[],u={type:r,addOrUpdate:i,remove:o,clear:!1,end:a},f={transferList:Object(n["n"])(s)||[],signal:h};return Object(c["w"])(f),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:t.id,data:u},f)}catch(e){this._handleError(t,e,i)}}async _processFeatures(t,e,i){if(Object(n["g"])(e)||!e.hasFeatures)return null;const r={transform:t.transform,hasZ:!1,hasM:!1},s=this._factory,o={viewingMode:"",scale:t.scale},a=await this._matcher;Object(c["w"])(i);const l=this._getLabelInfos(t,e);return await s.analyze(e.getCursor(),a,r,o),Object(c["w"])(i),this._writeFeatureSet(t,e,r,l,s)}_writeFeatureSet(t,e,i,r,s){const o=s.createMeshData(e.getApproximateSize()),a={viewingMode:"",scale:t.scale},c=e.getCursor();for(;c.next();)try{const e=c.getDisplayId(),l=Object(n["h"])(r)?r.get(e):null;s.writeCursor(o,c,i,a,t.level,l)}catch(t){}return this._encodeDisplayData(o)}_encodeDisplayData(t){const e={},i=new Array;return t.encode(e,i),{message:e,transferList:i}}_handleError(t,e,i){if(!Object(c["n"])(e)){const r={tileKey:t.id,error:e.message};return this.remoteClient.invoke("tileRenderer.onTileError",r,{signal:i.signal})}}_shouldDiscard(t,e){switch(this.service.geometryType){case"esriGeometryPoint":{const i=e.readLegacyPointGeometry();return!i||t.checkOverlap(i.x,i.y)}case"esriGeometryPolygon":{const i=e.readLegacyCentroid();return!i||t.checkOverlap(i.x,i.y)}default:return!1}}_markUsed(t,e){switch(this.service.geometryType){case"esriGeometryPoint":{const{x:i,y:r}=e.readLegacyPointGeometry();return t.markUsed(i,r)}case"esriGeometryPolygon":{const{x:i,y:r}=e.readLegacyCentroid();return t.markUsed(i,r)}}}_getLabelInfos(t,e){const i=this._schema.mesh.labels,r=Object(n["a"])(i,e=>e.filter(e=>function(t,e){return(!t.minScale||t.minScale>=e)&&(!t.maxScale||t.maxScale<=e)}(e,t.scale)));if(Object(n["g"])(r)||0===r.length)return null;const s=new Map,o=new x(u["e"]),a=e.getCursor();for(;a.next();){const t=a.getDisplayId();if(this._shouldDiscard(o,a)){s.has(t)||s.set(t,null);continue}let e=!1;const i=[],n=Object(b["b"])(t),c=n&&1!==a.readAttribute("cluster_count")?"aggregate":"feature";for(const s of r){if(s.target!==c)continue;const r=a.getStorage(),o=n&&"feature"===c?r.getComputedStringAtIndex(a.readAttribute("referenceId"),s.fieldIndex):r.getComputedStringAtIndex(t,s.fieldIndex);if(!o)continue;const l=Object(f["a"])(o.toString()),h=l[0],u=l[1];this._store.getMosaicItem(s.symbol,Object(p["a"])(h)).then(t=>{i[s.index]={glyphs:t.glyphMosaicItems,rtl:u,index:s.index}}),e=!0}s.set(t,i),e&&this._markUsed(o,a)}return s}};g=Object(r["a"])([Object(a["a"])("esri.views.2d.layers.features.processors.SymbolProcessor")],g);var O=g;e["default"]=O},"0f0f":function(t,e,i){"use strict";i.d(e,"a",(function(){return Wt})),i.d(e,"b",(function(){return Ht}));var r=i("e92d"),s=i("ce50"),n=i("f4cc"),o=i("a6c1"),a=i("1aa6"),c=i("a305"),l=i("89e8"),h=i("a8b5"),u=i("38a4"),f=i("a915"),d=i("8c81"),p=i("d114"),m=i("18c6"),y=i("a9a2"),b=i("1d01"),x=i("6a2c"),_=i("6655"),g=i("c84e"),O=i("8152"),v=(i("fb2c"),i("2da5"));function M(t,e,i,r,s,n,o){Y=0;const a=(r-i)*n,c=s&&s.length,l=c?(s[0]-i)*n:a;let h,u,f,d,p,m=j(e,i,r,0,l,n,!0);if(m&&m.next!==m.prev){if(c&&(m=function(t,e,i,r,s,n){const o=new Array;for(let a=0,c=r.length;a<c;a++){const s=j(t,e,i,r[a]*n,a<c-1?r[a+1]*n:i*n,n,!1);s===s.next&&(s.steiner=!0),o.push(T(s))}o.sort(B);for(const a of o)P(a,s),s=w(s,s.next);return s}(e,i,r,s,m,n)),a>80*n){h=f=e[0+i*n],u=d=e[1+i*n];for(let t=n;t<l;t+=n){const r=e[t+i*n],s=e[t+1+i*n];h=Math.min(h,r),u=Math.min(u,s),f=Math.max(f,r),d=Math.max(d,s)}p=Math.max(f-h,d-u),p=0!==p?1/p:0}S(m,t,n,h,u,p,o,0)}}function j(t,e,i,r,s,n,o){let a;if(o===function(t,e,i,r,s,n){let o=0;for(let a=r,c=s-n;a<s;a+=n)o+=(t[c+e*n]-t[a+e*n])*(t[a+1+e*n]+t[c+1+e*n]),c=a;return o}(t,e,0,r,s,n)>0)for(let c=r;c<s;c+=n)a=L(c+e*n,t[c+e*n],t[c+1+e*n],a);else for(let c=s-n;c>=r;c-=n)a=L(c+e*n,t[c+e*n],t[c+1+e*n],a);return a&&N(a,a.next)&&(z(a),a=a.next),a}function w(t,e=t){if(!t)return t;let i,r=t;do{if(i=!1,r.steiner||!N(r,r.next)&&0!==R(r.prev,r,r.next))r=r.next;else{if(z(r),r=e=r.prev,r===r.next)break;i=!0}}while(i||r!==e);return e}function S(t,e,i,r,s,n,o,a){if(!t)return;!a&&n&&(t=k(t,r,s,n));let c=t;for(;t.prev!==t.next;){const l=t.prev,h=t.next;if(n?I(t,r,s,n):C(t))e.push(l.index/i+o),e.push(t.index/i+o),e.push(h.index/i+o),z(t),t=h.next,c=h.next;else if((t=h)===c){a?1===a?S(t=E(t,e,i,o),e,i,r,s,n,o,2):2===a&&Z(t,e,i,r,s,n,o):S(w(t),e,i,r,s,n,o,1);break}}}function C(t){const e=t.prev,i=t,r=t.next;if(R(e,i,r)>=0)return!1;let s=t.next.next;const n=s;let o=0;for(;s!==t.prev&&(0===o||s!==n);){if(o++,D(e.x,e.y,i.x,i.y,r.x,r.y,s.x,s.y)&&R(s.prev,s,s.next)>=0)return!1;s=s.next}return!0}function I(t,e,i,r){const s=t.prev,n=t,o=t.next;if(R(s,n,o)>=0)return!1;const a=s.x<n.x?s.x<o.x?s.x:o.x:n.x<o.x?n.x:o.x,c=s.y<n.y?s.y<o.y?s.y:o.y:n.y<o.y?n.y:o.y,l=s.x>n.x?s.x>o.x?s.x:o.x:n.x>o.x?n.x:o.x,h=s.y>n.y?s.y>o.y?s.y:o.y:n.y>o.y?n.y:o.y,u=A(a,c,e,i,r),f=A(l,h,e,i,r);let d=t.prevZ,p=t.nextZ;for(;d&&d.z>=u&&p&&p.z<=f;){if(d!==t.prev&&d!==t.next&&D(s.x,s.y,n.x,n.y,o.x,o.y,d.x,d.y)&&R(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,p!==t.prev&&p!==t.next&&D(s.x,s.y,n.x,n.y,o.x,o.y,p.x,p.y)&&R(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;d&&d.z>=u;){if(d!==t.prev&&d!==t.next&&D(s.x,s.y,n.x,n.y,o.x,o.y,d.x,d.y)&&R(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;p&&p.z<=f;){if(p!==t.prev&&p!==t.next&&D(s.x,s.y,n.x,n.y,o.x,o.y,p.x,p.y)&&R(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function L(t,e,i,r){const s=U.create(t,e,i);return r?(s.next=r.next,s.prev=r,r.next.prev=s,r.next=s):(s.prev=s,s.next=s),s}function z(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function T(t){let e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function P(t,e){if(e=function(t,e){let i=e;const r=t.x,s=t.y;let n,o=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){const t=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(t<=r&&t>o){if(o=t,t===r){if(s===i.y)return i;if(s===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===o)return n.prev;const a=n,c=n.x,l=n.y;let h,u=1/0;for(i=n.next;i!==a;)r>=i.x&&i.x>=c&&r!==i.x&&D(s<l?r:o,s,c,l,s<l?o:r,s,i.x,i.y)&&(h=Math.abs(s-i.y)/(r-i.x),(h<u||h===u&&i.x>n.x)&&F(i,t)&&(n=i,u=h)),i=i.next;return n}(t,e)){const i=G(e,t);w(i,i.next)}}function k(t,e,i,r){for(let s;s!==t;s=s.next){if(s=s||t,null===s.z&&(s.z=A(s.x,s.y,e,i,r)),s.prev.next!==s||s.next.prev!==s)return s.prev.next=s,s.next.prev=s,k(t,e,i,r);s.prevZ=s.prev,s.nextZ=s.next}return t.prevZ.nextZ=null,t.prevZ=null,function(t){let e,i=1;for(;;){let r,s=t;t=null,e=null;let n=0;for(;s;){n++,r=s;let o=0;for(;o<i&&r;o++)r=r.nextZ;let a=i;for(;o>0||a>0&&r;){let i;0===o?(i=r,r=r.nextZ,a--):0!==a&&r?s.z<=r.z?(i=s,s=s.nextZ,o--):(i=r,r=r.nextZ,a--):(i=s,s=s.nextZ,o--),e?e.nextZ=i:t=i,i.prevZ=e,e=i}s=r}if(e.nextZ=null,i*=2,n<2)return t}}(t)}function R(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function V(t,e,i,r){return!!(N(t,e)&&N(i,r)||N(t,r)&&N(i,e))||R(t,e,i)>0!=R(t,e,r)>0&&R(i,r,t)>0!=R(i,r,e)>0}function D(t,e,i,r,s,n,o,a){return(s-o)*(e-a)-(t-o)*(n-a)>=0&&(t-o)*(r-a)-(i-o)*(e-a)>=0&&(i-o)*(n-a)-(s-o)*(r-a)>=0}function F(t,e){return R(t.prev,t,t.next)<0?R(t,e,t.next)>=0&&R(t,t.prev,e)>=0:R(t,e,t.prev)<0||R(t,t.next,e)<0}function A(t,e,i,r,s){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*s)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*s)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function N(t,e){return t.x===e.x&&t.y===e.y}function B(t,e){return t.x-e.x}function E(t,e,i,r){let s=t;do{const n=s.prev,o=s.next.next;!N(n,o)&&V(n,s,s.next,o)&&F(n,o)&&F(o,n)&&(e.push(n.index/i+r),e.push(s.index/i+r),e.push(o.index/i+r),z(s),z(s.next),s=t=o),s=s.next}while(s!==t);return s}function Z(t,e,i,r,s,n,o){let a=t;do{let t=a.next.next;for(;t!==a.prev;){if(a.index!==t.index&&X(a,t)){let c=G(a,t);return a=w(a,a.next),c=w(c,c.next),S(a,e,i,r,s,n,o,0),void S(c,e,i,r,s,n,o,0)}t=t.next}a=a.next}while(a!==t)}function X(t,e){return t.next.index!==e.index&&t.prev.index!==e.index&&!function(t,e){let i=t;do{if(i.index!==t.index&&i.next.index!==t.index&&i.index!==e.index&&i.next.index!==e.index&&V(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&F(t,e)&&F(e,t)&&function(t,e){let i=t,r=!1;const s=(t.x+e.x)/2,n=(t.y+e.y)/2;do{i.y>n!=i.next.y>n&&i.next.y!==i.y&&s<(i.next.x-i.x)*(n-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==t);return r}(t,e)}function G(t,e){const i=U.create(t.index,t.x,t.y),r=U.create(e.index,e.x,e.y),s=t.next,n=e.prev;return t.next=e,e.prev=t,i.next=s,s.prev=i,r.next=i,i.prev=r,n.next=r,r.prev=n,r}class U{constructor(){this.index=0,this.x=0,this.y=0,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}static create(t,e,i){const r=K[Y++];return r.index=t,r.x=e,r.y=i,r.prev=null,r.next=null,r.z=null,r.prevZ=null,r.nextZ=null,r.steiner=!1,r}}const K=new Array;let Y=0;for(let Jt=0;Jt<8096;Jt++)K.push(new U);var H=i("e8d0");const W=new H["a"],J=new v["b"](0,0,0,1,128);function q(t,e,i){let r=0;for(let s=1;s<i;s++){const i=t[2*(e+s-1)],n=t[2*(e+s-1)+1];r+=(t[2*(e+s)]-i)*(t[2*(e+s)+1]+n)}return r}function $(t,e,i,r,s){let n=0;for(let o=i;o<r;o+=3){const i=2*(t.getValue(o)-s),r=2*(t.getValue(o+1)-s),a=2*(t.getValue(o+2)-s);n+=Math.abs((e[i]-e[a])*(e[r+1]-e[i+1])-(e[i]-e[r])*(e[a+1]-e[i+1]))}return n}function Q(t,e,i){const{coords:r,lengths:s,hasIndeterminateRingOrder:n}=e;if(n)return!1;const o=t.length;let a=0;for(let c=0;c<s.length;){let e=c,n=s[c],l=q(r,a,n);const h=[];for(;++e<s.length;){const t=s[e],i=q(r,a+n,t);if(!(i>0))break;l+=i,h.push(a+n),n+=t}const u=t.length;M(t,r,a,a+n,h,2,i);const f=$(t,r,u,t.length,i),d=Math.abs(l);if(Math.abs((f-d)/Math.max(1e-7,d))>1e-5)return t.seek(o),!1;c=e,a+=n}return!0}function tt(t,e,i,r){const s=[],{coords:n,lengths:o}=i;W.beginPolygon(t,s);let a=0;for(let c=0;c<o.length;c++){const t=i.lengths[c];W.beginContour();for(let e=0;e<t;e++){const t=[n[2*(a+e)],n[2*(a+e)+1],0];W.addVertex(t,t)}W.endContour(),a+=t}W.endPolygon();for(let c=0;c<s.length;c++)e.push(s[c]+r)}function et(t){if(!function(t,e,i){let r=0;for(let s=0;s<t.lengths.length;s++){const n=t.lengths[s];for(let s=0;s<n;s++){const n=t.coords[2*(s+r)],o=t.coords[2*(s+r)+1];if(n<e||n>i||o<e||o>i)return!0}r+=n}return!1}(t,-128,d["F"]+128))return t;J.reset(3);let e=0;for(let n=0;n<t.lengths.length;n++){const i=t.lengths[n];let r=t.coords[2*(0+e)],s=t.coords[2*(0+e)+1];J.moveTo(r,s);for(let n=1;n<i;n++)r=t.coords[2*(n+e)],s=t.coords[2*(n+e)+1],J.lineTo(r,s);J.close(),e+=i}const i=J.result(!1);if(!i)return null;const r=[],s=[];for(const n of i){let t=0;for(const e of n)s.push(e.x),s.push(e.y),t++;r.push(t)}return new O["a"](r,s)}J.setExtent(d["F"]);var it=t=>class extends t{constructor(...t){super(...t),this.forceLibtess=!1,this.geometryType=g["d"].FILL}writeMeshWithGeometry(t,e,i,r,s,n){const o=m["a"].load(this._materialKey),a=e.indexVector,c=e.getVector("geometry"),l=c.vertexCount,h=a.length;let u=n?Object(_["p"])(Object(_["d"])(n),2):i.readUnquantizedGeometry();if(!u)return;if(u=et(u),!u)return;let f=u.coords;!this.forceLibtess&&Q(a,u,l)||(f=[],tt(f,a,u,l)),this._write(c,i,s,f,o);const d=c.vertexCount-l,p=a.length-h;t.writeDisplayRecord(this.geometryType,this._materialKey,l,d,h,p)}_write(t,e,i,r,s){for(let n=0;n<r.length;n+=2){const o=Object(p["a"])(1*r[n],1*r[n+1]);t.data.push(o),t.data.push(i),s.dotDensity?t.data.writeF32(1/Math.abs(e.readGeometryArea())):(t.data.push(this.fillColor),t.data.push(this.tl),t.data.push(this.br),t.data.push(this.aux1),t.data.push(this.aux2),t.data.push(this.aux3))}}},rt=i("4fcb"),st=i("f75e");const nt=r["a"].getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");var ot=class extends st["a"]{constructor(t){super(),this._ongoingMaterialRequestMap=new Map,this._materialCache=new Map,this._dynamicPropertyMap=new Map,this._cimLayer=t}analyze(t,e,i,r){const s=e.readLegacyFeature(),o=this._materialCache,a=this._cimLayer.materialHash;if(!a)return nt.error("A Dynamic mesh template must have a material hash value or function!"),Object(n["t"])(null);const c="function"==typeof a?a(s,i,r):a;if(o.has(c)){const t=o.get(c);return Object(n["u"])(t)}if(this._ongoingMaterialRequestMap.has(c))return this._ongoingMaterialRequestMap.get(c);const l=Object(rt["a"])(this._cimLayer.cim,this._cimLayer.materialOverrides);l.mosaicHash=c;const h=t.getMosaicItem(l).then(t=>(this._ongoingMaterialRequestMap.delete(c),o.set(c,t),t)).catch(t=>(this._ongoingMaterialRequestMap.delete(c),nt.error(".analyze()",t.message),null));return this._ongoingMaterialRequestMap.set(c,h),h}};class at extends(it(ot)){constructor(t){if(super(t),Object(x["c"])(t.color)){const e=(e,i,r)=>{const s=t.color(e,i,r);return s&&Object(y["c"])(s)||0};this._dynamicPropertyMap.set("_fillColor",e)}else{const e=t.color;this.fillColor=e&&Object(y["c"])(e)||0}let e=0;Object(x["c"])(t.height)||(e=t.height||0),this._dynamicPropertyMap.set("_height",(i,r,s)=>Object(x["c"])(t.height)?t.height(i,r,s):e);let i=0;Object(x["c"])(t.offsetX)||(i=Object(f["d"])(t.offsetX||0)+128,i>255&&(i=255)),this._dynamicPropertyMap.set("_offsetX",(e,r,s)=>{if(Object(x["c"])(t.offsetX)){let i=Object(f["d"])(t.offsetX(e,r,s))+128;return i>255&&(i=255),i}return i});let r=1;Object(x["c"])(t.scaleX)||(r=t.scaleX||1),this._dynamicPropertyMap.set("_scaleX",(e,i,s)=>Object(x["c"])(t.scaleX)?t.scaleX(e,i,s):r);let s=0;Object(x["c"])(t.offsetY)||(s=Object(f["d"])(-t.offsetY||0)+128,s>255&&(s=255)),this._dynamicPropertyMap.set("_offsetY",(e,i,r)=>{if(Object(x["c"])(t.offsetY)){let s=Object(f["d"])(-t.offsetY(e,i,r))+128;return s>255&&(s=255),s}return s});let n=0;Object(x["c"])(t.angle)||(n=Object(b["d"])(t.angle)||0),this._dynamicPropertyMap.set("_angle",(e,i,r)=>Object(x["c"])(t.angle)?Object(b["d"])(t.angle(e,i,r)):n),this.effects=t.effects,this._cimFillLayer=t,this._fillMaterialKey=m["a"].load(t.materialKey)}static fromCIMFill(t){return new at(t)}bindFeature(t,e,i){const r=t.readLegacyFeature();this._dynamicPropertyMap.forEach((t,s)=>{this[s]=t(r,e,i)});const s=this._fillMaterialKey,n=this._materialCache,o=this._cimFillLayer;this.aux3=Object(p["b"])(0,0,this._angle,o.colorLocked?1:0);const c=(0,o.materialHash)(r,e,i),l=n.get(c);let h=null;if(l&&Object(a["a"])(l.spriteMosaicItem)&&(h=l.spriteMosaicItem),h){const{rect:t,width:e,height:i}=h,r=t.x+d["r"],n=t.y+d["r"],o=r+e,a=n+i;let c=Object(u["i"])(Object(f["d"])(this._height));c>255?c=255:c<=0&&(c=Object(u["i"])(a-n));let l=Object(u["i"])(Object(f["d"])(this._height/i*e||0));l>255?l=255:l<=0&&(l=Object(u["i"])(o-r));const m=this._scaleX,y=1;this.tl=Object(p["a"])(r,n),this.br=Object(p["a"])(o,a),this.aux1=Object(p["b"])(l,c,this._offsetX,this._offsetY),this.aux2=Object(p["a"])(128*m,128*y),s.sdf=h.sdf,s.pattern=!0,s.textureBinding=h.textureBinding}else this.tl=0,this.br=0,this.aux1=0,this.aux2=0,s.sdf=!1,s.pattern=!1,s.textureBinding=0;this._materialKey=s.data}}var ct=at,lt=(i("c120"),i("2629"));const ht=d["F"]+16,ut=new v["b"](0,0,0,1,16);ut.setExtent(d["F"]);const ft=new Uint32Array(9),dt=new Uint32Array(36),pt=new Uint32Array(3),mt=new Uint32Array(6),yt=t=>e=>{const i=Math.ceil(1024*t._halfWidth),r=Math.ceil(1024*t._halfReferenceWidth);e.entry0=t.offset+t.vertexCount++;{const s=Object(p["a"])(e.distance,i),n=Object(p["b"])(Math.round(31*e.prevNormal.x),Math.round(31*e.prevNormal.y),Math.round(0),Math.round(-31)),o=Object(p["b"])(0,0,0,t._bitset);dt[0]=Object(p["a"])(8*e.currentVertex.x,8*e.currentVertex.y),dt[1]=t.id,dt[2]=t._fillColor,dt[3]=n,dt[4]=s,dt[5]=t._tl,dt[6]=t._br,dt[7]=o,dt[8]=Object(p["a"])(r,0)}e.entry2=t.offset+t.vertexCount++;{const s=Object(p["a"])(e.distance,i),n=Object(p["b"])(Math.round(31*-e.prevNormal.x),Math.round(31*-e.prevNormal.y),Math.round(0),Math.round(31)),o=Object(p["b"])(0,0,0,t._bitset);dt[9]=Object(p["a"])(8*e.currentVertex.x,8*e.currentVertex.y),dt[10]=t.id,dt[11]=t._fillColor,dt[12]=n,dt[13]=s,dt[14]=t._tl,dt[15]=t._br,dt[16]=o,dt[17]=Object(p["a"])(r,0)}e.exit0=t.offset+t.vertexCount++;{const s=Object(p["a"])(e.distance,i),n=Object(p["b"])(Math.round(31*e.nextNormal.x),Math.round(31*e.nextNormal.y),Math.round(0),Math.round(-31)),o=Object(p["b"])(0,0,0,t._bitset);dt[18]=Object(p["a"])(8*e.currentVertex.x,8*e.currentVertex.y),dt[19]=t.id,dt[20]=t._fillColor,dt[21]=n,dt[22]=s,dt[23]=t._tl,dt[24]=t._br,dt[25]=o,dt[26]=Object(p["a"])(r,0)}e.exit2=t.offset+t.vertexCount++;{const s=Object(p["a"])(e.distance,i),n=Object(p["b"])(Math.round(31*-e.nextNormal.x),Math.round(31*-e.nextNormal.y),Math.round(0),Math.round(31)),o=Object(p["b"])(0,0,0,t._bitset);dt[27]=Object(p["a"])(8*e.currentVertex.x,8*e.currentVertex.y),dt[28]=t.id,dt[29]=t._fillColor,dt[30]=n,dt[31]=s,dt[32]=t._tl,dt[33]=t._br,dt[34]=o,dt[35]=Object(p["a"])(r,0)}t.geometryBuf.writeRegion(dt)},bt=t=>e=>{mt[0]=e.leftExit0,mt[1]=e.rightEntry0,mt[2]=e.leftExit2,mt[3]=e.rightEntry0,mt[4]=e.rightEntry2,mt[5]=e.leftExit2,t.indexCount+=6,t.indexBuf.writeRegion(mt)},xt=t=>(e,i,r,s,n,o,a,c,l)=>{const h=Object(p["a"])(l,Math.ceil(1024*t._halfWidth)),u=Object(p["b"])(Math.round(31*n),Math.round(31*o),Math.round(31*a),Math.round(31*c)),f=Object(p["b"])(31*r,31*s,0,t._bitset);return ft[0]=Object(p["a"])(8*e,8*i),ft[1]=t.id,ft[2]=t._fillColor,ft[3]=u,ft[4]=h,ft[5]=t._tl,ft[6]=t._br,ft[7]=f,ft[8]=Object(p["a"])(Math.ceil(1024*t._halfReferenceWidth),0),t.geometryBuf.writeRegion(ft),t.offset+t.vertexCount++},_t=t=>(e,i,r)=>{pt[0]=e,pt[1]=i,pt[2]=r,t.indexCount+=3,t.indexBuf.writeRegion(pt)};var gt=t=>class extends t{constructor(...t){super(...t),this.tessellationProperties={_fillColor:null,_tl:null,_br:null,_halfWidth:null,_bitset:null,_halfReferenceWidth:null,id:null,indexBuf:null,indexCount:null,geometryBuf:null,vertexCount:null,offset:null},this._tessellationOptions={},this.geometryType=g["d"].LINE}writeMeshWithGeometry(t,e,i,r,s,n){const o=e.indexVector,a=e.get("geometry"),c=e.getVector("geometry").vertexCount,l=o.length,h=null!=n?n:i.readLegacyGeometry();if(!h)return;switch(r){case"esriGeometryPolyline":{const t=this._clipLines(h.paths);if(0===t.length)return;this._write(o,a,c,s,t);break}case"esriGeometryPolygon":{const t=this._clipLines(h.rings);if(0===t.length)return;this._write(o,a,c,s,t);break}}const u=this.tessellationProperties.vertexCount,f=this.tessellationProperties.indexCount;t.writeDisplayRecord(this.geometryType,this._materialKey,c,u,l,f)}_clipLines(t){const e=[];let i=!1,r=0;for(;r<t.length;){const s=[],n=t[r];ut.reset(2);let[o,a]=n[0];if(i)ut.moveTo(o,a);else{if(o<-16||o>ht||a<-16||a>ht){i=!0;continue}s.push({x:o,y:a})}let c=!1;const l=n.length;for(let t=1;t<l;++t)if(o+=n[t][0],a+=n[t][1],i)ut.lineTo(o,a);else{if(o<-16||o>ht||a<-16||a>ht){c=!0;break}s.push({x:o,y:a})}if(c)i=!0;else{if(i){const t=ut.resultWithStarts();if(t)for(const i of t)e.push(i)}else e.push({line:s,start:0});r++,i=!1}}return e}_write(t,e,i,r,s){this.tessellationProperties.id=r,this.tessellationProperties.indexBuf=t,this.tessellationProperties.indexCount=0,this.tessellationProperties.geometryBuf=e,this.tessellationProperties.vertexCount=0,this.tessellationProperties.offset=i;for(const n of s){const t=n.line;t.length<2||(this._tessellationOptions.initialDistance=n.start%65535,this._tessellationCallbacks instanceof lt["a"]&&(this._tessellationCallbacks.capType=this._capType,this._tessellationCallbacks.joinType=this._joinType),Object(lt["d"])(t,this._tessellationOptions,this._tessellationCallbacks),Object(lt["b"])())}}_initializeTessellator(t){const e=m["c"].load(this._materialKey);if(this._tessellationOptions.trackDistance=this._isDashed||this._hasPattern,this._tessellationOptions.thin=!t&&this.tessellationProperties._halfWidth<d["E"]/2&&!(e.vvSizeFieldStops||e.vvSizeMinMaxValue||e.vvSizeScaleStops||e.vvSizeUnitValue),this._tessellationOptions.wrapDistance=65535,this._tessellationOptions.outerBisectorAutoSplitThreshold=.2631578947368421,this._tessellationOptions.enableOuterBisectorSplit=this._isDashed||this._hasPattern,this._tessellationOptions.innerBisectorAutoSplitThreshold=.2631578947368421,this._tessellationOptions.enableInnerBisectorSplit=this._isDashed||this._hasPattern,this._tessellationOptions.thin)this._tessellationCallbacks={vertex:yt(this.tessellationProperties),bridge:bt(this.tessellationProperties)};else{const t=new lt["a"](xt(this.tessellationProperties),_t(this.tessellationProperties));t.miterLimitCosine=this._miterLimitCosine,t.textured=this._isDashed||this._hasPattern,t.joinOnUTurn=this._joinOnUTurn,this._tessellationCallbacks=t}}};class Ot extends(gt(ot)){constructor(t){super(t),this._cimLineLayer=t;let e=0;if(Object(x["c"])(t.width)||(e=.5*Object(f["d"])(t.width)),this._dynamicPropertyMap.set("_halfWidth",(i,r,s)=>Object(x["c"])(t.width)?.5*Object(f["d"])(t.width(i,r,s)):e),Object(x["c"])(t.cap)?this._dynamicPropertyMap.set("_capType",t.cap):this._capType=t.cap,Object(x["c"])(t.join)?this._dynamicPropertyMap.set("_joinType",t.join):this._joinType=t.join,Object(x["c"])(t.color)){const e=(e,i,r)=>{const s=t.color(e,i,r);return s&&Object(y["c"])(s)||0};this._dynamicPropertyMap.set("_fillColor",e)}else{const e=t.color;this._fillColor=e&&Object(y["c"])(e)||0}if(Object(x["c"])(t.miterLimit)){const e=(e,i,r)=>Object(x["b"])(t.miterLimit(e,i,r));this._dynamicPropertyMap.set("_miterLimitCosine",e)}else this._miterLimitCosine=Object(x["b"])(t.miterLimit);this._scaleFactor=t.scaleFactor||1,this._isDashed=t.isDashed,this.effects=t.effects,this.tessellationProperties._bitset=t.colorLocked?1:0,this._materialKey=t.materialKey,this._initializeTessellator(!0)}static fromCIMLine(t){return new Ot(t)}bindFeature(t,e,i){const r=t.readLegacyFeature();this._dynamicPropertyMap.forEach((t,s)=>{this[s]=t(r,e,i)}),this._halfWidth*=this._scaleFactor;const s=this._materialCache,n=(0,this._cimLineLayer.materialHash)(r,e,i),o=s.get(n);let c=null;if(o&&Object(a["a"])(o.spriteMosaicItem)&&(c=o.spriteMosaicItem),c){this._hasPattern=!0;const{rect:t,width:e,height:i}=c,r=t.x+d["r"],s=t.y+d["r"],n=r+e,o=s+i;this.tessellationProperties._tl=Object(p["a"])(r,s),this.tessellationProperties._br=Object(p["a"])(n,o)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor,this.tessellationProperties._halfWidth=this._halfWidth,this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;const l=m["c"].load(this._materialKey);c&&(l.sdf=c.sdf,l.pattern=!0,l.textureBinding=c.textureBinding),this._materialKey=l.data}}var vt=Ot,Mt=i("b2b2"),jt=i("2c63"),wt=i("738e"),St=i("f93c");const Ct=Object(wt["a"])(),It=Object(jt["a"])(),Lt=r["a"].getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");class zt extends(Object(St["a"])(ot)){constructor(t){if(super(t),this._cimMarkerLayer=t,Object(x["c"])(t.color)){const e=(e,i,r)=>Object(y["c"])(t.color(e,i,r));this._dynamicPropertyMap.set("_fillColor",e)}else this._fillColor=Object(y["c"])(t.color);if(Object(x["c"])(t.outlineColor)){const e=(e,i,r)=>Object(y["c"])(t.outlineColor(e,i,r));this._dynamicPropertyMap.set("_outlineColor",e)}else this._outlineColor=Object(y["c"])(t.outlineColor);if(Object(x["c"])(t.size)){const e=(e,i,r)=>Object(f["d"])(t.size(e,i,r));this._dynamicPropertyMap.set("_size",e)}else this._size=Object(f["d"])(t.size);if(Object(x["c"])(t.scaleX)?this._dynamicPropertyMap.set("_scaleX",t.scaleX):this._scaleX=t.scaleX,Object(x["c"])(t.offsetX)){const e=(e,i,r)=>Object(f["d"])(t.offsetX(e,i,r));this._dynamicPropertyMap.set("xOffset",e)}else this.xOffset=Object(f["d"])(t.offsetX);if(Object(x["c"])(t.offsetY)){const e=(e,i,r)=>Object(f["d"])(t.offsetY(e,i,r));this._dynamicPropertyMap.set("yOffset",e)}else this.yOffset=Object(f["d"])(t.offsetY);if(Object(x["c"])(t.outlineWidth)){const e=(e,i,r)=>Object(f["d"])(t.outlineWidth(e,i,r));this._dynamicPropertyMap.set("_outlineWidth",e)}else this._outlineWidth=Object(f["d"])(t.outlineWidth);Object(x["c"])(t.rotation)?this._dynamicPropertyMap.set("_angle",t.rotation):this._angle=t.rotation,this._scaleFactor=Object(Mt["o"])(t.scaleFactor,1),this._markerPlacement=t.markerPlacement,this.effects=t.effects,this._bitSet=(1===t.alignment?1:0)|(t.colorLocked?1:0)<<1|(t.scaleSymbolsProportionally?1:0)<<3,this._materialKey=t.materialKey}static fromCIMMarker(t){return new zt(t)}bindFeature(t,e,i){const r=t.readLegacyFeature();this._dynamicPropertyMap.forEach((t,s)=>{this[s]=t(r,e,i)});const n=this._cimMarkerLayer.materialHash,o="function"==typeof n?n(r,e,i):n,c=this._materialCache.get(o);if(!c||!Object(a["a"])(c.spriteMosaicItem)||!c.spriteMosaicItem)return void Lt.error(new s["a"]("mapview-cim","Encountered an error when binding feature"));const l=c.spriteMosaicItem,h=this._cimMarkerLayer.sizeRatio,u=l.width/l.height*this._scaleX,y=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle;let b=this._size,x=b*u;const _=this.xOffset,g=this.yOffset;this.xOffset*=this._scaleFactor,this.yOffset*=this._scaleFactor;const O=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/Object(f["d"])(this._cimMarkerLayer.frameHeight):1,v=this._outlineWidth*O,M=Object(f["d"])(this._cimMarkerLayer.referenceSize);let j=0,w=0;const S=this._cimMarkerLayer.anchorPoint;S&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(j=-S.x/(this._size*u),w=S.y/this._size):(j=S.x,w=S.y)),this._sizeOutlineWidth=Object(p["b"])(Math.round(Math.min(Math.sqrt(128*x),255)),Math.round(Math.min(Math.sqrt(128*b),255)),Math.round(Math.min(Math.sqrt(128*v),255)),Math.round(Math.min(Math.sqrt(128*M),255))),this.angle=y;const C=Math.round(Math.min(64*h,255));this._bitestAndDistRatio=Object(p["b"])(0,0,this._bitSet,C);const I=l.rect.x+d["r"],L=l.rect.y+d["r"],z=I+l.width,T=L+l.height;this._texUpperLeft=Object(p["a"])(I,L),this._texUpperRight=Object(p["a"])(z,L),this._texBottomLeft=Object(p["a"])(I,T),this._texBottomRight=Object(p["a"])(z,T);const P=m["d"].load(this._materialKey);P.sdf=l.sdf,P.pattern=!0,P.textureBinding=l.textureBinding,this._materialKey=P.data,this._anchorX=.5-(.5+j)*l.width/l.width,this._anchorY=.5-(.5+w)*l.height/l.height,x*=h,b*=h,x*=this._scaleFactor,b*=this._scaleFactor,x*=l.rect.width/l.width,b*=l.rect.height/l.height,this._computedWidth=x,this._computedHeight=b,this._applyTransformation(It,Ct),this.xOffset=_,this.yOffset=g}}var Tt=zt,Pt=i("32b6"),kt=i("32dd"),Rt=i("44d1");class Vt extends(Object(Rt["a"])(ot)){constructor(t){super(t),this._horizontalAlignment="center",this._verticalAlignment="middle",this._textToGlyphs=new Map;const e=t.scaleFactor||1;if(this._cimTextLayer=t,Object(x["c"])(t.color)){const e=(e,i,r)=>Object(y["c"])(t.color(e,i,r));this._dynamicPropertyMap.set("_color",e)}else this._color=Object(y["c"])(t.color);if(Object(x["c"])(t.color)){const e=(e,i,r)=>Object(y["c"])(t.outlineColor(e,i,r));this._dynamicPropertyMap.set("_haloColor",e)}else this._haloColor=Object(y["c"])(t.outlineColor);let i,r,s;if(Object(x["c"])(t.size)||(i=Math.min(Math.round(Object(f["d"])(t.size*t.sizeRatio)),127)),this._dynamicPropertyMap.set("_size",(e,r,s)=>Object(x["c"])(t.size)?Math.min(Math.round(Object(f["d"])(t.size(e,r,s)*t.sizeRatio)),127):i),Object(x["c"])(t.outlineSize)){const e=(e,i,r)=>Math.min(Math.floor(5*Object(f["d"])(t.outlineSize(e,i,r)*t.sizeRatio)),127);this._dynamicPropertyMap.set("_haloSize",e)}else this._haloSize=Math.min(Math.floor(5*Object(f["d"])(t.outlineSize*t.sizeRatio)),127);Object(x["c"])(t.offsetX)||(r=Math.round(Object(f["d"])(t.offsetX*t.sizeRatio))),this._dynamicPropertyMap.set("_xOffset",(e,i,s)=>Object(x["c"])(t.offsetX)?Math.round(Object(f["d"])(t.offsetX(e,i,s)*t.sizeRatio)):r),Object(x["c"])(t.offsetY)||(s=Math.round(Object(f["d"])(t.offsetY*t.sizeRatio))),this._dynamicPropertyMap.set("_yOffset",(e,i,r)=>Object(x["c"])(t.offsetY)?Math.round(Object(f["d"])(t.offsetY(e,i,r)*t.sizeRatio)):s),Object(x["c"])(t.angle)?this._dynamicPropertyMap.set("_angle",t.angle):this._angle=t.angle,Object(x["c"])(t.horizontalAlignment)?this._dynamicPropertyMap.set("_horizontalAlignment",t.horizontalAlignment):this._horizontalAlignment=t.horizontalAlignment,Object(x["c"])(t.verticalAlignment)?this._dynamicPropertyMap.set("_verticalAlignment",t.verticalAlignment):this._verticalAlignment=t.verticalAlignment,this._scaleFactor=e,Object(x["c"])(t.text)?this._dynamicPropertyMap.set("_text",t.text):this._text=t.text;const n=Math.min(Math.round(Object(f["d"])(t.referenceSize*t.sizeRatio)),127);this._referenceSize=Math.round(Math.sqrt(256*n)),this._materialKey=t.materialKey;const o=m["f"].load(this._materialKey);o.sdf=!0,this._bitset=(1===t.alignment?1:0)|(t.colorLocked?1:0)<<1,this._materialKey=o.data,this._decoration="none",this._lineHeight=1,this._lineWidth=512,this._textPlacement=t.markerPlacement,this.effects=t.effects,this._isCIM=!0}static fromCIMText(t){return new Vt(t)}async analyze(t,e,i,r){const s=e.readLegacyFeature(),n=function(t,e,i,r){return"string"==typeof t.text?t.text:"function"==typeof t.text?t.text(e,i,r):""}(this._cimTextLayer,s,i,r),o=await t.getMosaicItem(this._cimTextLayer.cim,Object(Pt["a"])(n));return this._textToGlyphs.set(n,o.glyphMosaicItems),o}bindFeature(t,e,i){const r=t.readLegacyFeature();if(this._dynamicPropertyMap.forEach((t,s)=>{this[s]=t(r,e,i)}),!this._text||0===this._text.length)return void(this._shapingInfo=null);this._size*=this._scaleFactor,this._scale=this._size/24,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=Object(kt["d"])(this._horizontalAlignment||"center"),this._yAlignD=Object(kt["f"])(this._verticalAlignment||"baseline");const s=this._textToGlyphs.get(this._text);this.bindTextInfo(s,!1)}}var Dt=Vt;class Ft extends(it(st["a"])){constructor(t,e,i,r,s,n,o,a,c){super(),this.effects=c;const l=m["a"].load(t);e&&(l.sdf=e.sdf,l.pattern=!0,l.textureBinding=e.textureBinding),this.fillColor=i,this.tl=r,this.br=s,this.aux1=n,this.aux2=o,this.aux3=a,this._materialKey=l.data}static fromCIMFill(t,e){const i=t.color,r=i&&Object(y["c"])(i)||0,s=t.materialKey;if(!e){const e=Object(p["b"])(0,0,0,t.colorLocked?1:0);return new Ft(s,null,r,0,0,0,0,e,t.effects)}const{rect:n,width:o,height:a}=e,c=n.x+d["r"],l=n.y+d["r"],h=c+o,m=l+a;let x=Object(u["i"])(Object(f["d"])(t.height||0));x>255?x=255:x<=0&&(x=Object(u["i"])(m-l));let _=Object(u["i"])(Object(f["d"])(t.height/a*o||0));_>255?_=255:_<=0&&(_=Object(u["i"])(h-c));let g=Object(f["d"])(t.offsetX||0)+128;g>255&&(g=255);let O=Object(f["d"])(-t.offsetY||0)+128;O>255&&(O=255);const v=t.scaleX||1,M=Object(p["a"])(c,l),j=Object(p["a"])(h,m),w=Object(p["b"])(_,x,g,O),S=Object(p["a"])(128*v,128),C=Object(p["b"])(0,0,Object(b["b"])(t.angle),t.colorLocked?1:0);return new Ft(s,e,r,M,j,w,S,C,t.effects)}static fromSimpleFill(t,e,i=!1){const{color:r}=t,s=r&&"esriSFSNull"!==t.style&&Object(y["d"])(r)||0,n=Object(p["b"])(0,0,0,i?255:0),o=t.materialKey;if(!e)return new Ft(o,null,s,0,0,0,0,n,null);const{rect:a,width:c,height:l}=e,h=a.x+d["r"],f=a.y+d["r"],m=h+c,b=f+l,x=Object(p["a"])(h,f),_=Object(p["a"])(m,b),g=Object(p["b"])(Object(u["i"])(m-h),Object(u["i"])(b-f),0,0),O=Object(p["a"])(128,128);return new Ft(o,e,s,x,_,g,O,n,null)}static fromPictureFill(t,e,i=!1){const r=d["q"],{rect:s,width:n,height:o}=e,a=s.x+d["r"],c=s.y+d["r"],l=a+n,h=c+o,m=Object(p["a"])(a,c),y=Object(p["a"])(l,h);let b=Object(u["i"])(Object(f["d"])(t.width));b>255&&(b=255);let x=Object(u["i"])(Object(f["d"])(t.height));x>255&&(x=255);let _=Object(f["d"])(t.xoffset)+128;_>255&&(_=255);let g=Object(f["d"])(-t.yoffset)+128;g>255&&(g=255);const O=Object(p["b"])(b,x,_,g),v=Object(p["a"])(128*t.xscale,128*t.yscale),M=Object(p["b"])(0,0,0,i?255:0),j=t.materialKey;return new Ft(j,e,r,m,y,O,v,M,null)}}var At=Ft,Nt=i("c8dd");const Bt=r["a"].getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");class Et extends(gt(st["a"])){constructor(t,e,i,r,s,n,o,a,c,l,h,u,f,d,p,y){super();const b=m["c"].load(t);e&&(b.sdf=e.sdf,b.pattern=!0,b.textureBinding=e.textureBinding),this._capType=r,this._joinType=s,this._miterLimitCosine=Object(x["b"])(n),this.tessellationProperties._fillColor=o,this.tessellationProperties._tl=a,this.tessellationProperties._br=c,this._hasPattern=l,this._isDashed=h,this._joinOnUTurn=p,this._isColorLocked=u,this._zOrder=d,this.effects=y,this._materialKey=b.data,this.tessellationProperties._bitset=u?1:0,this.tessellationProperties._halfWidth=.5*i,this.tessellationProperties._halfReferenceWidth=.5*f,this._initializeTessellator(!1)}static fromCIMLine(t,e,i){const r=t.color,s=t.scaleFactor||1,n=t.isDashed;let o=t.cap;n&&1===o&&(o=2);const a=t.join,c=Object(f["d"])(t.width)*s,l=Object(f["d"])(t.referenceWidth),h=Object(f["d"])(t.miterLimit),u=r&&Object(y["c"])(r)||0;if(!e)return new Et(t.materialKey,e,c,o,a,h,u,0,0,!1,n,t.colorLocked,l,t.zOrder,i,t.effects);const{rect:m,width:b,height:x}=e,_=m.x+d["r"],g=m.y+d["r"],O=_+b,v=g+x,M=Object(p["a"])(_,g),j=Object(p["a"])(O,v);return new Et(t.materialKey,e,c,o,a,h,u,M,j,!0,n,t.colorLocked,l,t.zOrder,i,t.effects)}static fromSimpleLine(t,e,i){const{color:r}=t,s="esriSLSSolid"!==t.style&&"esriSLSNull"!==t.style,n=Object(Nt["g"])(t.cap||"round",s),o=Object(Nt["h"])(t.join||"round");let a=r&&"esriSLSNull"!==t.style&&Object(y["d"])(r)||0;"esriSLSNull"===t.style&&(a=0);const c=Object(f["d"])(t.width),l=t.miterLimit;if(!e)return new Et(t.materialKey,e,c,n,o,l,a,0,0,!1,s,!1,c,0,i,null);const{rect:h,width:u,height:m}=e,b=h.x+d["r"],x=h.y+d["r"],_=b+u,g=x+m,O=Object(p["a"])(b,x),v=Object(p["a"])(_,g);return new Et(t.materialKey,e,c,n,o,l,a,O,v,!0,s,!1,c,0,i,null)}static fromPictureLineSymbol(t,e,i,r){return Bt.error("PictureLineSymbol support does not exist!"),null}}var Zt=Et;function Xt(t,e,i){return t.acquire().then(()=>e(i)).then(()=>t.release()).catch(e=>{throw t.release(),e})}var Gt=class{constructor(){this._resolver=null}isHeld(){return!!this._resolver}acquire(){return this._resolver?this._resolver.promise.then(()=>this.acquire()):(this._resolver=Object(n["g"])(),Object(n["u"])())}release(){const t=this._resolver;this._resolver=null,t.resolve()}};const Ut=r["a"].getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),Kt=new Array;function Yt(t,e){const i=t.length;return t.push(null),e.then(e=>t[i]=e),t}function Ht(t){return!!(1&t)}class Wt{constructor(t,e){this._idCounter=1,this._templateIdCounter=1,this._idToTemplateGroup=new Map,this._symbolToTemplate=new Map,this._fetchQueue=[],this._idToResolver=new Map,this._cimTemplateCache=new Map,this._cimAnalyses=[],this._lock=new Gt,this._fetchResource=t,this._joinOnUTurn=e}get _markerError(){return this._errorTemplates.marker[0]}get _fillError(){return this._errorTemplates.fill[0]}get _lineError(){return this._errorTemplates.line[0]}get _textError(){return this._errorTemplates.line[0]}createTemplateGroup(t,e){this._initErrorTemplates();const i=t.hash;if(this._symbolToTemplate.has(i))return this._symbolToTemplate.get(i);const r=new Array;e&&this._createMeshTemplates(r,e,!0),this._createMeshTemplates(r,t,!1);const s=this._createGroupId("expanded-cim"===t.type);return this._idToTemplateGroup.set(s,r),this._symbolToTemplate.set(i,s),s}getTemplateGroup(t){return this._idToTemplateGroup.has(t)?this._idToTemplateGroup.get(t):Kt}getDynamicTemplateGroup(t){return this._idToTemplateGroup.has(t)?(Ht(t)||Ut.error("mapview-template-store",`Id ${t} does not refer to a dynamic template`),this._idToTemplateGroup.get(t)):Kt}getMosaicItem(t,e){const i=this._createTemplateId(),r=Object(n["c"])(t=>this._idToResolver.set(i,t));return this._fetchQueue.push({symbol:t,id:i,glyphIds:e}),r}finalize(t){return this._fetchQueue.length||this._lock.isHeld()?Xt(this._lock,this._fetchAllQueuedResources.bind(this),t):Object(n["u"])()}_initErrorTemplates(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],Object(c["c"])(o["c"]),!1),marker:this._createMeshTemplates([],Object(c["c"])(o["b"]),!1),line:this._createMeshTemplates([],Object(c["c"])(o["d"]),!1)})}_fetchAllQueuedResources(t){if(!this._fetchQueue.length)return Object(n["u"])();const e=this._fetchQueue,i=this._cimAnalyses;return this._fetchQueue=[],this._cimAnalyses=[],Object(n["b"])(i).then(()=>this._fetchResource(e,t).then(t=>{for(const{id:e,mosaicItem:i}of t)this._idToResolver.get(e)(i),this._idToResolver.delete(e)})).catch(t=>{Object(n["n"])(t)?this._fetchQueue=this._fetchQueue.concat(e):function(t){return"worker:port-closed"===t.name}(t)||Ut.error(new s["a"]("mapview-template-store","Unable to fetch requested texture resources",t))})}_createGroupId(t){return this._idCounter++<<1|(t?1:0)}_createTemplateId(){return this._templateIdCounter++}async _createSMS(t){const{spriteMosaicItem:e}=await this.getMosaicItem(t);return Object(a["a"])(e,Ut)?h["a"].fromSimpleMarker(t,e):this._markerError}async _createPMS(t){const{spriteMosaicItem:e}=await this.getMosaicItem(t);return Object(a["a"])(e,Ut)?h["a"].fromPictureMarker(t,e):this._markerError}async _createSFS(t,e){const{spriteMosaicItem:i}=await this.getMosaicItem(t);return Object(a["a"])(i,Ut)?At.fromSimpleFill(t,i,e):this._fillError}async _createPFS(t,e){const{spriteMosaicItem:i}=await this.getMosaicItem(t);return Object(a["a"])(i,Ut)?At.fromPictureFill(t,i,e):this._fillError}async _createSLS(t,e){const{spriteMosaicItem:i}=await this.getMosaicItem(t);return Object(a["a"])(i,Ut)?Zt.fromSimpleLine(t,i,this._joinOnUTurn):this._lineError}async _createLMS(t){const{spriteMosaicItem:e}=await this.getMosaicItem(t);return Object(a["a"])(e,Ut)?h["a"].fromLineSymbolMarker(t,e):this._markerError}async _createTS(t){const{glyphMosaicItems:e}=await this.getMosaicItem(t);return l["a"].fromText(t,e)}async _createCIMText(t){const{glyphMosaicItems:e}=await this.getMosaicItem(t.cim,Object(Pt["a"])(t.text));return t.cim.mosaicHash=t.materialHash,Object(a["a"])(e,Ut)?l["a"].fromCIMText(t,e):this._textError}async _createCIMFill(t){t.cim.mosaicHash=t.materialHash;const{spriteMosaicItem:e}=await this.getMosaicItem(t.cim);return Object(a["a"])(e,Ut)?At.fromCIMFill(t,e):this._fillError}async _createCIMLine(t){t.cim.mosaicHash=t.materialHash;const{spriteMosaicItem:e}=await this.getMosaicItem(t.cim);return Object(a["a"])(e,Ut)?Zt.fromCIMLine(t,e,this._joinOnUTurn):this._lineError}async _createCIMMarker(t){t.cim.mosaicHash=t.materialHash;const{spriteMosaicItem:e}=await this.getMosaicItem(t.cim);return Object(a["a"])(e,Ut)?h["a"].fromCIMMarker(t,e):this._markerError}async _createCIM(t){const e=t.templateHash;if(this._cimTemplateCache.has(e))return this._cimTemplateCache.get(e);let i;switch(t.type){case"marker":i=this._createCIMMarker(t);break;case"line":i=this._createCIMLine(t);break;case"fill":i=this._createCIMFill(t);break;case"text":i=this._createCIMText(t)}return i.then(t=>this._cimTemplateCache.set(e,t)),i}_createDynamicCIM(t){const e=t.templateHash;if(this._cimTemplateCache.has(e))return this._cimTemplateCache.get(e);let i;switch(t.type){case"marker":i=Tt.fromCIMMarker(t);break;case"line":i=vt.fromCIMLine(t);break;case"fill":i=ct.fromCIMFill(t);break;case"text":i=Dt.fromCIMText(t)}return this._cimTemplateCache.set(e,i),i}_createPrimitiveMeshTemplates(t,e,i){switch(e.type){case"esriSMS":return Yt(t,this._createSMS(e));case"esriPMS":return Yt(t,this._createPMS(e));case"esriSFS":return Yt(t,this._createSFS(e,i));case"line-marker":return Yt(t,this._createLMS(e));case"esriPFS":return Yt(t,this._createPFS(e,i));case"esriSLS":return Yt(t,this._createSLS(e,!1));case"esriTS":return Yt(t,this._createTS(e));default:return Ut.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),t}}_createMeshTemplates(t,e,i){if(-1!==e.type.indexOf("3d"))return Ut.error("3D symbols are not supported with MapView"),t;if("expanded-cim"===e.type){for(const i of e.layers)"function"==typeof i.materialHash?t.push(this._createDynamicCIM(i)):Yt(t,this._createCIM(i));return t}if("composite-symbol"===e.type){for(const r of e.layers)this._createPrimitiveMeshTemplates(t,r,i);return t}return"cim"===e.type||"label"===e.type||"web-style"===e.type?t:this._createPrimitiveMeshTemplates(t,e,i)}}},"18c6":function(t,e,i){"use strict";i.d(e,"a",(function(){return p})),i.d(e,"b",(function(){return x})),i.d(e,"c",(function(){return y})),i.d(e,"d",(function(){return m})),i.d(e,"e",(function(){return l})),i.d(e,"f",(function(){return b})),i.d(e,"g",(function(){return a})),i.d(e,"h",(function(){return c}));var r=i("ce50"),s=i("c84e"),n=i("9b77");function o(t,e=!1){const i=s["e"].SIZE_FIELD_STOPS|s["e"].SIZE_MINMAX_VALUE|s["e"].SIZE_SCALE_STOPS|s["e"].SIZE_UNIT_VALUE,r=(t&(s["f"].FIELD_TARGETS_OUTLINE|s["f"].MINMAX_TARGETS_OUTLINE|s["f"].SCALE_TARGETS_OUTLINE|s["f"].UNIT_TARGETS_OUTLINE))>>>4;return e?i&r:i&~r}function a(t,e,i,r,n){switch(t){case s["d"].FILL:return p.from(e,r);case s["d"].LINE:return y.from(e,i);case s["d"].MARKER:return m.from(e);case s["d"].TEXT:return b.from(e);case s["d"].LABEL:return x.from(e,n);default:throw new Error("Unable to createMaterialKey for unknown geometryType "+t)}}function c(t){switch(l.load(t).geometryType){case s["d"].MARKER:return new m(t);case s["d"].FILL:return new p(t);case s["d"].LINE:return new y(t);case s["d"].TEXT:return new b(t);case s["d"].LABEL:return new x(t)}}class l{constructor(t){this._data=0,this._data=t}static load(t){const e=this.shared;return e.data=t,e}set data(t){this._data=t}get data(){return this._data}get geometryType(){return this.bits(8,11)}set geometryType(t){this.setBits(t,8,11)}get mapAligned(){return!!this.bit(20)}set mapAligned(t){this.setBit(20,t)}get sdf(){return!!this.bit(11)}set sdf(t){this.setBit(11,t)}get pattern(){return!!this.bit(12)}set pattern(t){this.setBit(12,t)}get textureBinding(){return this.bits(0,8)}set textureBinding(t){this.setBits(t,0,8)}get geometryTypeString(){switch(this.geometryType){case s["d"].FILL:return"fill";case s["d"].MARKER:return"marker";case s["d"].LINE:return"line";case s["d"].TEXT:return"text";case s["d"].LABEL:return"label";default:throw new r["a"]("Unable to handle unknown geometryType: "+this.geometryType)}}setBit(t,e){const i=1<<t;e?this._data|=i:this._data&=~i}bit(t){return(this._data&1<<t)>>t}setBits(t,e,i){for(let r=e,s=0;r<i;r++,s++)this.setBit(r,0!=(t&1<<s))}bits(t,e){let i=0;for(let r=t,s=0;r<e;r++,s++)i|=this.bit(r)<<s;return i}hasVV(){return!1}setVV(t,e){}getVariation(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf}}getVariationHash(){return this._data&~(7&this.textureBinding)}}l.shared=new l(0);const h=t=>class extends t{get vvSizeMinMaxValue(){return 0!==this.bit(16)}set vvSizeMinMaxValue(t){this.setBit(16,t)}get vvSizeScaleStops(){return 0!==this.bit(17)}set vvSizeScaleStops(t){this.setBit(17,t)}get vvSizeFieldStops(){return 0!==this.bit(18)}set vvSizeFieldStops(t){this.setBit(18,t)}get vvSizeUnitValue(){return 0!==this.bit(19)}set vvSizeUnitValue(t){this.setBit(19,t)}hasVV(){return super.hasVV()||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue}setVV(t,e){super.setVV(t,e);const i=o(t,e)&t;this.vvSizeMinMaxValue=!!(i&s["e"].SIZE_MINMAX_VALUE),this.vvSizeFieldStops=!!(i&s["e"].SIZE_FIELD_STOPS),this.vvSizeUnitValue=!!(i&s["e"].SIZE_UNIT_VALUE),this.vvSizeScaleStops=!!(i&s["e"].SIZE_SCALE_STOPS)}},u=t=>class extends t{get vvRotation(){return 0!==this.bit(15)}set vvRotation(t){this.setBit(15,t)}hasVV(){return super.hasVV()||this.vvRotation}setVV(t,e){super.setVV(t,e),this.vvRotation=!e&&!!(t&s["e"].ROTATION)}},f=t=>class extends t{get vvColor(){return 0!==this.bit(13)}set vvColor(t){this.setBit(13,t)}hasVV(){return super.hasVV()||this.vvColor}setVV(t,e){super.setVV(t,e),this.vvColor=!e&&!!(t&s["e"].COLOR)}},d=t=>class extends t{get vvOpacity(){return 0!==this.bit(14)}set vvOpacity(t){this.setBit(14,t)}hasVV(){return super.hasVV()||this.vvOpacity}setVV(t,e){super.setVV(t,e),this.vvOpacity=!e&&!!(t&s["e"].OPACITY)}};class p extends(f(d(l))){static load(t){const e=this.shared;return e.data=t,e}static from(t,e){const i=this.load(0);return i.geometryType=s["d"].FILL,e?i.dotDensity=!0:i.setVV(t,!1),i.data}getVariation(){return{...super.getVariation(),dotDensity:this.dotDensity,vvColor:this.vvColor,vvOpacity:this.vvOpacity}}get dotDensity(){return!!this.bit(15)}set dotDensity(t){this.setBit(15,t)}}p.shared=new p(0);class m extends(f(d(u(h(l))))){static load(t){const e=this.shared;return e.data=t,e}static from(t){const e=this.load(0);return e.geometryType=s["d"].MARKER,e.setVV(t,!1),e.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}m.shared=new m(0);class y extends(f(d(h(l)))){static load(t){const e=this.shared;return e.data=t,e}static from(t,e){const i=this.load(0);return i.geometryType=s["d"].LINE,i.setVV(t,e),i.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}y.shared=new y(0);class b extends(f(d(u(h(l))))){static load(t){const e=this.shared;return e.data=t,e}static from(t){const e=this.load(t);return e.geometryType=s["d"].TEXT,e.setVV(t,!1),e.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}b.shared=new b(0);class x extends(h(l)){static load(t){const e=this.shared;return e.data=t,e}static from(t,e){const i=this.load(0);return i.geometryType=s["d"].LABEL,i.setVV(t,!1),i.mapAligned=!!Object(n["a"])(e),i.data}getVariation(){return{...super.getVariation(),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}x.shared=new x(0)},"1aa6":function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var r=i("ce50");function s(t,e){if(t&&"name"in t){const i=t;return e&&e.error(new r["a"](i.name,i.message,i.details)),!1}return!0}},"1d01":function(t,e,i){"use strict";i.d(e,"a",(function(){return h})),i.d(e,"b",(function(){return c})),i.d(e,"c",(function(){return l})),i.d(e,"d",(function(){return a}));Number.POSITIVE_INFINITY;const r=Math.PI,s=128/r,n=1/Math.LN2;function o(t,e){return(t%=e)>=0?t:t+e}function a(t){return o(t*s,256)}function c(t){return o(.7111111111111111*t,256)}function l(t){return Math.log(t)*n}function h(t,e,i){return t>=e&&t<=i||t>=i&&t<=e}},2779:function(t,e,i){"use strict";i.d(e,"a",(function(){return X}));i("c120");var r=i("b2b2"),s=i("f4cc"),n=i("8c81"),o=i("c84e"),a=i("69c3"),c=i("c8dd"),l=i("3de4"),h=i("daf1");class u{constructor(t,e){this.data=t,this.stride=e}get vertexCount(){const t=this.stride/4,e=this.data.length/t;return e!==(0|e)&&console.debug("Corrupted stride"),e}transfer(t,e){const i=this.data.buffer();t.vertexCount=this.vertexCount,t.data=i,t.stride=this.stride,e.push(i)}}class f{constructor(t,e,i=!1){this.geometryType=t,this.indexVector=new l["a"](Uint32Array,6*e),this.namedVectors={};const r=Object(c["k"])(t,i);for(const s in r){const t=r[s];let i;switch(t%4){case 0:case 2:i=new l["a"](Uint32Array,t*e);break;case 1:case 3:i=new l["a"](Uint8Array,t*e)}this.namedVectors[s]=new u(i,t)}}get(t){return this.namedVectors[t].data}getVector(t){return this.namedVectors[t]}transfer(t,e){const i=this.indexVector.buffer(),r={};e.push(i);for(const s in this.namedVectors){const t=this.namedVectors[s];r[s]={},t.transfer(r[s],e)}t.geometryType=this.geometryType,t.indexBuffer=i,t.namedBuffers=r,this.destroy()}intoBuffers(){const t=h["a"].fromVertexVectors(this);return this.destroy(),t}destroy(){this.indexVector=null,this.namedVectors=null}}var d=i("e92d"),p=i("ce50"),m=i("38a4"),y=i("a915"),b=i("32dd"),x=i("d114"),_=i("9b77"),g=i("18c6"),O=i("a9a2"),v=i("34c7"),M=i("6a2c");function j(t,e){return t[e+1]}function w(t){return t.length-1}function S(t){let e=0;for(let i=0;i<w(t);i++)e+=C(t,i);return e}function C(t,e,i=1){const[r,s]=j(t,e);return Math.sqrt(r*r+s*s)*i}class I{constructor(t,e,i,r,s){this._segments=t,this._index=e,this._distance=i,this._xStart=r,this._yStart=s,this._done=!1}static create(t){return new I(t,0,0,t[0][0],t[0][1])}clone(){return new I(this._segments,this._index,this._distance,this.xStart,this.yStart)}equals(t){return this._index===t._index||t._index===this._index-1&&(0===this._distance||1===t._distance)||t._index===this._index+1&&(1===this._distance||0===t._distance)}leq(t){return this._index<t._index||this._index===t._index&&this._distance<=t._distance}geq(t){return this._index>t._index||this._index===t._index&&this._distance>=t._distance}get _segment(){return this._segments[this._index+1]}get angle(){const t=this.dy,e=(0*t+-1*-this.dx)/(1*this.length);let i=Math.acos(e);return t>0&&(i=2*Math.PI-i),i}get xStart(){return this._xStart}get yStart(){return this._yStart}get x(){return this.xStart+this.distance*this.dx}get y(){return this.yStart+this.distance*this.dy}get dx(){return this._segment[0]}get dy(){return this._segment[1]}get xMidpoint(){return this.xStart+.5*this.dx}get yMidpoint(){return this.yStart+.5*this.dy}get xEnd(){return this.xStart+this.dx}get yEnd(){return this.yStart+this.dy}get length(){const{dx:t,dy:e}=this;return Math.sqrt(t*t+e*e)}get remainingLength(){return this.length*(1-this._distance)}get backwardLength(){return this.length*this._distance}get distance(){return this._distance}get done(){return this._done}hasPrev(){return this._index-1>=0}hasNext(){return this._index+1<w(this._segments)}next(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}prev(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}_seekBackwards(t,e){const i=this.backwardLength;if(t<=i)return this._distance=(i-t)/this.length,this;let r=this.backwardLength;for(;this.prev();){if(r+this.length>t)return this._seekBackwards(t-r);r+=this.length}return this._distance=0,e?this:null}seek(t,e=!1){if(t<0)return this._seekBackwards(Math.abs(t),e);if(t<=this.remainingLength)return this._distance=(this.backwardLength+t)/this.length,this;let i=this.remainingLength;for(;this.next();){if(i+this.length>t)return this.seek(t-i,e);i+=this.length}return this._distance=1,e?this:null}}function L(t,e,i){const r=S(t),s=I.create(t),n=r/2,o=(r-e)/2,a=Math.floor(o/e),c=n-a*e;s.seek(c);for(let l=-a;l<=a;l++)s.x<512&&s.x>=0&&s.y<512&&s.y>=0&&i(s.clone(),l,n+l*e,r),s.seek(e)}function z(t,e){const i=e;for(let r=0;r<t.length;r++){let e=t[r];const s=[];s.push(e[0]);for(let t=1;t<e.length;t++){let[i,r]=s[t-1];i+=e[t][0],r+=e[t][1],s.push([i,r])}T(s,i);const n=[];n.push(s[0]);for(let t=1;t<s.length;t++){const[e,i]=s[t-1],[r,o]=s[t],a=Math.round(r-e),c=Math.round(o-i);n.push([a,c])}t[r]=n,e=n}return t}function T(t,e){const i=1e-6;if(e<=0)return;const r=t.length;if(r<3)return;const s=[];let n=0;s.push(0);for(let u=1;u<r;u++)n+=Object(M["a"])(t[u],t[u-1]),s.push(n);e=Math.min(e,.2*n);const o=[];o.push(t[0][0]),o.push(t[0][1]);const a=t[r-1][0],c=t[r-1][1],l=Object(M["e"])([0,0],t[0],t[1]);Object(M["d"])(l),t[0][0]+=e*l[0],t[0][1]+=e*l[1],Object(M["e"])(l,t[r-1],t[r-2]),Object(M["d"])(l),t[r-1][0]+=e*l[0],t[r-1][1]+=e*l[1];for(let u=1;u<r;u++)s[u]+=e;s[r-1]+=e;const h=.5*e;for(let u=1;u<r-1;u++){let n=0,a=0,c=0;for(let r=u-1;r>=0&&!(s[r+1]<s[u]-h);r--){const o=h+s[r+1]-s[u],l=s[r+1]-s[r],f=s[u]-s[r]<h?1:o/l;if(Math.abs(f)<i)break;const d=f*f,p=f*o-.5*d*l,m=f*l/e,y=t[r+1],b=t[r][0]-y[0],x=t[r][1]-y[1];n+=m/p*(y[0]*f*o+.5*d*(o*b-l*y[0])-d*f*l*b/3),a+=m/p*(y[1]*f*o+.5*d*(o*x-l*y[1])-d*f*l*x/3),c+=m}for(let o=u+1;o<r&&!(s[o-1]>s[u]+h);o++){const r=h-s[o-1]+s[u],l=s[o]-s[o-1],f=s[o]-s[u]<h?1:r/l;if(Math.abs(f)<i)break;const d=f*f,p=f*r-.5*d*l,m=f*l/e,y=t[o-1],b=t[o][0]-y[0],x=t[o][1]-y[1];n+=m/p*(y[0]*f*r+.5*d*(r*b-l*y[0])-d*f*l*b/3),a+=m/p*(y[1]*f*r+.5*d*(r*x-l*y[1])-d*f*l*x/3),c+=m}o.push(n/c),o.push(a/c)}o.push(a),o.push(c);for(let u=0,f=0;u<r;u++)t[u][0]=o[f++],t[u][1]=o[f++]}var P=i("89e8");const k=d["a"].getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),R=function(t){const e=new Map;return i=>(e.has(i)||e.set(i,t(i)),e.get(i))}(t=>{let e=0;if(0===t)return 1/0;for(;!(t%2);)e++,t/=2;return e}),V=t=>Math.floor(127*t+127),D=t=>Math.floor(10*t),F=t=>Math.round(t*(254/360)),A=(t,e)=>Object(x["a"])(Math.round(8*t),Math.round(8*e));class N extends P["a"]{constructor(t,e,i,r){super(t,i.font.size,i.haloSize||0,i.color&&Object(O["d"])(i.color)||0,i.haloColor&&Object(O["d"])(i.haloColor)||0,i.horizontalAlignment,i.verticalAlignment,Object(_["a"])(e.labelPlacement)?1:0,i.font.decoration,!1,i.angle||0,i.xoffset,i.yoffset,i.lineWidth,i.lineHeight,null,null),this._outLineLabelAngle=0,this._refPlacementPadding=0,this._refPlacementDirX=0,this._refPlacementDirY=0,this._refOffsetX=0,this._refOffsetY=0,this.geometryType=o["d"].LABEL;const s=function(t,e){const i=!!t.minScale&&e.scaleToZoom(t.minScale)||0;return Object(m["c"])(i,0,25.5)}(e,r),a=function(t,e){const i=!!t.maxScale&&e.scaleToZoom(t.maxScale)||255;return Object(m["c"])(i,0,25.5)}(e,r),c=e.labelPlacement,[l,h]=Object(b["b"])(c);this._xAlignD=l,this._yAlignD=h,this._minZoom=s,this._maxZoom=a,this._refPlacementPadding=Object(y["d"])(i.haloSize)+n["D"];const u=g["b"].load(t);u.sdf=!0,this._materialKey=u.data}static fromLabelClass(t,e){if("center-along"===t.labelPlacement){const e=t.symbol;e.xoffset=0,e.yoffset=0,e.angle=0,e.font.decoration="none"}return new N(t.materialKey,t,t.symbol,e)}get _shapedBox(){return Object(r["n"])(this._shapingInfo).bounds}bindReferenceTemplate(t){let e=Object(b["e"])(this._xAlignD),i=Object(b["g"])(this._yAlignD);if(this._refOffsetX=0,this._refOffsetY=0,Object(r["g"])(t))return void(this._refSymbolAndPlacementOffset=Object(x["b"])(0,0,V(e),V(i)));if("circle"===t.boundsType&&(e||i)){const t=Math.sqrt(e*e+i*i);e/=t,i/=t}const s=Math.max(t.height,t.width),n=4*this._refPlacementPadding;this._refSymbolAndPlacementOffset=Object(x["b"])(n,s,V(e),V(i)),this._referenceSize=s,this._refPlacementDirX=e,this._refPlacementDirY=i,this._refOffsetX=t.xOffset,this._refOffsetY=t.yOffset}writeMesh(t,e,i,s,n,o){if(Object(r["g"])(this._shapingInfo))return;const a=new Array,c=this._shapingInfo,l="esriGeometryPolygon"===i.geometryType?i.readLegacyCentroid():i.readLegacyGeometry();if(l){switch(this.current={out:t,outVecs:e,outMetrics:a,inId:n,inShaping:c,zoomLevel:o},s){case"esriGeometryPolyline":this._placeLineLabels(l);break;case"esriGeometryPoint":case"esriGeometryPolygon":this._placePointLabels(l);break;default:((t,e="mapview-labeling")=>{k.error(new p["a"](e,t))})("mapview-labeling",`Geometry of type ${s} is not supported`)}t.writeMetrics(this.current.outMetrics)}}_isVisible(t,e){const i=D(this.current.zoomLevel);return D(t)<=i&&i<=D(e)}_placePointLabels(t){const{out:e,outVecs:i,outMetrics:r,inId:s}=this.current;this._writeGlyphs(e,i,s,t,r)}_placeLineLabels(t){const e=z(t.paths,this.current.inShaping.bounds.width),i=this._placeSubdivGlyphs.bind(this),r=(this._shapedBox.width+128)/4;for(const s of e)L(s,r,i)}_placeSubdivGlyphs(t,e,i,r){const s=R(e),n=this._shapedBox.width/4,o=Math.min(i,r-i),a=Object(m["h"])(o/(4+n/2)),c=0===e?a:Math.min(s,a),l=Math.max(this._minZoom,this.current.zoomLevel+2-c),h=this.current.zoomLevel-l,u=this._shapedBox.width/2*Math.pow(2,h);this.current.inShaping.isMultiline?0===e&&this._placeStraight(t,l):this._placeCurved(t,l,u)}_placeStraight(t,e){const{out:i,outVecs:r,outMetrics:s,inId:n}=this.current;this._writeGlyphs(i,r,n,t,s,e)}_placeCurved(t,e,i){const r={from:this.current.out.currentDisplayRecordCount(),count:-1},s=new v["a"](this.current.inId,r,t.x,t.y,e),n=t.clone(),o=t.angle*(180/Math.PI)%360,a=(t.angle*(180/Math.PI)+180)%360;this._outLineLabelAngle=F(o),this._placeFirst(n,s,e,1),this._placeBack(t,n,s,e,i,1),this._placeForward(t,n,s,e,i,1),this._outLineLabelAngle=F(a),this._placeFirst(n,s,e,0),this._placeBack(t,n,s,e,i,0),this._placeForward(t,n,s,e,i,0),s.range.count=this.current.out.currentDisplayRecordCount()-s.range.from,s.bounds&&this.current.outMetrics.push(s)}_placeBack(t,e,i,r,s,n){const o=t.clone();let a=t.backwardLength+0;for(;o.prev()&&!(a>=s);)this._placeOnSegment(o,e,i,a,r,-1,n),a+=o.length+0}_placeForward(t,e,i,r,s,n){const o=t.clone();let a=t.remainingLength+0;for(;o.next()&&!(a>=s);)this._placeOnSegment(o,e,i,a,r,1,n),a+=o.length+0}_placeFirst(t,e,i,r){const s=t,n=this.current.inShaping,o=n.glyphs,a=this.current.zoomLevel,{out:c,outVecs:l,inId:h}=this.current,u=A(s.x,s.y);for(const f of o){const s=f.x>n.bounds.x?r:1-r,o=s*t.remainingLength+(1-s)*t.backwardLength,d=Math.abs(f.x+f.width/2-n.bounds.x),p=Math.max(0,a+Object(m["h"])(d/(o+0))),y=Math.max(i,p);f.maxZoom=25,f.angle=t.angle+(1-r)*Math.PI,f.minZoom=y,this._writeGlyph(c,l,f,h,u),r&&this._isVisible(f.minZoom,f.maxZoom)&&e.add(f.bounds,0,0)}}_placeOnSegment(t,e,i,r,s,n,o){const a=this.current.inShaping.glyphs,{out:c,outVecs:l,inId:h}=this.current,u=this.current.inShaping,f=this.current.zoomLevel,d=t.dx/t.length,p=t.dy/t.length,y={x:t.x+r*-n*d,y:t.y+r*-n*p},b=A(y.x,y.y);for(const x of a){const a=x.x>u.bounds.x?o:1-o;if(!(a&&1===n||!a&&-1===n))continue;const d=Math.abs(x.x+x.width/2-u.bounds.x),p=Math.max(0,f+Object(m["h"])(d/r)-.1),y=Math.max(s,f+Object(m["h"])(d/(r+t.length+0)));0!==p&&(x.angle=t.angle+(1-o)*Math.PI,x.minZoom=y,x.maxZoom=p,this._writeGlyph(c,l,x,h,b),o&&this._isVisible(x.minZoom,x.maxZoom)&&i.add(x.bounds,t.x-e.x,t.y-e.y))}}_writeGlyphs(t,e,i,s,n,o=this._minZoom){const a=this._shapingInfo;if(Object(r["g"])(a))return;if(s.x<0||s.x>=512||s.y<0||s.y>=512)return;const c=t.currentDisplayRecordCount(),l=A(s.x+this._refOffsetX,s.y-this._refOffsetY),h=new v["a"](i,{from:c,count:-1},s.x+this._refOffsetX,s.y-this._refOffsetY,o);for(const r of a.glyphs)r.minZoom=o,r.maxZoom=this._maxZoom,this._writeGlyph(t,e,r,i,l);h.range.count=t.currentDisplayRecordCount()-h.range.from,h.bounds=a.boundsT;const u=g["b"].load(this._materialKey),f=this._refPlacementDirX,d=this._refPlacementDirY,p=u.vvSizeFieldStops||u.vvSizeMinMaxValue||u.vvSizeScaleStops||u.vvSizeUnitValue;h.setPlacementOffset(p,this._referenceSize,this._refPlacementPadding,f,d),n.push(h)}_writeGlyph(t,e,i,r,s){const n=g["e"].load(this._materialKey);n.textureBinding=i.textureBinding;const o=e.indexVector.length,a=e.getVector("geometry").vertexCount,c=this._writeIndices(e),l=this._writeVertex(e,r,s,i);t.writeDisplayRecord(this.geometryType,n.data,a,l,o,c)}_writeVertexCommon(t,e,i,r){const s=this._color,n=this._haloColor,o=Object(x["b"])(0,0,this._size,this._haloSize),a=Math.max(r.minZoom,this._minZoom),c=Math.min(r.maxZoom,this._maxZoom),l=Object(x["b"])(D(a),D(c),this._outLineLabelAngle,0);t.push(i),t.push(e),t.push(s),t.push(n),t.push(o),t.push(this._refSymbolAndPlacementOffset),t.push(l)}}var B=N,E=i("a8b5"),Z=i("0f0f");class X{constructor(t,e,i){this._isDD=!1,this._geometryType=t,this._idField=e,this._templateStore=i}update(t,e){this._isDD="simple"===t.mesh.matcher.type&&t.mesh.matcher.isDotDensity,Object(r["h"])(t.mesh.labels)&&this._setLabelTemplates(t.mesh.labels,e)}_setLabelTemplates(t,e){this._labelTemplates=t.map(t=>B.fromLabelClass(t,e))}get templates(){return this._templateStore}createMeshData(t){const e=new Array(5),i=this._labelTemplates&&this._labelTemplates.length>0,r="esriGeometryPolyline"===this._geometryType?n["k"]:n["j"];return e[o["d"].MARKER]=new f(o["d"].MARKER,4*t),e[o["d"].FILL]=new f(o["d"].FILL,t,this._isDD),e[o["d"].LINE]=new f(o["d"].LINE,t),e[o["d"].TEXT]=new f(o["d"].TEXT,4*t),e[o["d"].LABEL]=new f(o["d"].LABEL,i?4*r:0),new a["a"](e,{features:t,records:t,metrics:0})}async analyze(t,e,i,r,n){if(Object(s["o"])(n))return;let o;"dictionary"===e.type&&(o=await e.analyze(this._idField,t.copy(),i,r,n));let a=0;for(;t.next();){let s;if(s=o?o[a++]:e.match(this._idField,t,this._geometryType,i,r),t.setGroupId(s),Object(Z["b"])(s)){const e=this._templateStore.getDynamicTemplateGroup(s);for(const s of e)s&&s.analyze&&s.analyze(this._templateStore,t,i,r)}}return this._templateStore.finalize(n)}async analyzeGraphics(t,e,i,r,n){if(Object(s["o"])(n))return;const o=t.getCursor();for(e&&await e.analyze(this._idField,o.copy(),i,r,n);o.next();){let t=o.getGroupId();if(null!=t&&-1!==t||(t=e.match(this._idField,o,o.geometryType,i,r),o.setGroupId(t)),Object(Z["b"])(t)){const e=this._templateStore.getDynamicTemplateGroup(t);for(const t of e)t&&t.analyze&&t.analyze(this._templateStore,o,i,r)}o.setGroupId(t)}return this._templateStore.finalize(n)}writeGraphic(t,e){const i=e.getGroupId(),r=e.getDisplayId(),s=this._templateStore.getTemplateGroup(i),n=e.geometryType;if(null!=r){if(Object(Z["b"])(i))for(const t of s)t.bindFeature(e,null,null);if(s){t.writeDisplayObject(r,e.readGraphic().insertAfter);for(const i of s){if(!i)continue;const s=t.get(i.geometryType);i.writeMesh(t,s,e,n,r)}}}}writeCursor(t,e,i,s,n,o){const a=e.getGroupId(),c=e.getDisplayId(),l=this._templateStore.getTemplateGroup(a);if(null==c)return;if(!l)return;if(t.writeDisplayObject(c,0),Object(Z["b"])(a))for(const r of l)r.bindFeature(e,i,s);for(const r of l){const i=t.get(r.geometryType);!r.needsPixelBuffer&&e.hasFilter()||r.writeMesh(t,i,e,this._geometryType,c)}const h=t.hasDisplayRecords();if(Object(r["h"])(o)&&h){const i=o&&this._findLabelRef(l);this._writeLabels(t,e,c,o,i,n)}t.endDisplayObject()}_findLabelRef(t){for(const e of t)if(e instanceof E["a"])return e;return null}_writeLabels(t,e,i,s,n,o){for(const a of s)if(Object(r["h"])(a)&&a){const{glyphs:r,rtl:s,index:c}=a,l=this._labelTemplates[c],h=t.get(l.geometryType);l.bindReferenceTemplate(n),l.bindTextInfo(r,s),l.writeMesh(t,h,e,this._geometryType,i,o)}}}},"32b6":function(t,e,i){"use strict";function r(t){const e=new Array(t.length);for(let i=0;i<t.length;i++)e[i]=t.charCodeAt(i);return e}i.d(e,"a",(function(){return r}))},"34c7":function(t,e,i){"use strict";var r=i("e92d"),s=i("8c81"),n=i("738e"),o=i("7be1"),a=i("c275");const c=r["a"].getLogger("esri/views/2d/engine/webgl/collisions/Metric");class l{constructor(t,e,i,r,s){this.id=t,this.range=e,this.boxes=null,this.minZoom=-1,this.size=0,this.directionX=0,this.directionY=0,this.offsetX=0,this.offsetY=0,this.placementPadding=0,this.anchor=Object(n["b"])(i,r),this.baseZoom=s}add(t,e,i){t.x=t.x+e,t.y=t.y+i,this.bounds?this.boxes?(this.boxes.push(t),this.bounds.extend(t)):(this.boxes=[this.bounds,t],this.bounds=this.bounds.clone(),this.bounds.extend(t)):this.bounds=t}computeIndex(){const t=this.anchor[0],e=this.anchor[1],i=Math.floor(t/s["d"]),r=Math.floor(e/s["d"]);this.xBucket=i,this.yBucket=r;const n=s["F"]/s["d"];if(this.hasVV)return this.xOverflow=n,void(this.yOverflow=n);this.xOverflow=Math.min(n,Math.ceil(2*this.bounds.width/s["d"])),this.yOverflow=Math.min(n,Math.ceil(2*this.bounds.height/s["d"]))}findCollisionDelta(t){const e=this.bounds.findCollisionDelta(t.bounds),i=this.boxes&&this.boxes.length,r=t.boxes&&t.boxes.length;return Math.abs(e)>s["f"]||!i&&!r?e:i&&r?this._boxesToBoxes(t):i?this._boxesToBox(t):this._boxToBoxes(t)}computeVVOffset(t,e){e||c.error("mapview-labeling","Unable to compute label offset. Expected an evaluator function but found "+e);let i=this.size;if(this.hasVV){const r=e(t);i=isNaN(r)||null==r||r===1/0?this.size:r}this._computeOffset(i)}setPlacementOffset(t,e,i,r,s){this.hasVV=t,this.size=e,this.placementPadding=Math.round(i),this.directionX=r,this.directionY=s}clone(){const t=new l(this.id,this.range,this.anchor[0],this.anchor[1],this.baseZoom);return t.minZoom=this.minZoom,this.bounds&&(t.bounds=this.bounds.clone()),this.boxes&&(t.boxes=this.boxes.map(t=>t.clone())),t.xBucket=this.xBucket,t.yBucket=this.yBucket,t.xOverflow=this.xOverflow,t.yOverflow=this.yOverflow,t.hasVV=this.hasVV,t.size=this.size,t.directionX=this.directionX,t.directionY=this.directionY,t.offsetX=this.offsetX,t.offsetY=this.offsetY,t}_boxToBoxes(t){let e=-1/0;for(const i of t.boxes){const t=this.bounds.findCollisionDelta(i);e=Math.max(t,e)}return e}_boxesToBox(t){let e=this.boxes[0].findCollisionDelta(t.bounds);for(let i=1;i<this.boxes.length;i++){const r=this.boxes[i].findCollisionDelta(t.bounds);e=Math.max(r,e)}return e}_boxesToBoxes(t){let e=-1/0;for(let i=0;i<this.boxes.length;i++){const r=this.boxes[i];for(const i of t.boxes){const t=r.findCollisionDelta(i);e=Math.max(t,e)}}return e}_computeOffset(t){this.offsetX=this.directionX*(t/2+this.placementPadding),this.offsetY=this.directionY*(t/2+this.placementPadding)}serialize(t){return t.push(this.id),this.bounds.serialize(t),t.push(this.range.from),t.push(this.range.count),t.push(this.anchor[0]),t.push(this.anchor[1]),t.push(this.baseZoom),t.push(this.hasVV?1:0),t.push(this.size),t.writeF32(this.directionX),t.writeF32(this.directionY),t.push(this.offsetX),t.push(this.offsetY),t.push(this.placementPadding),Object(a["b"])(t,this.boxes),t}static deserialize(t){const e=t.readInt32(),i=o["a"].deserialize(t),r={from:t.readInt32(),count:t.readInt32()},s=t.readInt32(),n=t.readInt32(),c=t.readInt32(),h=t.readInt32(),u=t.readInt32(),f=t.readF32(),d=t.readF32(),p=t.readInt32(),m=t.readInt32(),y=t.readInt32(),b=Object(a["a"])(t,o["a"]),x=new l(e,r,s,n,c);return x.bounds=i,x.boxes=b,x.setPlacementOffset(!!h,u,y,f,d),x.offsetX=p,x.offsetY=m,x.computeIndex(),h||x._computeOffset(u),x}}e["a"]=l},"36b8":function(t,e,i){"use strict";function r(t,e,i){const r=t=>{let e=t.length;for(;e--;)if(-1===" /-,\n".indexOf(t.charAt(e)))return!1;return!0},n=[];let o=0,a=-1;do{if(a=e.indexOf("[",o),a>=o){if(a>o){const t=e.substr(o,a-o);n.push([t,null,r(t)])}if(o=a+1,a=e.indexOf("]",o),a>=o){if(a>o){const i=t[e.substr(o,a-o)];i&&n.push([null,i,!1])}o=a+1}}}while(-1!==a);if(o<e.length-1){const t=e.substr(o);n.push([t,null,r(t)])}return t=>{let e="",r=null;for(const i of n){const[s,n,o]=i;if(s)o?r=s:(r&&(e+=r,r=null),e+=s);else{const i=t.attributes[n];i&&(r&&(e+=r,r=null),e+=i)}}return s(e,i)}}function s(t,e){switch("string"!=typeof t&&(t=String(t)),e){case"LowerCase":return t.toLowerCase();case"Allcaps":return t.toUpperCase();default:return t}}function n(t,e,i,r,s,n,o=!0){const a=e/s,c=i/n,l=Math.ceil(a/2),h=Math.ceil(c/2);for(let u=0;u<n;u++)for(let i=0;i<s;i++){const f=4*(i+(o?n-u-1:u)*s);let d=0,p=0,m=0,y=0,b=0,x=0,_=0;const g=(u+.5)*c;for(let r=Math.floor(u*c);r<(u+1)*c;r++){const s=Math.abs(g-(r+.5))/h,n=(i+.5)*a,o=s*s;for(let c=Math.floor(i*a);c<(i+1)*a;c++){let i=Math.abs(n-(c+.5))/l;const s=Math.sqrt(o+i*i);s>=-1&&s<=1&&(d=2*s*s*s-3*s*s+1,d>0&&(i=4*(c+r*e),_+=d*t[i+3],m+=d,t[i+3]<255&&(d=d*t[i+3]/250),y+=d*t[i],b+=d*t[i+1],x+=d*t[i+2],p+=d))}}r[f]=y/p,r[f+1]=b/p,r[f+2]=x/p,r[f+3]=_/m}}function o(t){return t?{r:t[0],g:t[1],b:t[2],a:t[3]/255}:{r:0,g:0,b:0,a:0}}function a(t){var e;return null==(e=t.data)?void 0:e.symbol}function c(t){return"CIMVectorMarker"===t.type||"CIMPictureMarker"===t.type||"CIMBarChartMarker"===t.type||"CIMCharacterMarker"===t.type||"CIMPieChartMarker"===t.type||"CIMStackedBarChartMarker"===t.type}function l(t){return"CIMGradientStroke"===t.type||"CIMPictureStroke"===t.type||"CIMSolidStroke"===t.type}function h(t){return"CIMGradientFill"===t.type||"CIMHatchFill"===t.type||"CIMPictureFill"===t.type||"CIMSolidFill"===t.type||"CIMWaterFill"===t.type}function u(t){return"CIMMarkerPlacementAlongLineRandomSize"===t.type||"CIMMarkerPlacementAlongLineSameSize"===t.type||"CIMMarkerPlacementAlongLineVariableSize"===t.type||"CIMMarkerPlacementAtExtremities"===t.type||"CIMMarkerPlacementAtMeasuredUnits"===t.type||"CIMMarkerPlacementAtRatioPositions"===t.type||"CIMMarkerPlacementOnLine"===t.type||"CIMMarkerPlacementOnVertices"===t.type}i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return r})),i.d(e,"c",(function(){return o})),i.d(e,"d",(function(){return h})),i.d(e,"e",(function(){return c})),i.d(e,"f",(function(){return u})),i.d(e,"g",(function(){return l})),i.d(e,"h",(function(){return n})),i.d(e,"i",(function(){return a}))},"3de4":function(t,e,i){"use strict";e["a"]=class{constructor(t,e){this._pos=0;const i=e?this._roundToNearest(e,t.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(i),this._buffer=new t(this._array),this._ctor=t}get length(){return this._pos}_roundToNearest(t,e){const i=Math.round(t);return i+(e-i%e)}_ensureSize(t){if(this._pos+t>=this._buffer.length){const e=this._roundToNearest(1.5*(this._array.byteLength+t*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT),i=new ArrayBuffer(e),r=new this._ctor(i);r.set(this._buffer,0),this._array=i,this._buffer=r}}writeF32(t){this._ensureSize(1);const e=this._pos;return new Float32Array(this._array,4*this._pos,1)[0]=t,this._pos++,e}push(t){this._ensureSize(1);const e=this._pos;return this._buffer[this._pos++]=t,e}writeFixed(t){this._buffer[this._pos++]=t}setValue(t,e){this._buffer[t]=e}getValue(t){return this._buffer[t]}incr(t){this._buffer[t]++}decr(t){this._buffer[t]--}writeRegion(t){this._ensureSize(t.length);const e=this._pos;return this._buffer.set(t,this._pos),this._pos+=t.length,e}buffer(){const t=this._array.slice(0,4*this._pos);return this.destroy(),t}toArray(){const t=this._array,e=[];for(let i=0;i<t.byteLength/4;i++)e.push(t[i]);return e}seek(t){this._pos=t}destroy(){this._array=null,this._buffer=null}}},"405c":function(t,e,i){"use strict";i.d(e,"a",(function(){return h})),i.d(e,"b",(function(){return c})),i.d(e,"c",(function(){return o})),i.d(e,"d",(function(){return l}));var r=i("a9ab"),s=i("0eee"),n=i("5f8c");function o(t){if(!t)return null;switch(t.type){case"CIMPointSymbol":{const e=t.symbolLayers;return e&&1===e.length?o(e[0]):null}case"CIMVectorMarker":{const e=t.markerGraphics;if(!e||1!==e.length)return null;const i=e[0];if(!i)return null;const r=i.geometry;if(!r)return null;const s=i.symbol;return!s||"CIMPolygonSymbol"!==s.type&&"CIMLineSymbol"!==s.type?null:{geom:r,asFill:"CIMPolygonSymbol"===s.type}}case"sdf":return{geom:t.geom,asFill:t.asFill}}return null}function a(t){let e=1/0,i=-1/0,r=1/0,s=-1/0;for(const n of t)for(const t of n)t[0]<e&&(e=t[0]),t[0]>i&&(i=t[0]),t[1]<r&&(r=t[1]),t[1]>s&&(s=t[1]);return[e,r,i,s]}function c(t){return t?t.rings?a(t.rings):t.paths?a(t.paths):Object(r["d"])(t)?[t.xmin,t.ymin,t.xmax,t.ymax]:null:null}function l(t,e,i,r,s){const[n,o,a,c]=t;if(a<n||c<o)return[0,0,0];const l=a-n,h=c-o,u=Math.floor(31.5),f=(128-2*(u+1))/Math.max(l,h),d=Math.round(l*f)+2*u,p=Math.round(h*f)+2*u;let m=1;e&&(m=p/f/(e.ymax-e.ymin));let y=0,b=0;if(r)if(s){if(e&&i&&e.ymax-e.ymin>0){const t=(e.xmax-e.xmin)/(e.ymax-e.ymin);y=r.x/(i*t),b=r.y/i}}else y=r.x,b=r.y;return y=.5*(e.xmax+e.xmin)+y*(e.xmax-e.xmin),b=.5*(e.ymax+e.ymin)+b*(e.ymax-e.ymin),y-=n,b-=o,y*=f,b*=f,y+=u,b+=u,[m,y/d-.5,-(b/p-.5)]}function h(t){const e=(i=t.geom)?i.rings?i.rings:i.paths?i.paths:void 0!==i.xmin&&void 0!==i.ymin&&void 0!==i.xmax&&void 0!==i.ymax?[[[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin]]]:null:null;var i;const r=function(t){let e=1/0,i=-1/0,r=1/0,n=-1/0;for(const s of t)for(const t of s)t[0]<e&&(e=t[0]),t[0]>i&&(i=t[0]),t[1]<r&&(r=t[1]),t[1]>n&&(n=t[1]);return new s["a"](e,r,i-e,n-r)}(e),n=Math.floor(31.5),o=(128-2*(n+1))/Math.max(r.width,r.height),a=Math.round(r.width*o)+2*n,c=Math.round(r.height*o)+2*n,l=[];for(const s of e)if(s&&s.length>1){const e=[];for(const t of s){let[i,s]=t;i-=r.x,s-=r.y,i*=o,s*=o,i+=n-.5,s+=n-.5,e.push([i,s])}if(t.asFill){const t=e.length-1;e[0][0]===e[t][0]&&e[0][1]===e[t][1]||e.push(e[0])}l.push(e)}const h=function(t,e,i,r){const s=e*i,n=new Array(s),o=r*r+1;for(let a=0;a<s;++a)n[a]=o;for(const a of t){const t=a.length;for(let s=1;s<t;++s){const t=a[s-1],o=a[s];let c,l,h,u;t[0]<o[0]?(c=t[0],l=o[0]):(c=o[0],l=t[0]),t[1]<o[1]?(h=t[1],u=o[1]):(h=o[1],u=t[1]);let f=Math.floor(c)-r,d=Math.floor(l)+r,p=Math.floor(h)-r,m=Math.floor(u)+r;f<0&&(f=0),d>e&&(d=e),p<0&&(p=0),m>i&&(m=i);const y=o[0]-t[0],b=o[1]-t[1],x=y*y+b*b;for(let r=f;r<d;r++)for(let s=p;s<m;s++){let a,c,l=(r-t[0])*y+(s-t[1])*b;l<0?(a=t[0],c=t[1]):l>x?(a=o[0],c=o[1]):(l/=x,a=t[0]+l*y,c=t[1]+l*b);const h=(r-a)*(r-a)+(s-c)*(s-c),u=(i-s-1)*e+r;h<n[u]&&(n[u]=h)}}}for(let a=0;a<s;++a)n[a]=Math.sqrt(n[a]);return n}(l,a,c,n);return t.asFill&&function(t,e,i,r,s){for(const n of t){const t=n.length;for(let o=1;o<t;++o){const t=n[o-1],a=n[o];let c,l,h,u;t[0]<a[0]?(c=t[0],l=a[0]):(c=a[0],l=t[0]),t[1]<a[1]?(h=t[1],u=a[1]):(h=a[1],u=t[1]);let f=Math.floor(c),d=Math.floor(l)+1,p=Math.floor(h),m=Math.floor(u)+1;f<r&&(f=r),d>e-r&&(d=e-r),p<r&&(p=r),m>i-r&&(m=i-r);for(let n=p;n<m;++n){if(t[1]>n==a[1]>n)continue;const o=(i-n-1)*e;for(let e=f;e<d;++e)e<(a[0]-t[0])*(n-t[1])/(a[1]-t[1])+t[0]&&(s[o+e]=-s[o+e]);for(let t=r;t<f;++t)s[o+t]=-s[o+t]}}}}(l,a,c,n,h),[u(h,n),a,c]}function u(t,e){const i=2*e,r=t.length,s=new Uint8Array(4*r);for(let o=0;o<r;++o){const e=.5-t[o]/i;Object(n["a"])(e,s,4*o)}return s}},"44d1":function(t,e,i){"use strict";var r=i("b2b2"),s=i("a915"),n=i("6655"),o=i("8c81"),a=i("d114"),c=i("1b4a"),l=i("c84e"),h=i("18c6"),u=i("e416");e["a"]=t=>class extends t{constructor(...t){super(...t),this._isCIM=!1,this.geometryType=l["d"].TEXT,this._aux=Object(a["b"])(0,0,this._referenceSize,this._bitset)}bindTextInfo(t,e){t&&t.length?this._shapingInfo=Object(r["a"])(t,t=>Object(c["a"])(t,e,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,Math.min(this._lineWidth,512)),lineHeight:o["n"]*Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM})):this._shapingInfo=null}writeMeshWithGeometry(t,e,i,s,o,a){if(Object(r["h"])(this._textPlacement)){const r=null!=a?a:i.readLegacyGeometry();return this._writePlacedText(t,e,o,r)}const c=a?Object(n["p"])(Object(n["d"])(a),2):"esriGeometryPolygon"===s?i.readCentroid():i.readUnquantizedGeometry();if(c){if(c.isPoint){const[i,r]=c.coords;return this._writeGlyphs(t,e,o,{x:i,y:r})}c.forEachVertex((i,r)=>this._writeGlyphs(t,e,o,{x:i,y:r}))}}_writePlacedText(t,e,i,n){const o=this._shapingInfo;if(Object(r["g"])(o))return;const c=h["e"].load(this._materialKey),l=Object(r["n"])(this._textPlacement),f=u["a"].getPlacement(n,l,Object(s["d"])(1));if(!f)return;let d,p,m=f.next();for(;null!=m;){p=Object(a["a"])(Math.round(8*m.tx),Math.round(8*m.ty)),d=m.getAngle(),o.setRotation(d);for(const r of o.glyphs){c.textureBinding=r.textureBinding;const s=e.getVector("geometry").vertexCount,n=e.indexVector.length,o=this._writeIndices(e),a=this._writeVertex(e,i,p,r);t.writeDisplayRecord(this.geometryType,c.data,s,a,n,o)}o.setRotation(-d),m=f.next()}}_writeGlyphs(t,e,i,s){const n=this._shapingInfo;if(Object(r["g"])(n))return;const o=h["e"].load(this._materialKey),c=Object(a["a"])(Math.round(8*s.x),Math.round(8*s.y));for(const r of n.glyphs){o.textureBinding=r.textureBinding;const s=e.getVector("geometry").vertexCount,n=e.indexVector.length,a=this._writeIndices(e),l=this._writeVertex(e,i,c,r);t.writeDisplayRecord(this.geometryType,o.data,s,l,n,a)}}_writeVertexCommon(t,e,i,r){const s=this._color,n=this._haloColor,o=Object(a["b"])(0,0,this._referenceSize,this._bitset),c=Object(a["b"])(0,0,this._size,this._haloSize);t.push(i),t.push(e),t.push(s),t.push(n),t.push(c),t.push(o)}_writeVertex(t,e,i,r){const s=t.get("geometry");return this._writeVertexCommon(s,e,i,r),s.push(r.offsets.upperLeft),s.push(r.texcoords.upperLeft),this._writeVertexCommon(s,e,i,r),s.push(r.offsets.upperRight),s.push(r.texcoords.upperRight),this._writeVertexCommon(s,e,i,r),s.push(r.offsets.lowerLeft),s.push(r.texcoords.lowerLeft),this._writeVertexCommon(s,e,i,r),s.push(r.offsets.lowerRight),s.push(r.texcoords.lowerRight),4}_writeIndices(t){const e=t.getVector("geometry").vertexCount,i=t.indexVector;return i.push(e+0),i.push(e+1),i.push(e+2),i.push(e+1),i.push(e+3),i.push(e+2),6}}},"4fcb":function(t,e,i){"use strict";i.d(e,"a",(function(){return A})),i.d(e,"b",(function(){return g}));var r=i("b3b6"),s=i("e92d"),n=i("f4cc"),o=i("82fa"),a=i("9ef0"),c=i("a915"),l=i("36b8"),h=i("89cb"),u=i("793f"),f=i("405c");const d=s["a"].getLogger("esri.symbols.cim.cimAnalyzer");function p(t){switch(t){case"Butt":return 0;case"Square":return 2;case"Round":default:return 1}}function m(t){switch(t){case"Bevel":return 0;case"Miter":return 2;case"Round":default:return 1}}function y(t){switch(t){case"Left":default:return"left";case"Right":return"right";case"Center":return"center";case"Justify":return"justify"}}function b(t){switch(t){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function x(t,e,i,r){let s;t[e]?s=t[e]:(s={},t[e]=s),s[i]=r}function _(t){const e=t.markerPlacement;return e&&e.angleToLine?1:0}async function g(t,e,i,r){const s=i||[];if(!t)return s;let a,c;const l={};if("CIMSymbolReference"!==t.type)return d.error("Expect cim type to be 'CIMSymbolReference'"),s;if(a=t.symbol,c=t.primitiveOverrides,c){const t=[];for(const i of c){const r=i.valueExpressionInfo;if(r&&e){const s=r.expression,n=Object(o["d"])(s,e.spatialReference,e.fields).then(t=>{t&&x(l,i.primitiveName,i.propertyName,t)});t.push(n)}else null!=i.value&&x(l,i.primitiveName,i.propertyName,i.value)}await Object(n["b"])(t)}switch(a.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":!function(t,e,i,r,s,n){if(!t)return;const o=t.symbolLayers;if(!o)return;let a;const c=u["a"].getSize(t);"CIMPointSymbol"===t.type&&"Map"===t.angleAlignment&&(a=1);let l=o.length;for(;l--;){const h=o[l];if(!h||!1===h.enable)continue;const f=[];switch(u["b"].findApplicableOverrides(h,e,f),h.type){case"CIMSolidFill":O(h,i,f,r,s);break;case"CIMPictureFill":v(h,i,f,r,s);break;case"CIMHatchFill":M(h,i,f,r,s);break;case"CIMGradientFill":j(h,i,f,r,s);break;case"CIMSolidStroke":w(h,i,f,r,s,"CIMPolygonSymbol"===t.type,c);break;case"CIMPictureStroke":S(h,i,f,r,s,"CIMPolygonSymbol"===t.type,c);break;case"CIMGradientStroke":C(h,i,f,r,s,"CIMPolygonSymbol"===t.type,c);break;case"CIMCharacterMarker":if(I(h,i,f,r,s))break;break;case"CIMPictureMarker":if(I(h,i,f,r,s))break;"CIMLineSymbol"===t.type&&(a=_(h)),L(h,i,f,r,s,a,c);break;case"CIMVectorMarker":if(I(h,i,f,r,s))break;"CIMLineSymbol"===t.type&&(a=_(h)),z(h,i,f,r,s,a,c,n);break;default:d.error("Cannot analyze CIM layer",h.type)}}}(a,c,l,e,s,r)}return s}function O(t,e,i,s,n){const o=t.primitiveName,a=Object(l["c"])(t.color),c=Object(r["b"])(JSON.stringify(t)).toString();n.push({type:"fill",templateHash:c,materialHash:0===i.length?c:()=>c,cim:t,materialOverrides:null,colorLocked:t.colorLocked,color:D(o,e,"Color",s,a,V),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:t.effects})}function v(t,e,i,s,n){const o=t.primitiveName,a=t.tintColor?Object(l["c"])(t.tintColor):{r:255,g:255,b:255,a:1},c=Object(r["b"])(JSON.stringify(t)).toString(),h=Object(r["b"])(`${t.url}${JSON.stringify(t.colorSubstitutions)}`).toString();n.push({type:"fill",templateHash:c,materialHash:0===i.length?h:()=>h,cim:t,materialOverrides:null,colorLocked:t.colorLocked,effects:t.effects,color:D(o,e,"TintColor",s,a,V),height:D(o,e,"Height",s,t.height),scaleX:D(o,e,"ScaleX",s,t.scaleX),angle:D(o,e,"Rotation",s,t.rotation),offsetX:D(o,e,"OffsetX",s,t.offsetX),offsetY:D(o,e,"OffsetY",s,t.offsetY)})}function M(t,e,i,s,n){const o=["Rotation","OffsetX","OffsetY"],a=i.filter(e=>e.primitiveName!==t.primitiveName&&-1===o.indexOf(e.propertyName)),c=t.primitiveName,l=Object(r["b"])(JSON.stringify(t)).toString(),h=Object(r["b"])(`${t.separation}${JSON.stringify(t.lineSymbol)}`).toString();n.push({type:"fill",templateHash:l,materialHash:0===i.length?h:F(h,e,a,s),cim:t,materialOverrides:a,colorLocked:t.colorLocked,effects:t.effects,color:{r:255,g:255,b:255,a:1},height:D(c,e,"Separation",s,t.separation),scaleX:1,angle:D(c,e,"Rotation",s,t.rotation),offsetX:D(c,e,"OffsetX",s,t.offsetX),offsetY:D(c,e,"OffsetY",s,t.offsetY)})}function j(t,e,i,s,n){const o=Object(r["b"])(JSON.stringify(t)).toString();n.push({type:"fill",templateHash:o,materialHash:0===i.length?o:F(o,e,i,s),cim:t,materialOverrides:null,colorLocked:t.colorLocked,effects:t.effects,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1})}function w(t,e,i,s,n,o,a){const c=Object(r["b"])(JSON.stringify(t)).toString(),h=t.primitiveName,u=Object(l["c"])(t.color),f=void 0!==t.width?t.width:4,d=p(t.capStyle),y=m(t.joinStyle),b=t.miterLimit;n.push({type:"line",templateHash:c,materialHash:0===i.length?c:()=>c,cim:t,materialOverrides:null,isOutline:o,colorLocked:t.colorLocked,effects:t.effects,color:D(h,e,"Color",s,u,V),width:D(h,e,"Width",s,f),cap:D(h,e,"CapStyle",s,d),join:D(h,e,"JoinStyle",s,y),miterLimit:D(h,e,"MiterLimit",s,b),referenceWidth:a,zOrder:R(t.name),isDashed:!1})}function S(t,e,i,s,n,o,a){const c=Object(r["b"])(`${t.url}${JSON.stringify(t.colorSubstitutions)}`).toString(),h=t.primitiveName,u=Object(l["c"])(t.tintColor),f=void 0!==t.width?t.width:4,d=p(t.capStyle),y=m(t.joinStyle),b=t.miterLimit,x=Object(r["b"])(JSON.stringify(t)).toString();n.push({type:"line",templateHash:x,materialHash:0===i.length?c:()=>c,cim:t,materialOverrides:null,isOutline:o,colorLocked:t.colorLocked,effects:t.effects,color:D(h,e,"TintColor",s,u,V),width:D(h,e,"Width",s,f),cap:D(h,e,"CapStyle",s,d),join:D(h,e,"JoinStyle",s,y),miterLimit:D(h,e,"MiterLimit",s,b),referenceWidth:a,zOrder:R(t.name),isDashed:!1})}function C(t,e,i,s,n,o,a){const c=t.primitiveName,l=void 0!==t.width?t.width:4,h=p(t.capStyle),u=m(t.joinStyle),f=t.miterLimit,d=Object(r["b"])(JSON.stringify(t)).toString();n.push({type:"line",templateHash:d,materialHash:0===i.length?d:F(d,e,i,s),cim:t,materialOverrides:null,isOutline:o,colorLocked:t.colorLocked,effects:t.effects,color:{r:128,g:128,b:128,a:1},width:D(c,e,"Width",s,l),cap:D(c,e,"CapStyle",s,h),join:D(c,e,"JoinStyle",s,u),miterLimit:D(c,e,"MiterLimit",s,f),referenceWidth:a,zOrder:R(t.name),isDashed:!1})}function I(t,e,i,s,n){const o=t.markerPlacement;if(!o||"CIMMarkerPlacementInsidePolygon"!==o.type)return!1;const a=o,c=["Rotation","OffsetX","OffsetY"],l=i.filter(e=>e.primitiveName!==t.primitiveName&&-1===c.indexOf(e.propertyName)),h=Object(r["b"])(JSON.stringify(t)).toString();return n.push({type:"fill",templateHash:h,materialHash:0===i.length?h:F(h,e,l,s),cim:t,materialOverrides:l,colorLocked:t.colorLocked,effects:t.effects,color:{r:255,g:255,b:255,a:1},height:D(a.primitiveName,e,"StepY",s,a.stepY),scaleX:1,angle:D(a.primitiveName,e,"GridAngle",s,a.gridAngle),offsetX:D(a.primitiveName,e,"OffsetX",s,a.offsetX),offsetY:D(a.primitiveName,e,"OffsetY",s,a.offsetY)}),!0}function L(t,e,i,s,n,o,a){const c=t.primitiveName,h=t.size,u=t.scaleX,f=t.rotation,d=t.offsetX,p=t.offsetY,m=Object(l["c"])(t.tintColor),y=Object(r["b"])(`${t.url}${JSON.stringify(t.colorSubstitutions)}`).toString();let b=!1,x="";for(const r of i)r.primitiveName===c&&(void 0!==r.value?x+=`-${r.primitiveName}-${r.propertyName}-${JSON.stringify(r.value)}`:r.valueExpressionInfo&&(b=!0));n.push({type:"marker",templateHash:Object(r["b"])(JSON.stringify(t)+x).toString(),materialHash:b?()=>y:y,cim:t,materialOverrides:null,colorLocked:t.colorLocked,effects:t.effects,scaleSymbolsProportionally:!1,alignment:o,size:D(c,e,"Size",s,h),scaleX:D(c,e,"ScaleX",s,u),rotation:D(c,e,"Rotation",s,f),offsetX:D(c,e,"OffsetX",s,d),offsetY:D(c,e,"OffsetY",s,p),color:D(c,e,"TintColor",s,m,V),anchorPoint:t.anchorPoint,isAbsoluteAnchorPoint:"Relative"!==t.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:t.rotateClockwise,referenceSize:a,sizeRatio:1,markerPlacement:t.markerPlacement})}function z(t,e,i,r,s,n,o,a){const c=t.markerGraphics;if(!c)return;let l=0;if(t.scaleSymbolsProportionally){const e=t.frame;e&&(l=e.ymax-e.ymin)}for(const h of c)if(h){const c=h.symbol;if(!c)continue;switch(c.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":P(t,h,i,e,r,s,n,o,l,a);break;case"CIMTextSymbol":T(t,h,e,i,r,s,n,o,l)}}}function T(t,e,i,s,n,o,a,c,h){u["b"].findApplicableOverrides(e,s,[]);const f=e.geometry;if(!("x"in f)||!("y"in f))return;const d=e.symbol,p=(m=d).underline?"underline":m.strikethrough?"line-through":"none";var m;const x=function(t){let e="normal",i="normal";if(t){const r=t.toLowerCase();-1!==r.indexOf("italic")?e="italic":-1!==r.indexOf("oblique")&&(e="oblique"),-1!==r.indexOf("bold")?i="bold":-1!==r.indexOf("light")&&(i="lighter")}return{style:e,weight:i}}(d.fontStyleName);d.font={family:d.fontFamilyName,decoration:p,...x};const _=t.frame,g=f.x-.5*(_.xmin+_.xmax),O=f.y-.5*(_.ymin+_.ymax),v=t.size/h,M=t.primitiveName,j=(d.height||0)*v,w=d.angle||0,S=((d.offsetX||0)+g)*v,C=((d.offsetY||0)+O)*v,I=Object(l["c"])(u["a"].getFillColor(d));let L=Object(l["c"])(u["a"].getStrokeColor(d)),z=u["a"].getStrokeWidth(d);z||(L=Object(l["c"])(u["a"].getFillColor(d.haloSymbol)),z=d.haloSize*v);let T="";for(const r of s)r.primitiveName===M&&void 0!==r.value&&(T+=`-${r.primitiveName}-${r.propertyName}-${JSON.stringify(r.value)}`);const P=JSON.stringify(t.effects)+Number(t.colorLocked)+JSON.stringify(t.anchorPoint)+t.anchorPointUnits+JSON.stringify(t.markerPlacement),k=Object(r["b"])(JSON.stringify(e)+P+T).toString();o.push({type:"text",templateHash:k,materialHash:()=>Object(r["b"])(JSON.stringify(d.font)).toString(),cim:d,materialOverrides:null,colorLocked:t.colorLocked,effects:t.effects,alignment:a,anchorPoint:{x:t.anchorPoint?t.anchorPoint.x:0,y:t.anchorPoint?t.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==t.anchorPointUnits,fontName:d.fontFamilyName,decoration:"none",weight:"normal",style:"normal",size:D(M,i,"Size",n,j),angle:D(M,i,"Rotation",n,w),offsetX:D(M,i,"OffsetX",n,S),offsetY:D(M,i,"OffsetY",n,C),horizontalAlignment:y(d.horizontalAlignment),verticalAlignment:b(d.verticalAlignment),text:D(e.primitiveName,i,"TextString",n,e.textString,l["a"],d.textCase),color:I,outlineColor:L,outlineSize:z,referenceSize:c,sizeRatio:1,markerPlacement:t.markerPlacement})}function P(t,e,i,s,n,o,a,c,h,d){const p=e.symbol,m=e.geometry;if(!m)return;const y=p.symbolLayers;if(!y)return;if(d)return void k(t,e,s,i,n,o,a,c,h);let b=y.length;for(;b--;){const d=y[b];if(d&&!1!==d.enable)switch(d.type){case"CIMSolidFill":case"CIMSolidStroke":{const p=Object(f["b"])(m);if(!p)continue;const[y,b,x]=Object(f["d"])(p,t.frame,t.size,t.anchorPoint,"Relative"!==t.anchorPointUnits),_="CIMSolidFill"===d.type,g={type:"sdf",geom:m,asFill:_},O=t.primitiveName,v=t.size,M=t.rotation||0,j=t.offsetX,w=t.offsetY,S=d.primitiveName,C=Object(l["c"])(_?u["a"].getFillColor(d):u["a"].getStrokeColor(d)),I=_?{r:0,g:0,b:0,a:0}:Object(l["c"])(u["a"].getStrokeColor(d)),L=u["a"].getStrokeWidth(d);if(!_&&!L)break;let z=!1,T="";for(const t of i)t.primitiveName!==S&&t.primitiveName!==O||(void 0!==t.value?T+=`-${t.primitiveName}-${t.propertyName}-${JSON.stringify(t.value)}`:t.valueExpressionInfo&&(z=!0));const P=JSON.stringify({...t,markerGraphics:null}),k=Object(r["b"])(JSON.stringify(g)).toString(),R={type:"marker",templateHash:Object(r["b"])(JSON.stringify(e)+JSON.stringify(d)+P+T).toString(),materialHash:z?()=>k:k,cim:g,materialOverrides:null,colorLocked:t.colorLocked,effects:t.effects,scaleSymbolsProportionally:t.scaleSymbolsProportionally,alignment:a,anchorPoint:{x:b,y:x},isAbsoluteAnchorPoint:!1,size:D(t.primitiveName,s,"Size",n,v),rotation:D(t.primitiveName,s,"Rotation",n,M),offsetX:D(t.primitiveName,s,"OffsetX",n,j),offsetY:D(t.primitiveName,s,"OffsetY",n,w),scaleX:1,frameHeight:h,rotateClockwise:t.rotateClockwise,referenceSize:c,sizeRatio:y,color:D(S,s,"Color",n,C,V),outlineColor:D(S,s,"Color",n,I,V),outlineWidth:D(S,s,"Width",n,L),markerPlacement:t.markerPlacement};o.push(R);break}default:k(t,e,s,i,n,o,a,c,h)}}}function k(t,e,i,s,n,o,a,l,h){const f=function(t,e){return{type:t.type,enable:!0,name:t.name,colorLocked:t.colorLocked,primitiveName:t.primitiveName,anchorPoint:t.anchorPoint,anchorPointUnits:t.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:t.rotateClockwise,rotation:0,size:t.size,billboardMode3D:t.billboardMode3D,depth3D:t.depth3D,frame:t.frame,markerGraphics:[e],scaleSymbolsProportionally:t.scaleSymbolsProportionally,respectFrame:t.respectFrame,clippingPath:t.clippingPath,effects:t.effects}}(t,e);let d=[];const p=["Rotation","OffsetX","OffsetY"];d=s.filter(e=>e.primitiveName!==t.primitiveName||-1===p.indexOf(e.propertyName));let m="";for(const r of s)void 0!==r.value&&(m+=`-${r.primitiveName}-${r.propertyName}-${JSON.stringify(r.value)}`);const[y,b,x]=u["a"].getTextureAnchor(f),_=t.primitiveName,g=t.rotation||0,O=t.offsetX||0,v=t.offsetY||0,M=Object(r["b"])(JSON.stringify(f)+m).toString(),j={type:"marker",templateHash:M,materialHash:0===d.length?M:F(M,i,d,n),cim:f,materialOverrides:d,colorLocked:t.colorLocked,effects:t.effects,scaleSymbolsProportionally:t.scaleSymbolsProportionally,alignment:a,anchorPoint:{x:y,y:b},isAbsoluteAnchorPoint:!1,size:t.size,rotation:D(_,i,"Rotation",n,g),offsetX:D(_,i,"OffsetX",n,O),offsetY:D(_,i,"OffsetY",n,v),color:{r:0,g:0,b:0,a:0},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:h,rotateClockwise:t.rotateClockwise,referenceSize:l,sizeRatio:x/Object(c["d"])(t.size),markerPlacement:t.markerPlacement};o.push(j)}function R(t){if(t&&0===t.indexOf("Level_")){const e=parseInt(t.substr(6),10);if(NaN!==e)return e}return 0}function V(t){if(!t||0===t.length)return null;const e=new a["a"](t).toRgba();return{r:e[0],g:e[1],b:e[2],a:e[3]}}function D(t,e,i,r,s,n,a){const c=e[t];if(c){const t=c[i];if("string"==typeof t||"number"==typeof t||t instanceof Array)return n?n.call(null,t,a):t;if(null!=t&&t instanceof o["a"])return(e,i,o)=>{let c=Object(h["a"])(t,e,{$view:o},r.geometryType,i);return null!==c&&n&&(c=n.call(null,c,a)),null!==c?c:s}}return s}function F(t,e,i,s){for(const r of i)if(r.valueExpressionInfo){const t=e[r.primitiveName]&&e[r.primitiveName][r.propertyName];t instanceof o["a"]&&(r.fn=(e,i,r)=>Object(h["a"])(t,e,{$view:r},s.geometryType,i))}return(e,s,n)=>{for(const t of i)t.fn&&(t.value=t.fn(e,s,n));return Object(r["b"])(t+u["b"].buildOverrideKey(i)).toString()}}function A(t,e){if(!e||0===e.length)return t;const i=JSON.parse(JSON.stringify(t));return u["b"].applyOverrides(i,e),i}},"641c":function(t,e,i){"use strict";var r=i("a292"),s=i("c275"),n=i("34c7");class o{constructor(t){this.insertAfter=null,this.id=t,this.displayRecords=[],this.metrics=[]}copy(){const t=new o(this.id);return t.set(this),t}clone(){const t=new o(this.id);return t.displayRecords=this.displayRecords.map(t=>t.clone()),t.metrics=this.metrics.map(t=>t.clone()),t.insertAfter=this.insertAfter,t}set(t){this.id=t.id,this.displayRecords=t.displayRecords,this.metrics=t.metrics,this.insertAfter=t.insertAfter}serialize(t){return t.push(this.id),Object(s["b"])(t,this.metrics),Object(s["b"])(t,this.displayRecords),t}static deserialize(t){const e=t.readInt32(),i=new o(e),a={id:e},c=Object(s["a"])(t,n["a"]);return c.length&&(i.metrics=c),i.displayRecords=Object(s["a"])(t,r["a"],a),i}}e["a"]=o},"671a":function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));i("f4cc");var r=i("ddc2"),s=(i("9cd4"),i("4fcb")),n=i("c84e"),o=i("18c6");const a={marker:n["d"].MARKER,fill:n["d"].FILL,line:n["d"].LINE,text:n["d"].TEXT};class c{constructor(t,e,i){this.layers=t,this.data=e,this.hash=this._createHash(),this.rendererKey=i;for(const r of t){const t=a[r.type];r.materialKey=Object(o["g"])(t,this.rendererKey,!1,!1)}}get type(){return"expanded-cim"}_createHash(){let t="";for(const e of this.layers)t+=e.templateHash;return t}}const l=async(t,e)=>new c(await Object(s["b"])(t.data,e),t.data,t.rendererKey),h=async(t,e,i)=>{if(!t)return null;if("cim"===t.type)return l(t,e);if("web-style"===t.type){const s=r["a"].fromJSON(t),n={type:"cim",data:(await s.fetchCIMSymbol(i)).data,rendererKey:t.rendererKey};return l(n,e)}return t}},"69c3":function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var r=i("a292"),s=i("c275"),n=i("34c7"),o=i("641c"),a=class{constructor(t){this._pos=0,this._buffer=t,this._i32View=new Int32Array(this._buffer),this._f32View=new Float32Array(this._buffer)}readInt32(){return this._i32View[this._pos++]}readF32(){return this._f32View[this._pos++]}},c=i("3de4");class l{constructor(t,e){this.vertexVectorsMap=t,this._currentIndex=-1,this._currentRecordOffset=0,this._currentMetricOffset=0,this._currentMetrics=[];const i=4*(4*e.features+1),r=4*(8*e.records+1),s=4*(20*e.metrics+1);this._bufDisplayObjects=new c["a"](Uint32Array,i+4),this._bufDisplayRecords=new c["a"](Uint32Array,r+4),this._bufMetrics=new c["a"](Uint32Array,s+4),this._bufDisplayObjects.push(0),this._bufDisplayRecords.push(0),this._bufMetrics.push(0)}get vertexBuffersMap(){if(!this._vertexBuffersMap){this._vertexBuffersMap={};for(let t=0;t<this.vertexVectorsMap.length;t++)this._vertexBuffersMap[t]=this.vertexVectorsMap[t].intoBuffers();this.vertexVectorsMap=null}return this._vertexBuffersMap}get(t){return this.vertexVectorsMap[t]}currentDisplayRecordCount(){return this._bufDisplayRecords[this._currentRecordOffset]}writeDisplayObject(t,e){this._bufDisplayObjects.incr(0),this._currentIndex=this._bufDisplayObjects.push(t),this._bufDisplayObjects.push(e),this._bufDisplayObjects.push(0),this._bufDisplayObjects.push(0),this._currentRecordOffset=0,this._currentMetricOffset=0,this._currentMetrics=[]}hasDisplayRecords(){return!(0===this._currentRecordOffset)}endDisplayObject(){this.hasDisplayRecords()?this._currentMetrics&&(0===this._currentMetricOffset&&(this._bufDisplayObjects.setValue(this._currentIndex+3,this._bufMetrics.length),this._currentMetricOffset=this._bufMetrics.length),Object(s["b"])(this._bufMetrics,this._currentMetrics)):this._rollbackDisplayObject()}writeDisplayRecord(t,e,i,r,s,n,o=0,a=0){0===this._currentRecordOffset&&(this._currentRecordOffset=this._bufDisplayRecords.push(0),this._bufDisplayObjects.setValue(this._currentIndex+2,this._currentRecordOffset)),this._bufDisplayRecords.incr(this._currentRecordOffset),this._bufDisplayRecords.push(t),this._bufDisplayRecords.push(e),this._bufDisplayRecords.push(i),this._bufDisplayRecords.push(r),this._bufDisplayRecords.push(s),this._bufDisplayRecords.push(n),this._bufDisplayRecords.push(o),this._bufDisplayRecords.push(a)}writeMetrics(t){t&&this._currentMetrics.push(...t)}static deserializeDisplayObjects(t){const{bufDisplayObjects:e,bufMetrics:i,bufRecords:c}=t,l=new a(e),h=new a(c),u=new a(i),f=[];let d=l.readInt32();for(h.readInt32(),u.readInt32();d--;){const t=l.readInt32(),e=l.readInt32(),i=l.readInt32(),a=l.readInt32(),c=new o["a"](t);0!==e&&(c.insertAfter=e),0!==i&&(c.displayRecords=Object(s["a"])(h,r["a"],{id:t})),0!==a&&(c.metrics=Object(s["a"])(u,n["a"])),f.push(c)}return f}encode(t,e){const i={};for(let r=0;r<this.vertexVectorsMap.length;r++){const t=this.vertexVectorsMap[r];i[r]={},t.transfer(i[r],e)}t.bufDisplayObjects=this._bufDisplayObjects.buffer(),t.bufRecords=this._bufDisplayRecords.buffer(),t.bufMetrics=this._bufMetrics.buffer(),e.push(t.bufDisplayObjects),e.push(t.bufMetrics),e.push(t.bufRecords),t.vertexBuffersMap=i,this.destroy()}destroy(){this.vertexVectorsMap=null,this._bufDisplayObjects=null,this._bufDisplayRecords=null,this._bufMetrics=null}_rollbackDisplayObject(){this._bufDisplayObjects.decr(0),this._bufDisplayObjects.seek(this._bufDisplayObjects.length-4),this._currentIndex=this._bufDisplayObjects.length}}},"89cb":function(t,e,i){"use strict";var r=i("e92d"),s=i("ce50"),n=i("008c");function o(t,e,i,o,c){const l=t.referencesGeometry()&&c?function(t,e,i){const{transform:o,hasZ:c,hasM:l}=i;a.has(e)||a.set(e,function(t){const e={};switch(t){case"esriGeometryPoint":return(t,i,r,s)=>Object(n["e"])(i,e,t,r,s);case"esriGeometryPolygon":return(t,i,r,s)=>Object(n["f"])(i,e,t,r,s);case"esriGeometryPolyline":return(t,i,r,s)=>Object(n["g"])(i,e,t,r,s);case"esriGeometryMultipoint":return(t,i,r,s)=>Object(n["d"])(i,e,t,r,s);default:return r["a"].getLogger("esri.views.2d.support.arcadeOnDemand").error(new s["a"]("mapview-arcade","Unable to handle geometryType: "+t)),t=>t}}(e));const h=a.get(e)(t.geometry,o,c,l);return{...t,geometry:h}}(e,o,c):e,h=t.repurposeFeature(l);try{return t.evaluate({...i,$feature:h})}catch(u){return r["a"].getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",u),null}}const a=new Map;e["a"]=o},"89e8":function(t,e,i){"use strict";var r=i("a915"),s=i("32dd"),n=i("b7b9"),o=i("18c6"),a=i("a9a2"),c=i("44d1"),l=i("f75e");class h extends(Object(c["a"])(l["a"])){constructor(t,e,i,n,a,c,l,h,u,f,d,p,m,y,b,x,_,g=!1){super(),this._xOffset=Object(r["d"])(p),this._yOffset=Object(r["d"])(m),this._decoration=u||"none",this._color=n,this._haloColor=a,this._haloSize=Math.min(Math.floor(5*Object(r["d"])(Object(r["f"])(i))),127),this._size=Math.min(Math.round(Object(r["d"])(e)),127);const O=Math.min(Math.round(Object(r["d"])(e)),127);this._referenceSize=Math.round(Math.sqrt(256*O)),this._scale=this._size/24,this._angle=d,this._justify=Object(s["c"])(c||"center"),this._xAlignD=Object(s["d"])(c||"center"),this._yAlignD=Object(s["f"])(l||"baseline"),this._baseline="baseline"===(l||"baseline"),this._bitset=(1===h?1:0)|(f?1:0)<<1;const v=o["e"].load(t);v.sdf=!0,this._materialKey=v.data,this._lineWidth=Object(r["d"])(y)||512,this._lineHeight=b||1,this._textPlacement=x,this.effects=_,this._isCIM=g}static fromText(t,e){const i=new h(t.materialKey,t.font.size,t.haloSize||0,t.color&&Object(a["d"])(t.color)||0,t.haloColor&&Object(a["d"])(t.haloColor)||0,t.horizontalAlignment,t.verticalAlignment,0,t.font.decoration,!1,t.angle||0,t.xoffset,t.yoffset,t.lineWidth,t.lineHeight,null,null,!1),[,r]=Object(n["a"])(t.text);return i.bindTextInfo(e,r),i}static fromCIMText(t,e){const i=t.scaleFactor||1,r=new h(t.materialKey,t.size*t.sizeRatio*i,t.outlineSize*t.sizeRatio,Object(a["c"])(t.color),Object(a["c"])(t.outlineColor),t.horizontalAlignment,t.verticalAlignment,t.alignment,t.decoration,t.colorLocked,t.angle,t.offsetX*t.sizeRatio*i,t.offsetY*t.sizeRatio*i,512,1,t.markerPlacement,t.effects,!0),[,s]=Object(n["a"])(t.text);return r.bindTextInfo(e,s),r}}e["a"]=h},"9b77":function(t,e,i){"use strict";function r(t){switch(t){case"above-along":case"below-along":case"center-along":return 1;default:return 0}}i.d(e,"a",(function(){return r}))},a292:function(t,e,i){"use strict";var r=i("c8dd"),s=class{constructor(){this.vertexData=new Map,this.vertexCount=0,this.indexData=[]}clear(){this.vertexData.clear(),this.vertexCount=0,this.indexData=[]}update(t,e,i){for(const r in t)this.vertexData.set(r,t[r]);for(const r in this.vertexData)null===t[r]&&this.vertexData.delete(r);this.vertexCount=e,this.indexData=i}};class n{constructor(t,e,i,r=0,s=0){this.id=t,this.geometryType=e,this.materialKey=i,this.minZoom=r,this.maxZoom=s,this.meshData=null,this.symbolLevel=0,this.zOrder=0,this.vertexFrom=0,this.vertexCount=0,this.indexFrom=0,this.indexCount=0}get sortKey(){return void 0===this._sortKey&&this._computeSortKey(),this._sortKey}clone(){return this.copy()}copy(){const t=new n(this.id,this.geometryType,this.materialKey);return t.vertexFrom=this.vertexFrom,t.vertexCount=this.vertexCount,t.indexFrom=this.indexFrom,t.indexCount=this.indexCount,t.zOrder=this.zOrder,t.symbolLevel=this.symbolLevel,t.meshData=this.meshData,t.minZoom=this.minZoom,t.maxZoom=this.maxZoom,t}setMeshDataFromBuffers(t,e,i){const n=new s;for(const s in e){const i=e[s].stride,o=e[s].data,a=[],c=Object(r["o"])(i);for(let e=0;e<i*t.vertexCount/c;++e)a[e]=o[e+i*t.vertexFrom/c];n.vertexData.set(s,a)}n.indexData.length=0;for(let r=0;r<t.indexCount;++r)n.indexData[r]=i[r+t.indexFrom]-t.vertexFrom;n.vertexCount=t.vertexCount,this.meshData=n}readMeshDataFromBuffers(t,e){this.meshData?this.meshData.clear():this.meshData=new s;for(const i in t){const e=t[i].stride,s=t[i].data,n=[],o=Object(r["o"])(e);for(let t=0;t<e*this.vertexCount/o;++t)n[t]=s[t+e*this.vertexFrom/o];this.meshData.vertexData.set(i,n)}this.meshData.indexData.length=0;for(let i=0;i<this.indexCount;++i)this.meshData.indexData[i]=e[i+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount}writeMeshDataToBuffers(t,e,i,s){for(const n in e){const i=e[n].stride,s=this.meshData.vertexData.get(n),o=e[n].data,a=Object(r["o"])(i);for(let e=0;e<i*this.meshData.vertexCount/a;++e)o[e+i*t/a]=s[e]}for(let r=0;r<this.meshData.indexData.length;++r)s[r+i]=this.meshData.indexData[r]+t;this.vertexFrom=t,this.vertexCount=this.meshData.vertexCount,this.indexFrom=i,this.indexCount=this.meshData.indexData.length}static writeAllMeshDataToBuffers(t,e,i){let r=0,s=0;for(const n of t)n.writeMeshDataToBuffers(r,e,s,i),r+=n.vertexCount,s+=n.indexCount}_computeSortKey(){this._sortKey=(31&this.symbolLevel)<<12|(127&this.zOrder)<<4|7&this.geometryType}serialize(t){return t.push(this.geometryType),t.push(this.materialKey),t.push(this.vertexFrom),t.push(this.vertexCount),t.push(this.indexFrom),t.push(this.indexCount),t.push(this.minZoom),t.push(this.maxZoom),t}static deserialize(t,e){const i=t.readInt32(),r=t.readInt32(),s=new n(e.id,i,r);return s.vertexFrom=t.readInt32(),s.vertexCount=t.readInt32(),s.indexFrom=t.readInt32(),s.indexCount=t.readInt32(),s.minZoom=t.readInt32(),s.maxZoom=t.readInt32(),s}}e["a"]=n},a8b5:function(t,e,i){"use strict";var r=i("b2b2"),s=i("a915"),n=i("8c81"),o=i("2c63"),a=i("738e"),c=i("d114"),l=i("18c6"),h=i("a9a2"),u=i("f75e"),f=i("f93c");class d extends(Object(f["a"])(u["a"])){constructor(t,e,i,r,s,h,u,f,d,p,m,y,b,x,_,g,O,v,M,j,w){super(),this.angle=r,this.height=u,this.width=h,this.xOffset=e*M,this.yOffset=i*M,this._markerPlacement=j,this.effects=w,this._anchorX=.5-(.5+g)*_.width/_.width,this._anchorY=.5-(.5+O)*_.height/_.height;const S=(1===x?1:0)|(m?1:0)<<1|(b?1:0)<<2|(y?1:0)<<3,C=_&&_.sdf,I=l["d"].load(t);I.sdf=C,I.pattern=!0,I.textureBinding=_.textureBinding,this._materialKey=I.data,this._fillColor=s,this._outlineColor=d,this._sizeOutlineWidth=Object(c["b"])(Math.round(Math.min(Math.sqrt(128*h),255)),Math.round(Math.min(Math.sqrt(128*u),255)),Math.round(Math.min(Math.sqrt(128*p),255)),Math.round(Math.min(Math.sqrt(128*f),255)));const L=_.rect.x+n["r"],z=_.rect.y+n["r"],T=L+_.width,P=z+_.height;this._texUpperLeft=Object(c["a"])(L,z),this._texUpperRight=Object(c["a"])(T,z),this._texBottomLeft=Object(c["a"])(L,P),this._texBottomRight=Object(c["a"])(T,P),h*=v,u*=v,h*=M,u*=M;const k=Math.round(Math.min(64*v,255));this._bitestAndDistRatio=Object(c["b"])(0,0,S,k),this._computedWidth=h,this._computedHeight=u;const R=Object(a["a"])(),V=Object(o["a"])();this._applyTransformation(V,R)}static fromCIMMarker(t,e){const i=e&&e.width||1,n=e&&e.height||1,o=t.size,a=i/n*t.scaleX,c=t.scaleSymbolsProportionally&&t.frameHeight?o/t.frameHeight:1,l=Object(h["c"])(t.color),u=Object(h["c"])(t.outlineColor),f=Object(s["d"])(o),p=f*a,m=Object(s["d"])(t.offsetX||0),y=Object(s["d"])(t.offsetY||0),b=Object(s["d"])(t.outlineWidth||0)*c,x=t.alignment||0,_=Object(s["d"])(t.referenceSize);let g=t.rotation||0;t.rotateClockwise||(g=-g);let O=0,v=0;const M=t.anchorPoint;return M&&(t.isAbsoluteAnchorPoint?o&&(O=-M.x/(o*a),v=M.y/o):(O=M.x,v=M.y)),new d(t.materialKey,m,y,g,l,p,f,_,u,b,t.colorLocked,t.scaleSymbolsProportionally,!1,x,e,O,v,t.sizeRatio,Object(r["o"])(t.scaleFactor,1),t.markerPlacement,t.effects)}static fromPictureMarker(t,e){const i=Math.round(Object(s["d"])(t.width)),r=Math.round(Object(s["d"])(t.height)),o=n["q"],a=Math.round(Object(s["d"])(t.xoffset||0)),c=Math.round(Object(s["d"])(t.yoffset||0));return new d(t.materialKey,a,c,t.angle,o,i,r,r,0,0,!1,!1,!1,0,e,0,0,1,1,null,null)}static fromSimpleMarker(t,e){const i=Object(h["d"])(t.color),r=Math.round(Object(s["d"])(t.size)),n=r,o=Math.round(Object(s["d"])(t.xoffset||0)),a=Math.round(Object(s["d"])(t.yoffset||0)),c=t.style,l=t.outline,u=0|(l&&l.color&&Object(h["d"])(l.color)),f=0|(l&&l.width&&Math.round(Object(s["d"])(l.width))),p=new d(t.materialKey,o,a,t.angle,i,r,n,n,u,f,!1,!1,"esriSMSCross"===c||"esriSMSX"===c,0,e,0,0,126/64,1,null,null);return p.boundsType="esriSMSCircle"===c?"circle":"square",p}static fromLineSymbolMarker(t,e){const i=Object(h["d"])(t.color),r=Math.round(Object(s["d"])(6*t.lineWidth)),n=r,o="cross"===t.style||"x"===t.style;let a;switch(t.placement){case"begin-end":a="Both";break;case"begin":a="JustBegin";break;case"end":a="JustEnd";break;default:a="None"}const c={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:a,offsetAlongLine:0},l=new d(t.materialKey,0,0,0,i,r,n,n/6,i,o?Math.round(Object(s["d"])(t.lineWidth)):0,!1,!1,o,1,e,0,0,126/64,1,c,null);return l.boundsType="circle"===t.style?"circle":"square",l}}e["a"]=d},ba46:function(t,e,i){"use strict";var r=i("a4ee"),s=(i("c120"),i("e92d"),i("cea0"),i("59b2")),n=i("d386"),o=(i("e041"),i("8eed"),i("f402"),i("9096"));let a=class extends o["a"]{initialize(){}destroy(){}get supportsTileUpdates(){return!1}get spatialReference(){const t=this.get("tileStore.tileScheme.spatialReference");return t&&t.toJSON()||null}};Object(r["a"])([Object(s["b"])({readOnly:!0})],a.prototype,"supportsTileUpdates",null),Object(r["a"])([Object(s["b"])({constructOnly:!0})],a.prototype,"remoteClient",void 0),Object(r["a"])([Object(s["b"])({constructOnly:!0})],a.prototype,"service",void 0),Object(r["a"])([Object(s["b"])({dependsOn:["tileStore.tileScheme.spatialReference"]})],a.prototype,"spatialReference",null),Object(r["a"])([Object(s["b"])({constructOnly:!0})],a.prototype,"tileInfo",void 0),Object(r["a"])([Object(s["b"])({constructOnly:!0})],a.prototype,"tileStore",void 0),a=Object(r["a"])([Object(n["a"])("esri.views.2d.layers.features.processors.BaseProcessor")],a);var c=a;e["a"]=c},c275:function(t,e,i){"use strict";function r(t,e){if(null!==e){t.push(e.length);for(const i of e)i.serialize(t);return t}t.push(0)}function s(t,e,i){const r=t.readInt32(),s=new Array(r);for(let n=0;n<s.length;n++)s[n]=e.deserialize(t,i);return s}i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return r}))},daf1:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i("c8dd");class s{constructor(t,e,i){this.data=t,this.stride=e,this.vertexCount=i}static decode(t){const e=Object(r["c"])(t.data,t.stride),i=t.stride,n=t.vertexCount;return new s(e,i,n)}static fromVertexVector(t){const e=Object(r["c"])(t.data.buffer(),t.stride),i=t.stride,n=t.vertexCount;return new s(e,i,n)}}class n{constructor(t,e,i){this.geometryType=t,this.indexBuffer=new Uint32Array(e),this.namedBuffers=i}static decode(t){const e=t.geometryType,i=t.indexBuffer,r={};for(const n in t.namedBuffers)r[n]=s.decode(t.namedBuffers[n]);return new n(e,i,r)}static fromVertexVectors(t){const e=t.geometryType,i=t.indexVector.buffer(),r={};for(const n in t.namedVectors)r[n]=s.fromVertexVector(t.namedVectors[n]);return new n(e,i,r)}}},e416:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var r=i("b6a7"),s=i("9344");class n{static getPlacement(t,e,i){const n=Object(s["b"])(e);if(!n)return null;const o=Object(r["c"])(t);return n.execute(o,e,i)}}},f75e:function(t,e,i){"use strict";var r=i("b2b2"),s=i("a9ab"),n=i("c84e"),o=i("b6a7"),a=i("fe24"),c=i("9344");class l{static executeEffects(t,e){const i=Object(o["c"])(e);let r=new a["a"](i);for(const s of t){const t=Object(c["a"])(s);t&&(r=t.execute(r,s,1.3333333333333333))}return r}static next(t){const e=t.next();return Object(o["d"])(e),e}}e["a"]=class{get needsPixelBuffer(){return!!this.effects||this.geometryType===n["d"].MARKER||this.geometryType===n["d"].TEXT||this.geometryType===n["d"].LABEL}writeMesh(t,e,i,n,o){if(Object(r["g"])(this.effects))return this.writeMeshWithGeometry(t,e,i,n,o);const a=l.executeEffects(this.effects,i.readLegacyGeometry());let c=l.next(a);for(;c;)this.writeMeshWithGeometry(t,e,i,Object(s["c"])(c),o,c),c=l.next(a)}writeMeshWithGeometry(t,e,i,r,s,n){}bindFeature(t,e,i){}}},f93c:function(t,e,i){"use strict";var r=i("b2b2"),s=i("a915"),n=i("6655"),o=i("3349"),a=i("a29a"),c=i("2c63"),l=i("738e"),h=i("d114"),u=i("c84e"),f=i("e416");e["a"]=t=>class extends t{constructor(...t){super(...t),this.angle=0,this.xOffset=0,this.yOffset=0,this.width=0,this.height=0,this.boundsType="square",this._anchorX=0,this._anchorY=0,this._computedWidth=0,this._computedHeight=0,this.geometryType=u["d"].MARKER}writeMeshWithGeometry(t,e,i,s,o,a){const c=e.indexVector,l=e.get("geometry"),h=e.getVector("geometry"),u=h.vertexCount,f=u,d=c.length;if(Object(r["h"])(this._markerPlacement)){const t=null!=a?a:i.readLegacyGeometry();this._writePlacedMarkers(l,c,u,o,t)}else{const t=a?Object(n["p"])(Object(n["d"])(a),2):"esriGeometryPolygon"===s?i.readCentroid():i.readUnquantizedGeometry();if(!t)return;if(t.isPoint){const[e,i]=t.coords;this._writeVertices(l,o,this._getPos(e,i)),this._writeIndices(c,u)}else t.forEachVertex((t,e)=>{const i=h.vertexCount;this._writeVertices(l,o,this._getPos(t,e)),this._writeIndices(c,i)})}const p=e.getVector("geometry").vertexCount-f,m=c.length-d;t.writeDisplayRecord(this.geometryType,this._materialKey,f,p,d,m)}_applyTransformation(t,e,i=0){Object(a["d"])(t),Object(a["h"])(t,t,Object(l["b"])(this.xOffset,-this.yOffset)),this.angle+i!==0&&Object(a["f"])(t,t,.017453292519944444*(this.angle+i));const r=this._computedWidth,s=this._computedHeight,n=(this._anchorX-.5)*r,c=(this._anchorY-.5)*s;Object(o["m"])(e,n,c),Object(o["n"])(e,e,t),this._offsetUpperLeft=Object(h["a"])(16*e[0],16*e[1]),Object(o["m"])(e,n+r,c),Object(o["n"])(e,e,t),this._offsetUpperRight=Object(h["a"])(16*e[0],16*e[1]),Object(o["m"])(e,n,c+s),Object(o["n"])(e,e,t),this._offsetBottomLeft=Object(h["a"])(16*e[0],16*e[1]),Object(o["m"])(e,n+r,c+s),Object(o["n"])(e,e,t),this._offsetBottomRight=Object(h["a"])(16*e[0],16*e[1])}_writePlacedMarkers(t,e,i,n,o){const a=f["a"].getPlacement(o,Object(r["n"])(this._markerPlacement),Object(s["d"])(1));if(!a)return;const h=Object(l["a"])(),u=Object(c["a"])();let d=0,p=a.next();for(;null!=p;)p.tx>=-128&&p.tx<=640&&p.ty>=-128&&p.ty<=640&&(this._applyTransformation(u,h,p.getAngle()/.017453292519944444),this._writeVertices(t,n,this._getPos(p.tx,p.ty)),this._writeIndices(e,i+d),d+=4),p=a.next()}_getPos(t,e){return Object(h["a"])(Math.round(8*t),Math.round(8*e))}_writeVertices(t,e,i){t.push(i),t.push(this._offsetUpperLeft),t.push(this._texUpperLeft),t.push(this._bitestAndDistRatio),t.push(e),t.push(this._fillColor),t.push(this._outlineColor),t.push(this._sizeOutlineWidth),t.push(i),t.push(this._offsetUpperRight),t.push(this._texUpperRight),t.push(this._bitestAndDistRatio),t.push(e),t.push(this._fillColor),t.push(this._outlineColor),t.push(this._sizeOutlineWidth),t.push(i),t.push(this._offsetBottomLeft),t.push(this._texBottomLeft),t.push(this._bitestAndDistRatio),t.push(e),t.push(this._fillColor),t.push(this._outlineColor),t.push(this._sizeOutlineWidth),t.push(i),t.push(this._offsetBottomRight),t.push(this._texBottomRight),t.push(this._bitestAndDistRatio),t.push(e),t.push(this._fillColor),t.push(this._outlineColor),t.push(this._sizeOutlineWidth)}_writeIndices(t,e){const i=e;t.push(i+0),t.push(i+1),t.push(i+2),t.push(i+1),t.push(i+3),t.push(i+2)}}},fb2c:function(t,e,i){"use strict";function r(t,e,i){const r=e&&e.length,a=r?e[0]*i:t.length;let c=s(t,0,a,i,!0);const l=new Array;if(!c||c.next===c.prev)return l;let h,d,p,m,y;if(r&&(c=function(t,e,i,r){const o=new Array;for(let n=0,a=e.length;n<a;n++){const i=s(t,e[n]*r,n<a-1?e[n+1]*r:t.length,r,!1);i===i.next&&(i.steiner=!0),o.push(u(i))}o.sort(v);for(const s of o)f(s,i),i=n(i,i.next);return i}(t,e,c,i)),t.length>80*i){h=p=t[0],d=m=t[1];for(let e=i;e<a;e+=i){const i=t[e],r=t[e+1];h=Math.min(h,i),d=Math.min(d,r),p=Math.max(p,i),m=Math.max(m,r)}y=Math.max(p-h,m-d),y=0!==y?1/y:0}return o(c,l,i,h,d,y),l}function s(t,e,i,r,s){let n;if(s===b(t,e,i,r)>0)for(let o=e;o<i;o+=r)n=l(o,t[o],t[o+1],n);else for(let o=i-r;o>=e;o-=r)n=l(o,t[o],t[o+1],n);return n&&O(n,n.next)&&(h(n),n=n.next),n}function n(t,e=t){if(!t)return t;let i,r=t;do{if(i=!1,r.steiner||!O(r,r.next)&&0!==m(r.prev,r,r.next))r=r.next;else{if(h(r),r=e=r.prev,r===r.next)break;i=!0}}while(i||r!==e);return e}function o(t,e,i,r,s,l,u=0){if(!t)return;!u&&l&&(t=d(t,r,s,l));let f=t;for(;t.prev!==t.next;){const d=t.prev,p=t.next;if(l?c(t,r,s,l):a(t))e.push(d.index/i),e.push(t.index/i),e.push(p.index/i),h(t),t=p.next,f=p.next;else if((t=p)===f){u?1===u?o(t=M(t,e,i),e,i,r,s,l,2):2===u&&j(t,e,i,r,s,l):o(n(t),e,i,r,s,l,1);break}}}function a(t){const e=t.prev,i=t,r=t.next;if(m(e,i,r)>=0)return!1;let s=t.next.next;const n=s;let o=0;for(;s!==t.prev&&(0===o||s!==n);){if(o++,x(e.x,e.y,i.x,i.y,r.x,r.y,s.x,s.y)&&m(s.prev,s,s.next)>=0)return!1;s=s.next}return!0}function c(t,e,i,r){const s=t.prev,n=t,o=t.next;if(m(s,n,o)>=0)return!1;const a=s.x<n.x?s.x<o.x?s.x:o.x:n.x<o.x?n.x:o.x,c=s.y<n.y?s.y<o.y?s.y:o.y:n.y<o.y?n.y:o.y,l=s.x>n.x?s.x>o.x?s.x:o.x:n.x>o.x?n.x:o.x,h=s.y>n.y?s.y>o.y?s.y:o.y:n.y>o.y?n.y:o.y,u=g(a,c,e,i,r),f=g(l,h,e,i,r);let d=t.prevZ,p=t.nextZ;for(;d&&d.z>=u&&p&&p.z<=f;){if(d!==t.prev&&d!==t.next&&x(s.x,s.y,n.x,n.y,o.x,o.y,d.x,d.y)&&m(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,p!==t.prev&&p!==t.next&&x(s.x,s.y,n.x,n.y,o.x,o.y,p.x,p.y)&&m(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;d&&d.z>=u;){if(d!==t.prev&&d!==t.next&&x(s.x,s.y,n.x,n.y,o.x,o.y,d.x,d.y)&&m(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;p&&p.z<=f;){if(p!==t.prev&&p!==t.next&&x(s.x,s.y,n.x,n.y,o.x,o.y,p.x,p.y)&&m(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function l(t,e,i,r){const s=new C(t,e,i);return r?(s.next=r.next,s.prev=r,r.next.prev=s,r.next=s):(s.prev=s,s.next=s),s}function h(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function u(t){let e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function f(t,e){if(e=function(t,e){let i=e;const r=t.x,s=t.y;let n,o=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){const t=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(t<=r&&t>o){if(o=t,t===r){if(s===i.y)return i;if(s===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===o)return n.prev;const a=n,c=n.x,l=n.y;let h,u=1/0;for(i=n.next;i!==a;)r>=i.x&&i.x>=c&&r!==i.x&&x(s<l?r:o,s,c,l,s<l?o:r,s,i.x,i.y)&&(h=Math.abs(s-i.y)/(r-i.x),(h<u||h===u&&i.x>n.x)&&_(i,t)&&(n=i,u=h)),i=i.next;return n}(t,e)){const i=S(e,t);n(i,i.next)}}function d(t,e,i,r){for(let s;s!==t;s=s.next){if(s=s||t,null===s.z&&(s.z=g(s.x,s.y,e,i,r)),s.prev.next!==s||s.next.prev!==s)return s.prev.next=s,s.next.prev=s,d(t,e,i,r);s.prevZ=s.prev,s.nextZ=s.next}return t.prevZ.nextZ=null,t.prevZ=null,function(t){let e,i=1;for(;;){let r,s=t;t=null,e=null;let n=0;for(;s;){n++,r=s;let o=0;for(;o<i&&r;o++)r=r.nextZ;let a=i;for(;o>0||a>0&&r;){let i;0===o?(i=r,r=r.nextZ,a--):0!==a&&r?s.z<=r.z?(i=s,s=s.nextZ,o--):(i=r,r=r.nextZ,a--):(i=s,s=s.nextZ,o--),e?e.nextZ=i:t=i,i.prevZ=e,e=i}s=r}if(e.nextZ=null,i*=2,n<2)return t}}(t)}function p(t,e,i,r){const s=e&&e.length,n=s?e[0]*i:t.length;let o=Math.abs(b(t,0,n,i));if(s)for(let c=0,l=e.length;c<l;c++){const r=e[c]*i,s=c<l-1?e[c+1]*i:t.length;o-=Math.abs(b(t,r,s,i))}let a=0;for(let c=0;c<r.length;c+=3){const e=r[c]*i,s=r[c+1]*i,n=r[c+2]*i;a+=Math.abs((t[e]-t[n])*(t[s+1]-t[e+1])-(t[e]-t[s])*(t[n+1]-t[e+1]))}return 0===o&&0===a?0:Math.abs((a-o)/o)}function m(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function y(t,e,i,r){return!!(O(t,e)&&O(i,r)||O(t,r)&&O(i,e))||m(t,e,i)>0!=m(t,e,r)>0&&m(i,r,t)>0!=m(i,r,e)>0}function b(t,e,i,r){let s=0;for(let n=e,o=i-r;n<i;n+=r)s+=(t[o]-t[n])*(t[n+1]+t[o+1]),o=n;return s}function x(t,e,i,r,s,n,o,a){return(s-o)*(e-a)-(t-o)*(n-a)>=0&&(t-o)*(r-a)-(i-o)*(e-a)>=0&&(i-o)*(n-a)-(s-o)*(r-a)>=0}function _(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function g(t,e,i,r,s){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*s)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*s)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function O(t,e){return t.x===e.x&&t.y===e.y}function v(t,e){return t.x-e.x}function M(t,e,i){let r=t;do{const s=r.prev,n=r.next.next;!O(s,n)&&y(s,r,r.next,n)&&_(s,n)&&_(n,s)&&(e.push(s.index/i),e.push(r.index/i),e.push(n.index/i),h(r),h(r.next),r=t=n),r=r.next}while(r!==t);return r}function j(t,e,i,r,s,a){let c=t;do{let t=c.next.next;for(;t!==c.prev;){if(c.index!==t.index&&w(c,t)){let l=S(c,t);return c=n(c,c.next),l=n(l,l.next),o(c,e,i,r,s,a),void o(l,e,i,r,s,a)}t=t.next}c=c.next}while(c!==t)}function w(t,e){return t.next.index!==e.index&&t.prev.index!==e.index&&!function(t,e){let i=t;do{if(i.index!==t.index&&i.next.index!==t.index&&i.index!==e.index&&i.next.index!==e.index&&y(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&_(t,e)&&_(e,t)&&function(t,e){let i=t,r=!1;const s=(t.x+e.x)/2,n=(t.y+e.y)/2;do{i.y>n!=i.next.y>n&&i.next.y!==i.y&&s<(i.next.x-i.x)*(n-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==t);return r}(t,e)}function S(t,e){const i=new C(t.index,t.x,t.y),r=new C(e.index,e.x,e.y),s=t.next,n=e.prev;return t.next=e,e.prev=t,i.next=s,s.prev=i,r.next=i,i.prev=r,n.next=r,r.prev=n,r}i.d(e,"a",(function(){return p})),i.d(e,"b",(function(){return r}));class C{constructor(t,e,i){this.index=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}}}}]);
//# sourceMappingURL=chunk-39a8d800.3aa13159.js.map